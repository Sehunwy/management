<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" panel="width=device-width, initial-scale=1.0"/>
    <title>四川工商学院毕业设计管理系统</title>
    <link rel="icon" href="../assets/img/bitbug_favicon.ico" type="img/x-ico"/>
    <!-- Bootstrap Styles-->
    <link href="../assets/css/bootstrap.css" rel="stylesheet"/>
    <!-- 字体图标 Styles-->
    <link href="../assets/css/iconfont.css" rel="stylesheet"/>
    <!-- 分页 Styles-->
    <link href="../assets/css/pagination.css" rel="stylesheet"/>
    <!-- 自定义 Styles-->
    <link href="../assets/css/custom-styles.css" rel="stylesheet"/>
    <!-- jQuery Js -->
    <script src="../assets/js/jquery-1.10.2.js"></script>
    <!-- 自定义 Js -->
    <script src="../assets/js/common.js"></script>
    <!-- 自定义函数 Js -->
    <script src="../assets/js/commonFunction.js"></script>
</head>
<body>
<div id="wrapper">
    <!--顶部导航开始-->
    <nav class="navbar navbar-default top-navbar" role="navigation">
        <div class="navbar-header">
            <!--屏幕缩小时显示菜单按钮-->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".sidebar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">
                <img style="width: 40px;display: inline-block" src="../assets/img/crest.jpg" alt="">
                <strong>四川工商学院</strong>
            </a>
            <span id="sideNav" class="iconfont icon-right-s packUpIcon"></span>
        </div>
        <ul class="nav navbar-top-links navbar-right">
            <li style="color: #fff" id="information">

            </li>
            <!--通知公告开始-->
            <!--通知公告开始-->
            <li id="noticeAnnouncement" class="noticeIcon">
                <a href="#">
                    <span class="iconfont icon-lingdang iconColor fontSize14"></span>
                    <span id="unRead" class="messageUnread"></span>
                    <span class="iconfont icon-jiantou iconColor fontSize8"></span>
                </a>
                <div id="content" class="noticeContent" style="width: 400px">
                    <ul class="tab_menu">
                        <li style="width: 190px" class="selected">公告</li>
                        <li style="width: 190px">通知</li>
                    </ul>
                    <div class="horizontal"></div>
                    <div id="type0" class="type">
                        <div id="publicAannouncement"></div>
                    </div>
                    <div id="type1" class="type hide">
                        <div id="publicNotice"></div>
                    </div>
                </div>
            </li>
            <script id="publicAannouncements" type="text/template">
                <ul>
                    <%if(data==""){%>
                    <li class="liStyle liBorderBottom textEllipsis">
                        暂无未读公告
                    </li>
                    <%}else{
                    data.forEach(function(announcements){%>
                    <li class="liStyle liBorderBottom textEllipsis">
                        <%=announcements.notice.title%>
                    </li>
                    <%})}%>
                    <li class="liStyle liBorderBottom textEllipsis  text-center">
                        <a onclick="messageProclamation()" class="management_messageNotice text-center newPage topPage"
                           href="#">
                            <strong>查看更多公告</strong>
                            <i class="fa fa-angle-right"></i>
                        </a>
                    </li>
                </ul>
            </script>
            <script id="publicNotices" type="text/template">
                <ul>
                    <%if(data==""){%>
                    <li class="liStyle liBorderBottom textEllipsis">
                        暂无未读通知
                    </li>
                    <%}else{
                    data.forEach(function(notice){%>
                    <li class="liStyle liBorderBottom textEllipsis">
                        <%=notice.title%>
                    </li>
                    <%})}%>
                    <li class="liStyle liBorderBottom textEllipsis  text-center">
                        <a onclick="messageNotice()" class="management_messageNotice text-center newPage topPage"
                           href="#">
                            <strong>查看更多通知</strong>
                            <i class="fa fa-angle-right"></i>
                        </a>
                    </li>
                </ul>
            </script>
            <!--通知公告结束-->
            <!--个人信息开始-->
            <li class="noticeIcon">
                <a href="#">
                    <span class="iconfont icon-wode iconColor fontSize14"></span>
                    <span class="iconfont icon-jiantou iconColor fontSize8"></span>
                </a>
                <div class="noticeContent">
                    <ul>
                        <li class="liStyle liBorderBottom" onclick="showRoleInfo()">
                            <a href="#" class="management_personal newPage topPage aStyle">
                                <span class="paddingIco iconfont icon-wode"></span>
                                个人信息维护
                            </a>
                        </li>
                        <li class="liStyle liBorderBottom">
                            <a href="#" class="management_passwordChange newPage topPage aStyle">
                                <span class="paddingIco iconfont icon-xiugaimima01"></span>
                                修改密码
                            </a>
                        </li>
                        <li class="liStyle">
                            <a href="#" class="management_bounced bounced aStyle" data-toggle="modal"
                               data-target="#logOut">
                                <span class="paddingIco iconfont icon-tuichudenglu"></span>
                                退出登录
                            </a>
                        </li>
                    </ul>
                </div>
            </li>
            <!--个人信息结束-->
        </ul>
    </nav>
    <!--顶部导航结束-->

    <!--侧导航栏开始-->
    <nav class="navbar-default navbar-side">
        <div class="sidebar-collapse">
            <ul class="nav list-unstyled" id="sideBar">
                <li>
                    <a href="#" class="active-menu" id="management_one">
                        <span class="iconfont icon-lunwentimu iconColor fontSize14 naviconpadding"></span>题目管理
                    </a>
                </li>
                <li onclick="defensemTeacher()"><a href="#" id="management_Defense">
                    <span class="iconfont icon-dabian iconColorWhite fontSize14 naviconpadding"></span>答辩管理
                </a>
                </li>
                <li onclick="PastExcellent()"><a href="#" id="management_good">
                    <span class="iconfont icon-icon-test iconColorWhite fontSize14 naviconpadding"></span>历届优秀浏览
                </a>
                </li>
                <li onclick="newsBrowse()"><a href="#" id="management_news">
                    <span class="iconfont icon-xinwenguanli iconColorWhite fontSize14 naviconpadding"></span>新闻管理
                </a>
                </li>
            </ul>
        </div>

    </nav>
    <!--侧导航栏结束-->

    <!--题目管理开始-->
    <div id="one" class="page-wrapper">
        <div style="margin: 0px" class="page-inner">
            <!--题目管理开始-->
            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-default">
                        <div style="background-color: #f5f5f5">
                            <ul class="nav nav-tabs" role="tablist">
                                <li class="active"><a href="#review_Questions" role="tab"
                                                      data-toggle="tab">出题审核</a></li>
                                <li onclick="TopicSelectionAudit('','','','','','not')"><a href="#subjectReview"
                                                                                           role="tab"
                                                                                           data-toggle="tab">选题审核</a>
                                </li>
                                <li onclick="statisticalTopic()"><a href="#assign_Topic" role="tab"
                                                                    data-toggle="tab">出题情况统计报表</a></li>
                                <li onclick="statisticalSelect()"><a href="#select_Topic" role="tab"
                                                                     data-toggle="tab">选题情况统计报表</a></li>
                                <li onclick="statisticalTitle()"><a href="#Topic_situation" role="tab"
                                                                    data-toggle="tab">题目情况统计报表</a></li>
                            </ul>
                        </div>
                        <div class="tab-content">
                            <!--出题审核开始-->
                            <div class="tab-pane active panel-body" id="review_Questions">
                                <div style="padding-bottom: 15px;padding-left: 0px" class="col-md-12">
                                    <div class="col-md-3">
                                        <input id="titleTeaId" type="text" class="form-control" placeholder="教师工号">
                                    </div>
                                    <div class="col-md-2">
                                        <input id="titleTeaName" type="text" class="form-control" placeholder="教师姓名">
                                    </div>
                                    <div class="col-md-4">
                                        <input id="titleName" type="text" class="form-control" placeholder="课题题目">
                                    </div>
                                    <div style="padding-left: 0px" class="col-md-2">
                                        <select id="titleStatus" class="form-control">
                                            <option value="">全部</option>
                                            <option value="3">审核中</option>
                                            <option value="0">审核不通过</option>
                                            <option value="1">审核通过</option>
                                        </select>
                                    </div>
                                    <div style="padding-left: 0px" class="col-md-1 padding0">
                                        <button type="button" class="btn btn-info" onclick="queryDrawTea()">查询
                                        </button>
                                    </div>
                                </div>
                                <div id="drawList"></div>
                                <!--分页开始-->
                                <div style="margin-top: 15px" class="m-style" id="drawAudit"></div>
                                <!--分页结束-->
                            </div>
                            <script id="drawLists" type="text/template">
                                <div class="alert alert-success textEllipsis border_radius marginBottom0">
                                    <div class="col-md-2 textAlign">
                                        课题题目
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        题目类型
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        题目来源
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        出题老师
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        申报时间
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        审核状态
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        操作
                                    </div>
                                </div>
                                <%if(data==""){%>
                                <div class="alert alert-danger textAlign border_radius marginBottom0">
                                    暂无数据
                                </div>
                                <%}else{
                                data.forEach(function(title){%>
                                <div class="alert alert-danger textEllipsis border_radius marginBottom0">
                                    <div title="<%=title.project.title%>"
                                         class="col-md-2 textEllipsis textAlign padding0">
                                        <span class="clickColor cursorPointer" data-toggle="modal"
                                              data-target="#topicDetails"
                                              onclick="reviewQuestions('<%=title.teacher.identifier%>', '', '<%=title.project.title%>', '', 'title','<%=title.project.id%>')">
                                            <%=title.project.title%>
                                        </span>
                                    </div>
                                    <div title="<%=title.project.genre%>" class="col-md-2 textEllipsis textAlign">
                                        <%=title.project.genre%>
                                    </div>
                                    <div title="<%=title.project.source%>"
                                         class="col-md-2 textEllipsis textAlign padding0">
                                        <%=title.project.source%>
                                    </div>
                                    <div class="col-md-1 textAlign textEllipsis padding0">
                                        <span class="clickColor cursorPointer" data-toggle="modal"
                                              data-target="#teacherDetails"
                                              onclick="reviewQuestions('<%=title.teacher.identifier%>', '', '', '', 'teacher','')">
                                            <%=title.teacher.name%>
                                        </span>
                                    </div>
                                    <%
                                    var unixTimestamp = new Date( title.setDate ) ;
                                    commonTime = unixTimestamp.toLocaleString();
                                    %>
                                    <div title="<%= commonTime %>" class="col-md-2 textEllipsis textAlign padding0">
                                        <%= commonTime %>
                                    </div>
                                    <div class="col-md-2 textEllipsis textAlign padding0">
                                        <%if(title.cStatus==1){%>
                                        审核通过
                                        <%}else if(title.cStatus==0) {%>
                                        审核不通过
                                        <%}else{%>
                                        审核中
                                        <%}%>
                                    </div>
                                    <div class="col-md-1 textEllipsis textAlign">
                                        <%if(title.cStatus==3){%>
                                        <button type="button" class="btn btn-info btn-xs" data-toggle="modal"
                                                data-target="#checkDraw"
                                                onclick="reviewQuestions('<%=title.teacher.identifier%>', '', '', '', 'titleAudit','<%=title.project.id%>')">
                                            审核
                                        </button>
                                        <%}else{%>
                                        <button type="button" class="btn btn-info btn-xs" disabled>审核
                                        </button>
                                        <%}%>
                                    </div>
                                </div>
                                <%})}%>
                            </script>
                            <!--出题审核结束-->
                            <!--选题审核开始-->
                            <div class="tab-pane panel-body" id="subjectReview">
                                <div style="padding-bottom: 15px;padding-left: 0px" class="col-md-12">
                                    <div class="col-md-3">
                                        <input id="sid" type="text" class="form-control" placeholder="学生学号">
                                    </div>
                                    <div class="col-md-2">
                                        <input id="sName" type="text" class="form-control" placeholder="学生姓名">
                                    </div>
                                    <div class="col-md-4">
                                        <input id="stuPName" type="text" class="form-control" placeholder="课题题目">
                                    </div>
                                    <div style="padding-left: 0px" class="col-md-2">
                                        <select id="cStatus" class="form-control">
                                            <option value="">全部</option>
                                            <option value="2">审核中</option>
                                            <option value="1">审核通过</option>
                                            <option value="0">审核不通过</option>
                                        </select>
                                    </div>
                                    <div style="padding-left: 0px" class="col-md-1 padding0">
                                        <button type="button" class="btn btn-info" onclick="queryStuList()">查询
                                        </button>
                                    </div>
                                </div>
                                <div id="selection"></div>
                                <!--分页开始-->
                                <div style="margin-top: 15px" class="m-style" id="selectionPage"></div>
                                <!--分页结束-->
                            </div>
                            <script id="selections" type="text/template">
                                <div class="alert alert-success textEllipsis border_radius marginBottom0">
                                    <div class="col-md-2 textAlign">
                                        课题题目
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        题目类型
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        题目来源
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        学生
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        选题时间
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        审核状态
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        操作
                                    </div>
                                </div>
                                <%if(data=="") {%>
                                <div class="alert alert-danger textAlign border_radius marginBottom0">暂无数据</div>
                                <%} else{
                                data.forEach(function(title){%>
                                <div class="alert alert-danger textEllipsis border_radius marginBottom0">
                                    <div title="<%=title.project.title%>" class="col-md-2 textEllipsis textAlign">
                                        <%=title.project.title%>
                                    </div>
                                    <div title="<%=title.project.genre%>"
                                         class="col-md-1 textEllipsis textAlign padding0">
                                        <%=title.project.genre%>
                                    </div>
                                    <div title="<%=title.project.source%>" class="col-md-2 textEllipsis textAlign">
                                        <%=title.project.source%>
                                    </div>
                                    <div class="col-md-1 textAlign textEllipsis">
                                        <span class="clickColor cursorPointer" data-toggle="modal"
                                              data-target="#studentDetails"
                                              onclick="TopicSelectionAudit('<%=title.student.identifier%>', '', '', '', '', 'student')">
                                            <%=title.student.name%>
                                        </span>
                                    </div>
                                    <div class="col-md-2 textEllipsis textAlign padding0">
                                        <%
                                        var unixTimestamp = new Date( title.chooseDate ) ;
                                        commonTime = unixTimestamp.toLocaleString();
                                        %>
                                        <%= commonTime %>
                                    </div>
                                    <div class="col-md-2 textEllipsis textAlign">
                                        <% let msg;
                                        if(title.cStatus==0) {
                                        msg = "审核不通过";
                                        }
                                        else if(title.cStatus==1) {
                                        msg = "审核通过";
                                        }
                                        else {
                                        msg = "审核中";
                                        }
                                        %>
                                        <%=msg%>
                                    </div>
                                    <div class="col-md-2 textEllipsis textAlign">
                                        <%if(title.cStatus==0||title.cStatus==1) {%>
                                        <button type="button" class="btn btn-info btn-xs" disabled>通 过
                                        </button>
                                        <button type="button" class="btn btn-danger btn-xs" disabled>不通过
                                        </button>
                                        <%} else {%>
                                        <button type="button" class="btn btn-info btn-xs" data-toggle="modal"
                                                data-target="#pass"
                                                onclick="conveyId('<%=title.student.identifier%>','<%=title.project.id%>','1')">
                                            通 过
                                        </button>
                                        <button type="button" class="btn btn-danger btn-xs" data-toggle="modal"
                                                data-target="#noPass"
                                                onclick="conveyId('<%=title.student.identifier%>','<%=title.project.id%>','0')">
                                            不通过
                                        </button>
                                        <%}%>
                                    </div>
                                </div>
                                <%})}%>

                            </script>
                            <!--选题审核结束-->
                            <!--查看出题情况开始-->
                            <div class="tab-pane panel-body" id="assign_Topic">
                                <div class="alert alert-info" id="hasDraw">
                                </div>
                                <div style="padding-left:0px;padding-bottom: 15px" class="col-md-12">
                                    <div style="padding-bottom: 15px;padding-left: 0px" class="col-md-12">
                                        <div style="padding-left: 0px" class="col-md-12">
                                            <div class="col-md-3 col-xs-3">
                                                <input id="teaName" type="text" class="form-control" placeholder="教师姓名">
                                            </div>
                                            <div class="col-md-3 col-xs-3">
                                                <input id="teaId" type="text" class="form-control" placeholder="教师工号">
                                            </div>
                                            <div class="col-md-3 col-xs-3">
                                                <select id="hasSet" style="margin:0px 5px" class="form-control">
                                                    <option value="">全部教师</option>
                                                    <option value="1">出题教师</option>
                                                    <option value="0">未出题教师</option>
                                                </select>
                                            </div>
                                            <div class="col-md-2 col-xs-2" style="padding-left: 5px">
                                                <button onclick="queryDraw()" type="button" class="btn btn-info">查询
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div style="padding-left: 0px" class="col-md-4">
                                        <div class="col-md-10 col-xs-10" style="padding: 0px">
                                            <h4 class="font_bold" style="display: inline-block;padding-right: 10px">
                                                教师列表</h4>
                                            <button type="button" class="btn btn-danger" onclick="btn_export()">
                                                导出表格<span
                                                    class="iconfont icon-excel"
                                                    style="padding-left: 4px;font-size:12px"></span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div id="titleList"></div>
                                <!--分页开始-->
                                <div class="col-md-12 col-xs-12" style="margin-top: 10px">
                                    <div class="m-style" id="teachersPage"></div>
                                </div>
                                <!--分页结束-->
                            </div>
                            <script id="hasDraws" type="text/template">
                                <%if(data=="") {%>
                                <div>本系出题教师数量：暂无数据</div>
                                <div>本系未出题教师数量：暂无数据</div>
                                <%}else{%>
                                <div>本系出题教师数量：<%=data.has_set%></div>
                                <div>本系未出题教师数量：<%=data.has_not_set%></div>
                                <%}%>
                            </script>
                            <script id="titleLists" type="text/template">
                                <div class="alert alert-success textEllipsis border_radius marginBottom0">
                                    <div class="col-md-2 textAlign">
                                        教师姓名（编号）
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        是否出题
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        题目数
                                    </div>
                                    <div class="col-md-6 textAlign">
                                        课题题目
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        操作
                                    </div>
                                </div>
                                <%if(data==""){%>
                                <div class="alert alert-danger textAlign border_radius marginBottom0">暂无数据</div>
                                <%}else{data.forEach(function(teacher){%>
                                <div class="alert alert-danger textEllipsis border_radius marginBottom0">
                                    <div class="col-md-2 textAlign">
                                <span class="clickColor cursorPointer" data-toggle="modal"
                                      data-target="#teacherDetails"
                                      onclick="teacherById('<%=teacher.identifier%>')">
                                <%=teacher.name%>（<%=teacher.identifier%>）
                                </span>
                                    </div>
                                    <%if(teacher.proSetList.length==0) {%>
                                    <div class="col-md-1 textAlign">
                                        否
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        0
                                    </div>
                                    <div class="col-md-8 textAlign">暂无出题信息</div>
                                    <%} else {%>
                                    <div class="col-md-1 textAlign">
                                        是
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        <%=teacher.proSetList.length%>
                                    </div>
                                    <div class="col-md-6 textAlign textEllipsis">
                                        <%=teacher.proSetList[0].project.title%>
                                    </div>
                                    <div class="col-md-2 textAlign">
                                <span class="clickColor cursorPointer" data-toggle="modal"
                                      data-target="#moreTopics" onclick="moreTitles('<%=teacher.identifier%>')">
                                查看更多题目<span
                                        class="iconfont icon-chakangengduo clickColor fontSize14"></span>
                                </span>
                                    </div>
                                    <%}%>
                                </div>
                                <%})}%>
                            </script>
                            <!--查看出题情况结束-->
                            <!--查看选题情况开始-->
                            <div class="tab-pane panel-body" id="select_Topic">
                                <div class="alert alert-info" id="hasSelect">
                                </div>
                                <div style="padding-left:0px;padding-bottom: 15px" class="col-md-12">
                                    <div style="padding-bottom: 15px;padding-left: 0px" class="col-md-12">
                                        <div style="padding-left: 0px" class="col-md-12">
                                            <div class="col-md-3 col-xs-3">
                                                <input id="stuName" type="text" class="form-control" placeholder="学生姓名">
                                            </div>
                                            <div class="col-md-3 col-xs-3">
                                                <input id="stuId" type="text" class="form-control" placeholder="学生学号">
                                            </div>
                                            <div class="col-md-3 col-xs-3">
                                                <select id="hasChoose" style="margin:0px 5px" class="form-control">
                                                    <option value="">全部学生</option>
                                                    <option value="1">选题学生</option>
                                                    <option value="0">未选题学生</option>
                                                </select>
                                            </div>
                                            <div class="col-md-2 col-xs-2" style="padding-left: 5px">
                                                <button type="button" class="btn btn-info" onclick="queryIsChoose()">
                                                    查询
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div style="padding-left: 0px" class="col-md-4">
                                        <div class="col-md-10 col-xs-10" style="padding: 0px">
                                            <h4 class="font_bold" style="display: inline-block;padding-right: 10px">
                                                学生列表</h4>
                                            <button type="button" class="btn btn-danger" onclick="exportStudent()">
                                                导出表格<span
                                                    class="iconfont icon-excel"
                                                    style="padding-left: 4px;font-size:12px"></span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div id="studentList"></div>
                                <!--分页开始-->
                                <!--分页结束-->
                                <div style="margin-top: 15px" class="m-style" id="studentPage"></div>
                            </div>
                            <script id="hasSelects" type="text/template">
                                <%if(data=="") {%>
                                <div>本系选题学生数量：暂无数据</div>
                                <div>本系未选题学生数量：暂无数据</div>
                                <%}else{%>
                                <div>本系选题学生数量：<%=data.has_choose%></div>
                                <div>本系未选题学生数量：<%=data.has_not_choose%></div>
                                <%}%>
                            </script>
                            <script id="studentLists" type="text/template">
                                <div class="alert alert-success textEllipsis border_radius marginBottom0">
                                    <div class="col-md-3 textAlign">
                                        学生姓名（学号）
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        是否选题
                                    </div>
                                    <div class="col-md-8 textAlign">
                                        课题题目
                                    </div>
                                </div>
                                <%if(data==""){%>
                                <div class="alert alert-danger textAlign border_radius marginBottom0">暂无数据</div>
                                <%}else{ data.forEach(function(student){%>
                                <div class="alert alert-danger textEllipsis border_radius marginBottom0">
                                    <div class="col-md-3 textAlign">
                                        <span class="clickColor cursorPointer" data-toggle="modal"
                                              data-target="#studentDetails"
                                              onclick="queryStudentInfo('<%=student.identifier%>')">
                                            <%=student.name%>（<%=student.identifier%>）
                                        </span>
                                    </div>
                                    <%if(typeof(student.checkedPro)=="undefined") {%>
                                    <div class="col-md-1 textAlign">
                                        否
                                    </div>
                                    <div class="col-md-8 textAlign textEllipsis">
                                        暂无选题
                                    </div>
                                    <%}else{%>
                                    <div class="col-md-1 textAlign">
                                        是
                                    </div>
                                    <div class="col-md-8 textAlign textEllipsis">
                                        <span class="clickColor cursorPointer" data-toggle="modal"
                                              data-target="#topicDetails"
                                              onclick="studentProjectDetails('<%=student.identifier%>')">
                                            <%=student.checkedPro.title%>
                                        </span>
                                    </div>
                                    <%}%>
                                </div>
                                <%})}%>

                            </script>
                            <!--查看选题情况结束-->
                            <!--查看题目情况开始-->
                            <div class="tab-pane panel-body" id="Topic_situation">
                                <div class="alert alert-info" id="numberOfTitle">
                                </div>
                                <div style="padding-left:0px;padding-bottom: 15px" class="col-md-12">
                                    <div style="padding-bottom: 15px;padding-left: 0px" class="col-md-12">
                                        <div style="padding-left: 0px" class="col-md-12">
                                            <div class="col-md-4 col-xs-4">
                                                <input id="pName" type="text" class="form-control" placeholder="课题题目">
                                            </div>
                                            <div class="col-md-1 col-xs-1">
                                            </div>
                                            <div class="col-md-1 col-xs-1 padding0">
                                                可选专业：
                                            </div>
                                            <div class="col-md-2 col-xs-2 padding0">
                                                <select id="range" style="margin:0px 5px" class="form-control">
                                                    <option value="">全部</option>
                                                    <option value="0">本系</option>
                                                    <option value="1">全校</option>
                                                </select>
                                            </div>
                                            <div class="col-md-1 col-xs-1">
                                            </div>
                                            <div class="col-md-1 col-xs-1 padding0">
                                                题目类型：
                                            </div>
                                            <div class="col-md-2 col-xs-2 padding0">
                                                <select id="genre" style="margin:0px 5px" class="form-control">
                                                    <option value="">全部</option>
                                                    <option value="作品展演与创作报告">作品展演与创作报告</option>
                                                    <option value="应用研发与设计">应用研发与设计</option>
                                                    <option value="创意设计">创意设计</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-12 col-xs-12">
                                        <div class="col-md-1 col-xs-1 padding0">
                                            题目来源：
                                        </div>
                                        <div class="col-md-3 col-xs-3 padding0">
                                            <select id="source" style="margin:0px 5px" class="form-control">
                                                <option value="">全部</option>
                                                <option value="自选题目">自选题目</option>
                                                <option value="生产和社会实践">生产和社会实践</option>
                                            </select>
                                        </div>
                                        <div class="col-md-1 col-xs-1">
                                        </div>
                                        <div class="col-md-1 col-xs-1 padding0">
                                            题目被选情况:
                                        </div>
                                        <div class="col-md-3 col-xs-3">
                                            <select id="status" style="margin:0px 5px" class="form-control">
                                                <option value="">全部</option>
                                                <option value="0">未被选择的题目</option>
                                                <option value="1">未选完的题目</option>
                                                <option value="2">已选完的题目</option>
                                            </select>
                                        </div>
                                        <div class="col-md-2 col-xs-2" style="padding-left: 5px">
                                            <button type="button" class="btn btn-info" onclick="queryTitle()">查询
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div style="padding-left: 0px;margin-bottom: 10px" class="col-md-12">
                                    <div class="col-md-10 col-xs-10" style="padding: 0px">
                                        <h4 class="font_bold" style="display: inline-block;padding-right: 10px">
                                            题目列表</h4>
                                        <button type="button" class="btn btn-danger" onclick="exportTitle()">导出表格<span
                                                class="iconfont icon-excel"
                                                style="padding-left: 4px;font-size:12px"></span>
                                        </button>
                                    </div>
                                </div>
                                <div id="listOfTitle"></div>
                                <!--分页开始-->
                                <div style="margin-top: 15px" class="m-style" id="titlePage"></div>
                                <!--分页结束-->
                            </div>
                            <script id="numberOfTitles" type="text/template">
                                <div>本系出题题目数量：
                                    <%if(typeof(data.total_count)=="undefined"||data.total_count==""){%>
                                    0
                                    <%}else{%>
                                    <%=data.total_count%>
                                    <%}%>
                                </div>
                                <div>本系已选完题目数量：
                                    <%if(typeof(data.choose_rest_count)=="undefined"||data.choose_rest_count==""){%>
                                    0
                                    <%}else{%>
                                    <%=data.choose_rest_count%>
                                    <%}%>
                                </div>
                                <div>本系未被选择题目数量：
                                    <%if(typeof(data.not_choose_count)=="undefined"||data.not_choose_count==""){%>
                                    0
                                    <%}else{%>
                                    <%=data.not_choose_count%>
                                    <%}%>
                                </div>
                                <div>本系未被选完题目数量：
                                    <%if(typeof(data.choose_not_rest_count)=="undefined"||data.choose_not_rest_count==""){%>
                                    0
                                    <%}else{%>
                                    <%=data.choose_not_rest_count%>
                                    <%}%>
                                </div>
                            </script>
                            <script id="listOfTitles" type="text/template">
                                <div class="alert alert-success textEllipsis border_radius marginBottom0">
                                    <div class="col-md-4 textAlign">
                                        课题题目
                                    </div>
                                    <div class="col-md-3 textAlign">
                                        选题学生姓名（学号）
                                    </div>
                                    <div class="col-md-3 textAlign">
                                        出题教师姓名（工号）
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        容纳总人数
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        可选人数
                                    </div>
                                </div>
                                <%if(data==""){%>
                                <div class="alert alert-danger textAlign border_radius marginBottom0">暂无数据</div>
                                <%} else{
                                data.forEach(function(title){%>
                                <div class="alert alert-danger textEllipsis border_radius marginBottom0">
                                    <div class="col-md-4 textAlign textEllipsis">
                                        <span class="clickColor cursorPointer" data-toggle="modal"
                                              data-target="#topicDetails" onclick="TitleById('<%=title.id%>','title')">
                                            <%=title.title%>
                                        </span>
                                    </div>
                                    <%if(title.choose_stu_list.length==0) {%>
                                    <div class="col-md-3 textAlign normalSpace">暂无学生选题</div>
                                    <%}else{%>
                                    <div class="col-md-3 textAlign normalSpace">
                                        <%title.choose_stu_list.forEach(function(student){%>
                                        <span class="clickColor cursorPointer" style="margin-right: 10px"
                                              data-toggle="modal"
                                              data-target="#studentDetails"
                                              onclick="TitleByStudent('<%=title.id%>','student','<%=student.identifier%>')">
                                            <%=student.name%>
                                        </span>
                                        <%})%>
                                    </div>
                                    <%}%>
                                    <div class="col-md-3 textAlign">
                                        <span class="clickColor cursorPointer" data-toggle="modal"
                                              data-target="#teacherDetails"
                                              onclick="TitleById('<%=title.id%>','teacher')">
                                            <%=title.set_tea.name%>（<%=title.set_tea.identifier%>）
                                        </span>
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        <%=title.number%>
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        <%=title.rest%>
                                    </div>
                                </div>
                                <%})}%>
                            </script>
                            <!--查看题目情况结束-->
                        </div>
                    </div>
                </div>
                <!--题目管理结束-->
            </div>
        </div>
    </div>
    <!--审核出题开始-->
    <div class="modal fade" id="checkDraw" role="dialog">
    </div>
    <script id="checkDraws" type="text/template">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">审核出题</h4>
                </div>
                <div class="modal-body">
                    <div class="alert alert-success">
                        <strong>
                            <span>课题题目:</span>
                        </strong>
                        <span><%=data.title%></span>
                        <hr>
                        <strong>
                            <span>题目简介:</span>
                        </strong>
                        <span>
                            <%=data.briefIntro%>
                        </span>
                        <hr>
                        <strong>
                            <span>题目来源:</span>
                        </strong>
                        <span><%=data.source%></span>
                        <hr>
                        <strong>
                            <span>题目类型:</span>
                        </strong>
                        <span><%=data.genre%></span>
                        <hr>
                        <%if(typeof(setDate)!="undefined") {%>
                        <strong>
                            <span>出题时间:</span>
                        </strong>
                        <span><%
                                        var unixTimestamp = new Date( setDate ) ;
                                        commonTime = unixTimestamp.toLocaleString();
                                        %>
                                        <%= commonTime %></span>
                        <hr>
                        <%}%>
                        <strong>
                            <span>已选人数/容纳人数:</span>
                        </strong>
                        <span><%=data.rest%>/<%=data.number%></span>
                        <hr>
                        <strong>
                            <span>可选范围:</span>
                        </strong>
                        <span><%=data.range%></span>
                        <hr>
                        <strong>
                            <span>所属专业:</span>
                        </strong>
                        <span><%=data.major%></span>
                        <hr>
                        <strong>
                            <span>附件:</span>
                        </strong>
                        <span>
                            <% if(data.fileId == 0 || typeof(data.file)=="undefined") { %>
                                        暂未上传题目相关附件
                                        <% } else { %>
                                        附件：<%=data.file.fileName %> <a style="padding-left: 20px"
                                                                       href="http://www.yuanbw.cn:20086/gpms/rol/downloadFile?fileId=<%=data.fileId %>">点击下载</a>
                                        <% } %>
                        </span>
                        <hr>
                        <strong>
                            <span>任务书:</span>
                        </strong>
                        <span>
                            <% if(typeof(data.taskBook)=="undefined" || data.taskBook.fileId == 0) { %>
                                        暂未上传任务书
                                        <% } else { %>
                                        附件：<%=data.taskBook.file.fileName %> <a style="padding-left: 20px"
                                                                                href="http://www.yuanbw.cn:20086/gpms/rol/downloadFile?fileId=<%=data.taskBook.fileId %>">点击下载</a>
                                        <% } %>
                        </span>
                        <hr>
                        <strong>
                            <span>审核意见:</span>
                        </strong>
                        <span><textarea id="suggest" class="form-control" rows="2"></textarea></span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button onclick="verifyTeaProject('<%=teacherId%>','<%=data.id%>','0')" type="button"
                            class="btn btn-sm btn-info" data-dismiss="modal">审核通过
                    </button>
                    <button onclick="verifyTeaProject('<%=teacherId%>','<%=data.id%>','2')" type="button"
                            class="btn btn-sm btn-danger" data-dismiss="modal">审核不通过
                    </button>
                </div>
            </div>
        </div>
    </script>
    <!--审核出题结束-->
    <!--通过选题开始-->
    <div class="modal fade" id="pass" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">提示</h4>
                </div>
                <div class="modal-body">
                    <div class="container-fluid">
                        确定要通过该学生的选题？
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-xs btn-white" data-dismiss="modal">取 消</button>
                    <button id="savePass" type="button" class="btn btn-xs btn-danger" data-dismiss="modal">保 存</button>
                </div>
            </div>
        </div>
    </div>
    <!--通过选题结束-->
    <!--不通过选题开始-->
    <div class="modal fade" id="noPass" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">提示</h4>
                </div>
                <div class="modal-body">
                    <div class="container-fluid">
                        确定不通过该学生的选题？
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-xs btn-white" data-dismiss="modal">取 消</button>
                    <button id="saveNoPass" type="button" class="btn btn-xs btn-danger" data-dismiss="modal">保 存
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!--不通过选题结束-->
    <!--查看更多题目开始 -->
    <div class="modal fade" id="moreTopics" role="dialog">
    </div>
    <script id="moreTopicses" type="text/template">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">课题题目</h4>
                </div>
                <div class="modal-body">
                    <div class="alert alert-success">
                        <strong>
                            <span>课题题目:</span>
                        </strong>
                        <%data.forEach(function(title){%>
                        <p style="font-size: 14px">
                            <span class="clickColor cursorPointer" data-toggle="modal"
                                  data-target="#topicDetails"
                                  onclick="projectDetails('moreTopics','<%=title.project.id%>')">
                                            <%=title.project.title%>
                                        </span>
                        </p>
                        <%})%>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm btn-info" data-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </script>
    <!--查看更多题目结束 -->
    <!--题目管理结束-->

    <!--答辩管理（系主任）开始-->
    <div id="Defense" class="page-wrapper displayNone">
        <div style="margin: 0px" class="page-inner">
            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-default">
                        <div style="background-color: #f5f5f5">
                            <ul class="nav nav-tabs" role="tablist">
                                <li class="active"><a href="#teachers_Group" role="tab"
                                                      data-toggle="tab">答辩分组</a></li>
                                <li onclick="computationalResults('','','not')"><a href="#Calculate_defense_score"
                                                                                   role="tab"
                                                                                   data-toggle="tab">计算答辩总评成绩</a>
                                </li>
                                <li onclick="queryStudentsPleaConditions('','','')"><a href="#replyStudent" role="tab"
                                                                                       data-toggle="tab">学生答辩分组统计报表</a>
                                </li>
                                <li onclick="summaryReportResults('','','','','ranking')"><a href="#results_Summary"
                                                                                             role="tab"
                                                                                             data-toggle="tab">成绩汇总统计报表</a>
                                </li>
                                <li onclick="archivingStatistics('','','ranking')"><a href="#material_Archive"
                                                                                      role="tab"
                                                                                      data-toggle="tab">材料归档统计报表</a>
                                </li>
                            </ul>
                        </div>
                        <div class="tab-content">
                            <!--教师分组开始-->
                            <div class="tab-pane active" id="teachers_Group">
                                <div class="panel-body">
                                    <!--答辩教师分组开始-->
                                    <div class="col-md-12 alert alert-info" id="replyDate">
                                    </div>
                                    <div class="col-md-12">
                                        <h4 class="font_bold" style="display: inline-block">答辩教师分组</h4>
                                        <button type="button" class="btn btn-danger" onclick="exportAnswerTeacher()">
                                            导出表格<span
                                                class="iconfont icon-excel"
                                                style="padding-left: 4px;font-size:12px"></span>
                                        </button>
                                        <button type="button" class="btn btn-info" data-toggle="modal"
                                                data-target="#modify_Teachers_Group" onclick="newDefense()">新增<span
                                                class="iconfont icon-add"
                                                style="padding-left: 4px;font-size:12px"></span>
                                        </button>
                                        <span class="colorf44">查询说明：对于答辩周数、答辩星期、现有人数输入阿拉伯数字，对于答辩教室输入例如：6A-101</span>
                                    </div>
                                    <div class="col-md-12" style="padding: 8px 0px">
                                        <div class="col-md-12" style="padding: 0">
                                            <div class="col-md-3">
                                                <input id="tid" type="text" class="form-control" placeholder="教师工号">
                                            </div>
                                            <div class="col-md-3">
                                                <input id="tName" type="text" class="form-control" placeholder="教师姓名">
                                            </div>
                                            <div class="col-md-3">
                                                <input id="defClass" type="text" class="form-control"
                                                       placeholder="答辩教室">
                                            </div>
                                        </div>
                                        <div class="col-md-12" style="padding:10px 0">
                                            <div class="col-md-3">
                                                <input id="defWeek" type="text" class="form-control" placeholder="答辩周数">
                                            </div>
                                            <div class="col-md-3">
                                                <input id="day" type="text" class="form-control" placeholder="答辩星期">
                                            </div>
                                            <div class="col-md-3">
                                                <input id="groupNum" type="text" class="form-control"
                                                       placeholder="现有人数">
                                            </div>
                                            <div class="col-md-3">
                                                <button type="button" class="btn btn-info"
                                                        onclick="queryTeachersPlea()">查询
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="teachersGroup"></div>
                                    <!--答辩教师分组结束-->
                                    <!--指导教师分组开始-->
                                    <div class="col-md-12">
                                        <h4 style="display: inline-block" class="font_bold">指导教师分组</h4>
                                        <span class="colorf44">（点击分配学生按钮对已分配的指导教师指导的学生进行答辩组以及毕业设计评审的分配）</span>
                                    </div>
                                    <div id="instructorGrouping"></div>
                                    <div class="col-md-12" style="padding-top: 8px">
                                        <div class="col-md-10">
                                        </div>
                                        <div class="col-md-2">
                                            <button onclick="distributionStudents()" type="button"
                                                    class="btn btn-success">分配学生
                                            </button>
                                        </div>
                                    </div>
                                    <!--指导教师分组结束-->
                                </div>
                            </div>
                            <!--教师-->
                            <script id="teachersGroups" type="text/template">
                                <div class="alert alert-success textEllipsis border_radius marginBottom0">
                                    <div class="col-md-1 textAlign">
                                        答辩周数
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        答辩星期
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        答辩日期
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        答辩时间
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        答辩教室
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        答辩组长
                                    </div>
                                    <div class="col-md-3 textAlign">
                                        答辩教师
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        人数限制/
                                        <div>现有人数</div>
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        分组
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        操作
                                    </div>
                                </div>
                                <%if(data=="") {%>
                                <div class="alert alert-warning textAlign border_radius marginBottom0">暂无数据</div>
                                <%}else{
                                data.forEach(function(teacher){%>
                                <div class="alert alert-warning textEllipsis border_radius marginBottom0">
                                    <div class="col-md-1 textAlign">
                                        第<%=teacher.defWeek%>周
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        星期<%=teacher.defDay%>
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        <%
                                        let unixTimestamp = new Date(teacher.defDate ) ;
                                        let year = unixTimestamp.getFullYear();
                                        let month = unixTimestamp.getMonth()+1;
                                        let date = unixTimestamp.getDate();
                                        commonTime = year+"/"+month+"/"+date
                                        %>
                                        <%= commonTime %>
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        上午 8:00
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        <%=teacher.defClass%>
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        <%teacher.teaGroup.forEach(function(tea){%>
                                        <%if(tea.leader){%>
                                        <%=tea.teaAuth.name%>
                                        <%}
                                        })%>
                                    </div>
                                    <div class="col-md-3 textAlign padding0 normalSpace">
                                        <%teacher.teaGroup.forEach(function(tea){%>
                                        <%if(!tea.leader){%>
                                        <%=tea.teaAuth.name%>
                                        <%}
                                        })%>
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        <%=teacher.groupSize%> / <%=teacher.groupNum%>
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        第<%=teacher.groupId%>组
                                    </div>
                                    <div class="col-md-1 textAlign padding0">
                                        <div class="col-md-3 textAlign">
                                                <span class="iconfont icon-xiugai2 iconColor spanStyle"
                                                      style="padding-left: 4px;" data-toggle="modal"
                                                      data-target="#modify_Teachers_Group"
                                                      onclick="modifyGroup('<%=teacher.groupId%>')"></span>
                                        </div>
                                        <div class="col-md-3 textAlign">
                                                <span class="iconfont icon-shanchu1 iconColor spanStyle"
                                                      style="padding-left: 4px;" data-toggle="modal"
                                                      data-target="#delete_Teachers_Group"
                                                      onclick="deleteGroup('<%=teacher.id%>')"></span>
                                        </div>
                                    </div>
                                </div>
                                <%})}%>
                            </script>
                            <script id="replyDates" type="text/template">
                                <%if(data==""){%>
                                答辩起止日期：暂无信息
                                <%} else{%>
                                答辩起止日期： 第<%=data.beginDate.week%>周星期<%=data.beginDate.day%> -- 第<%=data.endDate.week%>周星期<%=data.endDate.day%>
                                <%}%>
                            </script>
                            <!--指导教师-->
                            <script id="instructorGroupings" type="text/template">
                                <div class="alert alert-success textEllipsis border_radius marginBottom0">
                                    <div class="col-md-8 textAlign">
                                        指导教师（指导人数）
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        分组
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        答辩人数限制/目前人数
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        操作
                                    </div>
                                </div>
                                <%if(data==""){%>
                                <div class="alert alert-warning textAlign border_radius marginBottom0">
                                    暂无数据
                                </div>
                                <%}else{
                                data.forEach(function(teacher){%>
                                <div class="alert alert-warning textEllipsis border_radius marginBottom0">
                                    <div class="col-md-8 textAlign">
                                        <%if(teacher.gtGroup.length==0){%>
                                        暂无数据
                                        <%}else{
                                        teacher.gtGroup.forEach(function(tea){%>
                                        <%=tea.teacher.name%>(<%=tea.teacher.stuListCount%>)
                                        <%})}%>
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        第<%=teacher.groupId%>组
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        <%=teacher.groupSize%>/<%=teacher.groupNum%>
                                    </div>
                                    <div class="col-md-1 textAlign padding0">
                                        <div class="col-md-3 textAlign">
                                                <span class="iconfont icon-xiugai2 iconColor spanStyle"
                                                      style="padding-left: 4px;" data-toggle="modal"
                                                      data-target="#Tutor_Group"
                                                      onclick="NewTutorGroup('<%=teacher.id%>')"></span>
                                        </div>
                                        <div class="col-md-3 textAlign">
                                                <span onclick="deleTutorGroup('<%=teacher.id%>')"
                                                      class="iconfont icon-shanchu1 iconColor spanStyle"
                                                      style="padding-left: 4px;" data-toggle="modal"
                                                      data-target="#delete_Tutor_Group"></span>
                                        </div>
                                    </div>
                                </div>
                                <%})}%>
                            </script>
                            <!--教师分组结束-->
                            <!--计算答辩总评成绩开始-->
                            <div class="tab-pane panel-body" id="Calculate_defense_score">
                                <div style="padding-left: 0px;padding-bottom: 10px" class="col-md-12">
                                    <div class="col-md-4 col-xs-4">
                                        <input type="text" class="form-control" id="stuNameList" placeholder="学生姓名">
                                    </div>
                                    <div class="col-md-4 col-xs-4">
                                        <input type="text" class="form-control" id="stuIdList" placeholder="学生学号">
                                    </div>
                                    <div class="col-md-2 col-xs-2" style="padding-left: 5px">
                                        <button type="button" class="btn btn-info" onclick="studentListQuery()">查询
                                        </button>
                                    </div>
                                </div>
                                <div id="scoreList"></div>
                                <div style="margin-top: 10px">
                                    <div class="col-md-10">
                                    </div>
                                    <div class="col-md-2">
                                        <button onclick="calculateDefenseScore()" type="button" class="btn btn-info">
                                            提交
                                        </button>
                                    </div>
                                </div>
                                <!--分页开始-->
                                <div class="col-md-12 col-xs-12">
                                    <div class="m-style" id="studentsPage"></div>
                                </div>
                                <!--分页结束-->
                            </div>
                            <script id="scoreLists" type="text/template">
                                <div class="alert alert-success textEllipsis border_radius marginBottom0">
                                    <div class="col-md-3 textAlign">
                                        学生姓名（学号）
                                    </div>
                                    <div class="col-md-3 textAlign">
                                        课题题目
                                    </div>
                                    <div class="col-md-1 textAlign padding0">
                                        指导教师评分
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        评阅人评分
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        答辩评分
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        综合评定成绩
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        毕业设计成绩等级
                                    </div>
                                </div>
                                <%if(data==""){%>
                                <div class="alert alert-warning textAlign border_radius marginBottom0">暂无数据</div>
                                <%}else{
                                data.forEach(function(student){%>
                                <div class="alert alert-warning textEllipsis border_radius marginBottom0">
                                    <div class="col-md-3 textAlign textEllipsis">
                                        <span class="clickColor cursorPointer" data-toggle="modal"
                                              data-target="#studentDetails"
                                              onclick="computationalResults('<%=student.identifier%>','','student')">
                                            <%=student.name%>（<%=student.identifier%>）
                                        </span>
                                    </div>
                                    <div title="<%=student.pName%>" class="col-md-3 textAlign textEllipsis">
                                        <%if(student.pName==""){%>
                                        暂无选题
                                        <%}else{%>
                                        <%=student.pName%>
                                        <%}%>
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        <div style="padding-bottom: 2px">
                                            <%if(typeof(student.guidanceTeaGroup)!="undefined"&&student.guidanceTeaGroup.hasReviewed){%>
                                            <%=student.guidanceTeaGroup.scoreTotal%>
                                            <%}else{%>
                                            暂无分数
                                            <%}%>
                                        </div>
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        <div style="padding-bottom: 2px">
                                            <%if(typeof(student.reviewTeaGroup)!="undefined"&&student.reviewTeaGroup.hasReviewed){%>
                                            <%=student.reviewTeaGroup.scoreTotal%>
                                            <%}else{%>
                                            暂无分数
                                            <%}%>
                                        </div>
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        <div style="padding-bottom: 2px">
                                            <%if(typeof(student.defenceScore)!="undefined"&&student.defenceScore.hasReviewed){%>
                                            <%=student.defenceScore.scoreDefence%>
                                            <%}else{%>
                                            暂无分数
                                            <%}%>
                                        </div>
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        <%if(typeof(student.proScore)!="undefined"&&student.proScore.hasReviewed){%>
                                        <%=student.proScore.scoreTotal%>
                                        <%}else{%>
                                        暂无分数
                                        <%}%>
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        <%if(typeof(student.proScore)!="undefined"&&student.proScore.hasReviewed){%>
                                        <%=student.proScore.grade%>
                                        <%}else{%>
                                        暂无等级
                                        <%}%>
                                    </div>
                                </div>
                                <%})}%>
                            </script>
                            <!--计算答辩总评成绩结束-->
                            <!--教师答辩分组开始-->
                            <div class="tab-pane panel-body" id="replyTeacher">
                                <div class="panel-body">
                                    <div style="padding-left:0px;padding-bottom: 15px" class="col-md-12">
                                        <div class="col-md-1 col-xs-1" style="padding: 0px">
                                            教师姓名：
                                        </div>
                                        <div style="padding-left:0px;" class="col-md-4">
                                            <div class="col-md-10 col-xs-10" style="padding: 0px">
                                                <input style="border-bottom-right-radius: 0px;border-top-right-radius: 0px"
                                                       type="text" class="form-control">
                                            </div>
                                            <div class="col-md-2 col-xs-2" style="padding-left: 5px">
                                                <button style="border-bottom-left-radius: 0px;border-top-left-radius: 0px;float: left"
                                                        type="button" class="btn btn-info">
                                                    <span class="iconfont icon-sousuo fontSize14"></span>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="col-md-12 col-xs-12">
                                            <h4 class="font_bold" style="display: inline-block;padding-right: 10px">
                                                教师列表</h4>
                                            <button type="button" class="btn btn-danger">导出表格<span
                                                    class="iconfont icon-excel"
                                                    style="padding-left: 4px;font-size:12px"></span>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="alert alert-success textEllipsis border_radius marginBottom0">
                                        <div class="col-md-1 textAlign">
                                            答辩组长
                                        </div>
                                        <div class="col-md-5 textAlign">
                                            答辩教师
                                        </div>
                                        <div class="col-md-3 textAlign">
                                            答辩时间
                                        </div>
                                        <div class="col-md-1 textAlign">
                                            答辩教室
                                        </div>
                                        <div class="col-md-1 textAlign">
                                            分组
                                        </div>
                                        <div class="col-md-1 textAlign">
                                            答辩人数
                                        </div>
                                    </div>
                                    <div class="alert alert-danger textEllipsis border_radius marginBottom0">
                                        <div class="col-md-1 textAlign">
                                            廖永衡
                                        </div>
                                        <div class="col-md-5 textAlign">
                                            廖永衡 廖永衡 廖永衡 何太碧
                                        </div>
                                        <div class="col-md-3 textAlign">
                                            2019-01-05 17:47:28
                                        </div>
                                        <div class="col-md-1 textAlign">
                                            6A-404
                                        </div>
                                        <div class="col-md-1 textAlign">
                                            第一组
                                        </div>
                                        <div class="col-md-1 textAlign">
                                            5
                                        </div>
                                    </div>
                                    <div class="alert alert-danger textEllipsis border_radius marginBottom0">
                                        <div class="col-md-1 textAlign">
                                            廖永衡
                                        </div>
                                        <div class="col-md-5 textAlign">
                                            廖永衡 廖永衡 廖永衡 何太碧
                                        </div>
                                        <div class="col-md-3 textAlign">
                                            2019-01-05 17:47:28
                                        </div>
                                        <div class="col-md-1 textAlign">
                                            6A-404
                                        </div>
                                        <div class="col-md-1 textAlign">
                                            第一组
                                        </div>
                                        <div class="col-md-1 textAlign">
                                            5
                                        </div>
                                    </div>
                                    <!--分页开始-->
                                    <div style="margin-top: 15px" class="m-style"></div>
                                    <!--分页结束-->
                                </div>
                            </div>
                            <!--教师答辩分组结束-->
                            <!--学生答辩分组列表开始-->
                            <div class="tab-pane" id="replyStudent">
                                <div class="panel-body">
                                    <div class="col-md-12" style="padding-bottom: 10px">
                                        <h4 class="font_bold" style="display: inline-block;padding-right: 10px">
                                            学生答辩分组列表</h4>
                                        <button type="button" class="btn btn-danger" onclick="exportDefenseStudents()">
                                            导出表格<span
                                                class="iconfont icon-excel"
                                                style="padding-left: 4px;font-size:12px"></span>
                                        </button>
                                    </div>
                                    <div class="col-md-12" style="padding-bottom: 10px">
                                        <div class="col-md-3">
                                            <input id="stuPleaName" type="text" class="form-control" placeholder="学生姓名">
                                        </div>
                                        <div class="col-md-3">
                                            <input id="stuPleaId" type="text" class="form-control" placeholder="学生学号">
                                        </div>
                                        <div class="col-md-3">
                                            <button type="button" class="btn btn-info" onclick="queryStudentsPlea()">查询
                                            </button>
                                        </div>
                                    </div>
                                    <div id="studentsGroup"></div>
                                    <!--分页开始-->
                                    <div style="margin-top: 15px" class="m-style" id="studentPleaPage"></div>
                                    <!--分页结束-->
                                </div>
                            </div>
                            <script id="studentsGroups" type="text/template">
                                <div class="alert alert-success textEllipsis border_radius marginBottom0">
                                    <div class="col-md-2 textAlign">
                                        学生姓名（学号）
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        指导教师
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        答辩组长
                                    </div>
                                    <div class="col-md-3 textAlign">
                                        答辩教师
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        评阅教师
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        分组
                                    </div>
                                    <div class="col-md-3 textAlign">
                                        答辩时间
                                    </div>
                                </div>
                                <%if(data==""){%>
                                <div class="alert alert-warning textAlign border_radius marginBottom0">
                                    暂无数据
                                </div>
                                <%}else {
                                data.forEach(function(student){%>
                                <div class="alert alert-warning textEllipsis border_radius marginBottom0">
                                    <div class="col-md-2 textAlign padding0 normalSpace">
                                        <%=student.name%>（<%=student.identifier%>）
                                    </div>
                                    <div class="col-md-1 normalSpace">
                                        <%if(typeof(student.gt)=="undefined") {%>
                                        暂无数据
                                        <%}else{%>
                                        <%=student.gt.name%>
                                        <%}%>
                                    </div>
                                    <%if(typeof(student.defInfo)=="undefined") {%>
                                    <div class="col-md-6 textAlign">
                                        暂无数据
                                    </div>
                                    <%}else{%>
                                    <div class="col-md-1 textAlign">
                                        <%student.defInfo.teaGroup.forEach(function(tea){
                                        if(tea.leader){%>
                                        <%=tea.teaAuth.name%>
                                        <%}})%>
                                    </div>
                                    <div class="col-md-3 normalSpace textAlign">
                                        <%student.defInfo.teaGroup.forEach(function(tea){
                                        if(!tea.leader){%>
                                        <%=tea.teaAuth.name%>
                                        <%}})%>
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        <%if(typeof(student.mt)=="undefined") {%>
                                        暂无数据
                                        <%}else{%>
                                        <%=student.mt.name%>
                                        <%}%>
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        第<%=student.defInfo.groupId%>组
                                    </div>
                                    <div class="col-md-3 textAlign padding0">
                                        2019.05.05/第九周星期五 上午8:30
                                    </div>
                                    <%}%>
                                </div>
                                <%})}%>
                            </script>
                            <!--学生答辩分组列表结束-->
                            <!--成绩汇总开始-->
                            <div class="tab-pane panel-body" id="results_Summary">
                                <div style="padding-bottom: 15px;padding-left: 0px" class="col-md-12">
                                    <div style="padding-left: 0px" class="col-md-12">
                                        <div class="col-md-2 col-xs-2">
                                            <input id="stuResultName" type="text" class="form-control"
                                                   placeholder="学生姓名">
                                        </div>
                                        <div class="col-md-3 col-xs-3">
                                            <input id="stuResultId" type="text" class="form-control" placeholder="学生学号">
                                        </div>
                                        <div class="col-md-2 col-xs-2">
                                            <input id="teaResultName" type="text" class="form-control"
                                                   placeholder="指导教师姓名">
                                        </div>
                                        <div class="col-md-3 col-xs-3">
                                            <input id="teaResultId" type="text" class="form-control"
                                                   placeholder="指导教师工号">
                                        </div>
                                        <div class="col-md-2 col-xs-2" style="padding-left: 5px">
                                            <button type="button" class="btn btn-info" onclick="queryResultList()">查询
                                            </button>
                                        </div>
                                    </div>
                                    <div style="padding-left:0px;padding-bottom: 15px" class="col-md-12">
                                        <div style="padding-left: 0px" class="col-md-12">
                                            <h4 class="font_bold" style="display: inline-block;padding-right: 10px">
                                                学生综合评定成绩列表</h4>
                                            <button type="button" class="btn btn-danger" onclick="exportScore()">
                                                导出表格<span
                                                    class="iconfont icon-excel"
                                                    style="padding-left: 4px;font-size:12px"></span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div id="studentsScore"></div>
                                <div class="col-md-12">
                                    <!--分页开始-->
                                    <div style="margin-top: 15px" class="m-style" id="scorePage"></div>
                                    <!--分页结束-->
                                </div>

                            </div>
                            <script id="studentsScores" type="text/template">
                                <div class="alert alert-success textEllipsis border_radius marginBottom0">
                                    <div class="col-md-1 textAlign">
                                        成绩排名
                                    </div>
                                    <div class="col-md-3 textAlign">
                                        姓名（学号）
                                    </div>
                                    <div class="col-md-3 textAlign">
                                        题目
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        指导成绩
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        评阅成绩
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        答辩成绩
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        评定成绩
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        评定等级
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        操作
                                    </div>
                                </div>
                                <%if(data==""){%>
                                <div class="alert alert-danger textAlign border_radius marginBottom0">暂无数据</div>
                                <%} else{
                                let index = 0;
                                data.forEach(function(score){
                                index++;%>
                                <div class="alert alert-danger textEllipsis border_radius marginBottom0">
                                    <div class="col-md-1 textEllipsis textAlign">
                                        <%=(index+offset)%>
                                    </div>
                                    <div class="col-md-3 textEllipsis textAlign">
                                        <span class="clickColor cursorPointer" data-toggle="modal"
                                              data-target="#studentDetails"
                                              onclick="summaryReportResults('<%=score.identifier%>','','','','student')">
                                            <%=score.name%>（<%=score.identifier%>）
                                        </span>
                                    </div>
                                    <div class="col-md-3 textAlign textEllipsis padding0">
                                        <%if(typeof(score.checkedPro)=="undefined") {%>
                                        暂无数据
                                        <%} else{%>
                                        <span class="clickColor cursorPointer" data-toggle="modal"
                                              data-target="#topicDetails"
                                              onclick="summaryReportResults('<%=score.identifier%>','','','','title')">
                                        <%=score.checkedPro.title%>
                                            </span>
                                        <%}%>
                                    </div>
                                    <%if(typeof(score.proScore)=="undefined") {%>
                                    <div class="col-md-5 textAlign">暂无分数</div>
                                    <%} else {%>
                                    <div class="col-md-1 textAlign"><%=score.proScore.scoreGt%></div>
                                    <div class="col-md-1 textAlign"><%=score.proScore.scoreMt%></div>
                                    <div class="col-md-1 textAlign"><%=score.proScore.scoreDef%></div>
                                    <div class="col-md-1 textAlign"><%=score.proScore.scoreTotal%></div>
                                    <div class="col-md-1 textAlign"><%=score.proScore.grade%></div>
                                    <%}%>
                                </div>
                                <%})}%>
                            </script>
                            <!--成绩汇总结束-->
                            <!--材料归档开始-->
                            <div class="tab-pane panel-body" id="material_Archive">
                                <div style="padding-left: 0px" class="col-md-12">
                                    <div class="col-md-4 col-xs-4">
                                        <input id="stuMaterialName" type="text" class="form-control"
                                               placeholder="学生姓名">
                                    </div>
                                    <div class="col-md-4 col-xs-4">
                                        <input id="stuMaterialId" type="text" class="form-control" placeholder="学生学号">
                                    </div>
                                    <div class="col-md-2 col-xs-2" style="padding-left: 5px">
                                        <button type="button" class="btn btn-info" onclick="queryMaterialArchive()">查询
                                        </button>
                                    </div>
                                </div>
                                <div style="padding-left:0px;padding-bottom: 15px" class="col-md-12">
                                    <div style="padding-left: 0px" class="col-md-4">
                                        <div class="col-md-10 col-xs-10" style="padding: 0px">
                                            <h4 class="font_bold" style="display: inline-block;padding-right: 10px">
                                                材料归档列表</h4>
                                            <button type="button" class="btn btn-danger" onclick="exportMaterial()">导出表格<span
                                                    class="iconfont icon-excel"
                                                    style="padding-left: 4px;font-size:12px"></span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div id="materialArchive"></div>
                                <!--分页开始-->
                                <div class="col-md-12 col-xs-12" style="padding-top: 10px">
                                    <div class="m-style" id="studentMaterialPage"></div>
                                </div>
                                <!--分页结束-->
                            </div>
                            <script id="materialArchives" type="text/template">
                                <div class="alert alert-success textEllipsis border_radius marginBottom0">
                                    <div class="col-md-3 textAlign">
                                        学生姓名（学号）
                                    </div>
                                    <div class="col-md-3 textAlign">
                                        指导教师（编号）
                                    </div>
                                    <div class="col-md-4 textAlign">
                                        课题题目
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        过程文档
                                    </div>
                                </div>
                                <%if(data==""){%>
                                <div class="alert alert-warning textAlign border_radius marginBottom0">暂无数据</div>
                                <%}else{
                                data.forEach(function(stu){%>
                                <div class="alert alert-warning textEllipsis border_radius marginBottom0">
                                    <div class="col-md-3 textAlign">
                                        <span class="clickColor cursorPointer" data-toggle="modal"
                                              data-target="#studentDetails"
                                              onclick="archivingStatistics('<%=stu.identifier%>','','student')">
                                            <%=stu.name%>（<%=stu.identifier%>）
                                        </span>
                                    </div>
                                    <div class="col-md-3 textAlign">
                                        <%if(typeof(stu.gt)=="undefined"){%>
                                        暂无数据
                                        <%}else{%>
                                        <%=stu.gt.name%>（<%=stu.gt.id%>）
                                        <%}%>
                                    </div>
                                    <div class="col-md-4 textAlign textEllipsis">
                                        <%if(stu.pName==""){%>
                                        暂无选题
                                        <%}else{%>
                                        <%=stu.pName%>
                                        <%}%>
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        <span class="clickColor cursorPointer" data-toggle="modal"
                                              data-target="#documentationDetails"
                                              onclick="archivingStatistics('<%=stu.identifier%>','','documentation')">
                                            过程文档提交情况
                                        </span>
                                    </div>
                                </div>
                                <%})}%>
                            </script>
                            <!--材料归档结束-->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--修改教师答辩安排开始-->
    <div class="modal fade" id="modify_Teachers_Group" role="dialog">
    </div>
    <script id="modify_Teachers_Groups" type="text/template">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">答辩安排信息</h4>
                </div>
                <div class="modal-body">
                    <div class="alert alert-success textEllipsis">
                        <div style="height: 18px;" id="date" class="displayNone">
                            <div class="col-md-2 col-xs-2">
                                <strong>
                                    <span>答辩时间:</span>
                                </strong>
                            </div>
                            <div style="padding-left:0px;margin-top: -10px" class="col-md-7 col-xs-7">
                                <div class="col-md-7 col-xs-7">
                                    <input style="padding-left: 2px;padding-right: 30px"
                                           class="form-control textContent"
                                           type="date" id="date_Teachers_Group">
                                </div>
                            </div>
                            <div style="padding-left:0px;margin-top: -10px" class="col-md-3 col-xs-3">
                                <button class="btn btn-info" onclick="showWeek()">切换为周数</button>
                            </div>
                        </div>
                        <div style="height: 18px;" id="week" class="displayBlock">
                            <div class="col-md-2 col-xs-2">
                                <strong>
                                    <span>答辩周数:</span>
                                </strong>
                            </div>
                            <div style="margin-top: -10px" class="col-md-3 col-xs-3">
                                <select id="weeks" style="margin:0px 5px;padding-right: 0px" class="form-control">
                                </select>
                            </div>
                            <div class="col-md-2 col-xs-2">
                                <strong>
                                    <span>答辩星期:</span>
                                </strong>
                            </div>
                            <div style="margin-top: -10px" class="col-md-2 col-xs-2 padding0">
                                <select id="whatDay" style="margin:0px 5px;padding-right: 0px" class="form-control">
                                    <option value="1">星期一</option>
                                    <option value="2">星期二</option>
                                    <option value="3">星期三</option>
                                    <option value="4">星期四</option>
                                    <option value="5">星期五</option>
                                    <option value="6">星期六</option>
                                    <option value="7">星期七</option>
                                </select>
                            </div>
                            <div style="margin-top: -10px" class="col-md-2 col-xs-2">
                                <button class="btn btn-info" onclick="showDate()">切换为日期</button>
                            </div>
                        </div>
                        <hr>
                        <%
                        let classroom = "",numbeLimit = "",id = "";
                        if(data!=""){
                        classroom = data.defClass;
                        numbeLimit = data.groupSize;
                        id = data.id;
                        }%>
                        <div style="height: 18px">
                            <div class="col-md-2 col-xs-2">
                                <strong>
                                    <span>教室安排:</span>
                                </strong>
                            </div>
                            <div style="margin-top: -10px" class="col-md-4 col-xs-4">
                                <input id="classroom" value="<%=classroom%>" type="text"
                                       class="form-control textContent">
                            </div>
                            <div style="margin-top: -10px" class="col-md-6 col-xs-6">
                                <span class="colorf44">（填写说明：例如 6a-151）</span>
                            </div>
                        </div>
                        <hr>
                        <div style="height: 18px">
                            <div class="col-md-12 padding0">
                                <div style="padding-left: 0px" class="col-md-2  col-xs-2">
                                    <strong>
                                        <span>答辩人数限制:</span>
                                    </strong>
                                </div>
                                <div style="margin-top: -10px" class="col-md-4 col-xs-4">
                                    <input id="numbeLimit" value="<%=numbeLimit%>" type="text"
                                           class="form-control textContent">
                                </div>
                                <div style="margin-top: -10px" class="col-md-6 col-xs-6">
                                    <span class="colorf44">（填写说明：填写阿拉伯数字）</span>
                                </div>
                            </div>
                        </div>
                        <hr>
                        <div style="height: 18px">
                            <div class="col-md-12">
                                <div style="padding-left: 0px" class="col-md-2  col-xs-2">
                                    <strong>
                                        <span>答辩组长:</span>
                                    </strong>
                                </div>
                                <div id="teamLeader">
                                    <%if(leader.length>0) {%>
                                    <div class="newTeacher" id="teamLeader<%=leader[0].value%>">
                                        <div style="margin-bottom:10px;margin-left:4px;padding:0px;"
                                             class="col-md-2 col-xs-2">
                                            <input readonly value="<%=leader[0].text%>" type="text"
                                                   class="form-control"/>
                                        </div>
                                        <div style="padding: 0px" class="col-md-1  col-xs-1">
                                        <span style="position: absolute;left: -8px;top: -10px;font-size: 20px"
                                              class="iconfont icon-shanchu"
                                              onclick="deleteLeader('<%=leader[0].value%>')"></span>
                                        </div>
                                    </div>
                                    <%}%>
                                </div>
                            </div>
                        </div>
                        <div style="margin-top: 10px; height: 18px">
                            <div style="margin-top: 20px;" class="col-md-12">
                                <div style="padding-left: 0px" class="col-md-2  col-xs-2">
                                    <strong>
                                        <span>选择答辩组长:</span>
                                    </strong>
                                </div>
                                <div style="margin-top: -10px" class="col-md-4 col-xs-4">
                                    <select style="margin:0px 5px" class="form-control" id="teamLeaderSelect">
                                    </select>
                                </div>
                                <div style="margin-top: -11px" class="col-md-2  col-xs-2">
                                    <button type="button" class="btn btn-info" onclick="chooseteamLeader()">确定
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <hr>
                        </div>
                        <div style="height: 18px">
                            <div class="col-md-12">
                                <div style="padding-left: 0px" class="col-md-2  col-xs-2">
                                    <strong>
                                        <span>答辩教师:</span>
                                    </strong>
                                </div>
                                <div id="choose_teacher">
                                    <%if(teachers.length>0) {
                                    teachers.forEach(function(teacher){%>
                                    <div id="teacher<%=teacher.value%>" class="newTeacher">
                                        <div style="margin-bottom:10px;margin-left:4px;padding:0px;"
                                             class="col-md-2 col-xs-2">
                                            <input readonly value="<%=teacher.text%>" type="text" class="form-control"/>
                                        </div>
                                        <div style="padding: 0px" class="col-md-1  col-xs-1">
                                                                              <span style="position: absolute;left: -8px;top: -10px;font-size: 20px"
                                                                                    class="iconfont icon-shanchu"
                                                                                    onclick="deleteTeacer('<%=teacher.value%>')"></span>
                                        </div>
                                    </div>
                                    <%})}%>
                                </div>
                            </div>
                        </div>
                        <div style="margin-top: 10px; height: 18px">
                            <div style="margin-top: 20px;" class="col-md-12">
                                <div style="padding-left: 0px" class="col-md-2  col-xs-2">
                                    <strong>
                                        <span>选择答辩教师:</span>
                                    </strong>
                                </div>
                                <div style="margin-top: -10px" class="col-md-4 col-xs-4">
                                    <select style="margin:0px 5px" class="form-control" id="plea_Teacher">
                                    </select>
                                </div>
                                <div style="margin-top: -11px" class="col-md-2  col-xs-2">
                                    <button type="button" class="btn btn-info" onclick="chooseTeacer()">确定
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-xs btn-white" data-dismiss="modal">取 消</button>
                    <button onclick="newDefenseArrangements('<%=id%>')" type="button" class="btn btn-xs btn-danger"
                            data-dismiss="modal">保 存
                    </button>
                </div>
            </div>
        </div>
    </script>
    <!--修改教师答辩安排结束-->
    <!--增加指导教师答辩安排开始-->
    <div class="modal fade" id="Tutor_Group" role="dialog">
    </div>
    <script id="Tutor_Groups" type="text/template">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">指导教师分组安排信息</h4>
                </div>
                <div class="modal-body">
                    <div class="alert alert-success textEllipsis">
                        <div style="height: 18px">
                            <div class="col-md-2 col-xs-2">
                                <strong>
                                    <span>填写说明:</span>
                                </strong>
                            </div>
                            <div class="col-md-10 col-xs-10">
                                <span class="colorf44">指导教师括号里的数字为当前指导教师指导学生的人数</span>
                            </div>
                        </div>
                        <hr>
                        <div style="height: 18px">
                            <div class="col-md-2 col-xs-2">
                                <strong>
                                    <span>分组:</span>
                                </strong>
                            </div>
                            <div class="col-md-4 col-xs-4">
                                第<%=data.groupId%>组
                            </div>
                        </div>
                        <hr>
                        <div style="height: 18px">
                            <div class="col-md-4 col-xs-4">
                                <strong>
                                    <span>答辩人数限制/现有人数:</span>
                                </strong>
                            </div>
                            <div class="col-md-4 col-xs-4">
                                <%=data.groupSize%>/<%=data.groupNum%>
                            </div>
                        </div>
                        <hr>
                        <div style="height: 18px">
                            <div class="col-md-2 col-xs-2">
                                <strong>
                                    <span>答辩教师:</span>
                                </strong>
                            </div>
                            <div class="col-md-4 col-xs-4">
                                <%data.teaGroup.forEach(function(tea){
                                if(tea.leader){%>
                                <%=tea.teaAuth.name%>（答辩组长）
                                <%}
                                else{%>
                                <%=tea.teaAuth.name%>
                                <%}})%>
                            </div>
                        </div>
                        <hr>
                        <div style="height: 18px">
                            <div class="col-md-12">
                                <div style="padding-left: 0px" class="col-md-2  col-xs-2">
                                    <strong>
                                        <span>指导教师:</span>
                                    </strong>
                                </div>
                                <div id="choose_tutor">
                                    <%tutor.forEach(function(tea){%>
                                    <div id="tutor<%=tea.value%>">
                                        <div class="col-md-4 col-xs-4">
                                            <div style="margin-bottom:10px;margin-left:4px;padding:0px;"
                                                 class="col-md-10 col-xs-10">
                                                <input readonly value="<%=tea.text%>(<%=tea.stuListCount%>)" type="text"
                                                       class="form-control"/>
                                            </div>
                                            <div style="padding: 0px" class="col-md-2 col-xs-2">
                                                <span style="position: absolute;left: 110px;top: -64px;font-size: 20px"
                                                      class="iconfont icon-shanchu"
                                                      onclick="deleteTutor('<%=tea.value%>')"></span>
                                            </div>
                                        </div>
                                    </div>
                                    <%})%>
                                </div>
                            </div>
                        </div>
                        <div style="margin-top: 10px; height: 18px">
                            <div style="margin-top: 20px;" class="col-md-12">
                                <div style="padding-left: 0px" class="col-md-2  col-xs-2">
                                    <strong>
                                        <span>选择指导教师:</span>
                                    </strong>
                                </div>
                                <div style="margin-top: -10px" class="col-md-4 col-xs-4">
                                    <select style="margin:0px 5px" class="form-control" id="guide_Teacher">
                                    </select>
                                </div>
                                <div style="margin-top: -11px" class="col-md-2  col-xs-2">
                                    <button type="button" class="btn btn-info" onclick="chooseTutor()">确定
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-xs btn-white" data-dismiss="modal">取 消</button>
                    <button onclick="saveTutor('<%=data.id%>')" type="button" class="btn btn-xs btn-danger"
                            data-dismiss="modal">保 存
                    </button>
                </div>
            </div>
        </div>
    </script>
    <!--增加指导教师答辩安排结束-->
    <!--修改学生答辩安排开始-->
    <div class="modal fade" id="modify_Students_Group" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">修改学生答辩分组</h4>
                </div>
                <div class="modal-body">
                    <div class="alert alert-success textEllipsis">
                        <div style="height: 18px">
                            <div class="col-md-2 col-xs-2">
                                <strong>
                                    <span>分组:</span>
                                </strong>
                            </div>
                            <div style="margin-top: -10px" class="col-md-4 col-xs-4">
                                <select style="margin:0px 5px" class="form-control">
                                    <option value="11">第一组(10)</option>
                                    <option value="22">第二组(10)</option>
                                    <option value="33">第三组(10)</option>
                                    <option value="44">第四组(10)</option>
                                    <option value="55">第五组(10)</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-xs btn-white" data-dismiss="modal">取 消</button>
                        <button type="button" class="btn btn-xs btn-danger">保 存</button>
                    </div>
                </div>
            </div>
        </div>
        <!--修改学生答辩安排结束-->
    </div>
    <!--修改指导教师安排结束-->
    <!--删除答辩安排开始-->
    <div class="modal fade" id="delete_Teachers_Group" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">提示</h4>
                </div>
                <div class="modal-body">
                    <div class="container-fluid">
                        确定要删除该答辩安排？
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-xs btn-white" data-dismiss="modal">取 消</button>
                    <button id="deleteDefenseGroup" type="button" class="btn btn-xs btn-danger" data-dismiss="modal">保
                        存
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!--删除答辩安排结束-->
    <!--删除指导教师安排开始-->
    <div class="modal fade" id="delete_Tutor_Group" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">提示</h4>
                </div>
                <div class="modal-body">
                    <div class="container-fluid">
                        确定要删除该指导教师分组？
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-xs btn-white" data-dismiss="modal">取 消</button>
                    <button id="confirmDeleTutor" type="button" class="btn btn-xs btn-danger" data-dismiss="modal">保 存
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!--设为优秀开始-->
    <div class="modal fade" id="setGood" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">提示</h4>
                </div>
                <div class="modal-body">
                    <div class="container-fluid">
                        确定要将该题目设为优秀？
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-xs btn-white" data-dismiss="modal">取 消</button>
                    <button type="button" class="btn btn-xs btn-danger">保 存</button>
                </div>
            </div>
        </div>
    </div>
    <!--设为优秀结束-->
    <!--答辩管理（系主任）结束-->

    <!--查看学生详细信息开始-->
    <div class="modal fade" id="studentDetails" role="dialog">
    </div>
    <script id="studentDetailses" type="text/template">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">学生详细信息</h4>
                </div>
                <div class="modal-body">
                    <div class="alert alert-success">
                        <strong>
                            <span>学生姓名:</span>
                        </strong>
                        <span><%=name%></span>
                        <hr>
                        <strong>
                            <span>学号:</span>
                        </strong>
                        <span><%=identifier%></span>
                        <hr>
                        <strong>
                            <span>联系电话:</span>
                        </strong>
                        <span>
                            <%if(contactTel=="") {%>
                            暂未填写联系电话
                            <%}else {%>
                            <%=contactTel%>
                            <%}%>
                        </span>
                        <hr>
                        <strong>
                            <span>联系邮箱:</span>
                        </strong>
                        <span>
                            <%if(email=="") {%>
                            暂未填写联系邮箱
                            <%}else {%>
                            <%=email%>
                            <%}%></span>
                        <hr>
                        <strong>
                            <span>学院:</span>
                        </strong>
                        <span><%=college%></span>
                        <hr>
                        <strong>
                            <span>系:</span>
                        </strong>
                        <span><%=major%></span>
                        <hr>
                        <strong>
                            <span>班级:</span>
                        </strong>
                        <span><%=grade%>级 - <%=classNo%>班</span>
                        <hr>
                        <strong>
                            <span>性别:</span>
                        </strong>
                        <span><%=sex%></span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm btn-info" data-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </script>
    <!--查看学生详细信息结束-->
    <!--过程文档提交情况开始-->
    <div class="modal fade" id="documentationDetails" role="dialog">
    </div>
    <script id="documentationDetailses" type="text/template">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">过程文档提交情况</h4>
                </div>
                <div class="modal-body">
                    <div class="alert alert-success">
                        <strong>
                            <span>姓名（学号）:</span>
                        </strong>
                        <span>
                            <%=data.name%>(<%=data.identifier%>)
                        </span>
                        <hr>
                        <strong>
                            <span>课题题目:</span>
                        </strong>
                        <span>
                            <%=data.pName%>
                        </span>
                        <hr>
                        <strong>
                            <span>开题报告:</span>
                        </strong>
                        <span>
                            <%if(typeof(data.openingReport)=="undefined"){%>
                            <span class="colorf44">未提交</span>
                            <%}else{%>
                            <span class="color07c160">已提交</span>
                            <%}%>
                        </span>
                        <hr>
                        <strong>
                            <span>中期检查:</span>
                        </strong>
                        <span>
                            <%if(typeof(data.midInspection)=="undefined"){%>
                            <span class="colorf44">未提交</span>
                            <%}else{%>
                            <span class="color07c160">已提交</span>
                            <%}%>
                        </span>
                        <hr>
                        <strong>
                            <span>指导记录:</span>
                        </strong>
                        <span>
                            <%if(typeof(data.guidanceRecordList)=="undefined"||data.guidanceRecordList.length==0){%>
                            <span class="colorf44">未提交</span>
                            <%}else{%>
                            <%
                            let guide = (data.guidanceRecordList.length)/10*100;
                            %>
                            <span class="color07c160">已提交<span class="colorf44"><%=guide%>%</span></span>
                            <%}%>
                        </span>
                        <hr>
                        <strong>
                            <span>外文译文和原文:</span>
                        </strong>
                        <span>
                            <%if(typeof(data.foreignOriginal)=="undefined"){%>
                            <span class="colorf44">未提交</span>
                            <%}else{%>
                            <span class="color07c160">已提交</span>
                            <%}%>
                        </span>
                        <hr>
                        <strong>
                            <span>文献综述:</span>
                        </strong>
                        <span>
                            <%if(typeof(data.literatureReview)=="undefined"){%>
                            <span class="colorf44">未提交</span>
                            <%}else{%>
                            <span class="color07c160">已提交</span>
                            <%}%>
                        </span>
                        <hr>
                        <strong>
                            <span>毕业设计（论文）:</span>
                        </strong>
                        <span>
                            <%if(typeof(data.graduationProject)=="undefined"){%>
                            <span class="colorf44">未提交</span>
                            <%}else{%>
                            <span class="color07c160">已提交</span>
                            <%}%>
                        </span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm btn-info" data-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </script>
    <!--过程文档提交情况结束-->
    <!--教师详细信息开始 -->
    <div class="modal fade" id="teacherDetails" role="dialog">
    </div>
    <script id="teacherDetailses" type="text/template">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">教师详细信息</h4>
                </div>
                <div class="modal-body">
                    <div class="alert alert-success">
                        <strong>
                            <span>教师姓名（工号）:</span>
                        </strong>
                        <span>
                            <%=name%>（<%=identifier%>）
                        </span>
                        <hr>
                        <strong>
                            <span>教师职称:</span>
                        </strong>
                        <span><%=title%></span>
                        <hr>
                        <strong>
                            <span>教师联系邮箱:</span>
                        </strong>
                        <span>
                            <%if(email=="") {%>
                            该教师暂未填写联系邮箱
                            <%}else{%>
                            <%=email%>
                            <%}%>
                        </span>
                        <hr>
                        <strong>
                            <span>教师联系电话:</span>
                        </strong>
                        <span>
                            <%if(contactTel=="") {%>
                            该教师暂未填写联系电话
                            <%}else{%>
                            <%=contactTel%>
                            <%}%>
                        </span>
                        <hr>
                        <strong>
                            <span>学院:</span>
                        </strong>
                        <span><%=college%></span>
                        <hr>
                        <strong>
                            <span>系:</span>
                        </strong>
                        <span><%=department%></span>
                        <hr>
                        <strong>
                            <span>性别:</span>
                        </strong>
                        <span><%=sex%></span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm btn-info" data-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </script>
    <!--教师详细信息结束 -->
    <!--查看课题详细信息开始-->
    <div style="overflow-y:scroll" class="modal fade" id="topicDetails" role="dialog">
    </div>
    <script id="topicDetailses" type="text/template">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">课题详细信息</h4>
                </div>
                <div class="modal-body">
                    <div class="alert alert-success">
                        <strong>
                            <span>课题题目:</span>
                        </strong>
                        <span><%=data.title%></span>
                        <hr>
                        <strong>
                            <span>题目简介:</span>
                        </strong>
                        <span>
                            <%=data.briefIntro%>
                        </span>
                        <hr>
                        <strong>
                            <span>题目来源:</span>
                        </strong>
                        <span><%=data.source%></span>
                        <hr>
                        <strong>
                            <span>题目类型:</span>
                        </strong>
                        <span><%=data.genre%></span>
                        <hr>
                        <%if(typeof(setDate)!="undefined") {%>
                        <strong>
                            <span>出题时间:</span>
                        </strong>
                        <span><%
                                        var unixTimestamp = new Date( setDate ) ;
                                        commonTime = unixTimestamp.toLocaleString();
                                        %>
                                        <%= commonTime %></span>
                        <hr>
                        <%}%>
                        <strong>
                            <span>已选人数/容纳人数:</span>
                        </strong>
                        <span><%=data.rest%>/<%=data.number%></span>
                        <hr>
                        <strong>
                            <span>可选范围:</span>
                        </strong>
                        <span><%=data.range%></span>
                        <hr>
                        <strong>
                            <span>所属专业:</span>
                        </strong>
                        <span><%=data.major%></span>
                        <hr>
                        <strong>
                            <span>附件:</span>
                        </strong>
                        <span>
                            <% if(data.fileId == 0 || typeof(data.file)=="undefined") { %>
                                        暂未上传题目相关附件
                                        <% } else { %>
                                        附件：<%=data.file.fileName %> <a style="padding-left: 20px"
                                                                       href="http://www.yuanbw.cn:20086/gpms/rol/downloadFile?fileId=<%=data.fileId %>">点击下载</a>
                                        <% } %>
                        </span>
                        <hr>
                        <strong>
                            <span>任务书:</span>
                        </strong>
                        <span>
                            <% if(typeof(data.taskBook)=="undefined" || data.taskBook.fileId == 0) { %>
                                        暂未上传任务书
                                        <% } else { %>
                                        附件：<%=data.taskBook.file.fileName %> <a style="padding-left: 20px"
                                                                                href="http://www.yuanbw.cn:20086/gpms/rol/downloadFile?fileId=<%=data.taskBook.fileId %>">点击下载</a>
                                        <% } %>
                        </span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm btn-info" data-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </script>
    <!--查看课题详细信息结束-->

    <!--新闻浏览-->
    <div id="new" class="commmon news displayNone" style="height: 100%">
    </div>
    <script>
        $("#new").load("../commonHtml/news.html");
    </script>

    <!--历届优秀浏览开始-->
    <div id="pastExcellent" class="commmon good displayNone" style="height: 100%">
    </div>
    <script>
        $("#pastExcellent").load("../commonHtml/pastExcellent.html");
    </script>
    <!--历届优秀浏览结束-->

    <!--通知-->
    <div id="announcements" class="commmonTop messageNotice displayNone" style="height: 100%">
    </div>
    <script>
        $("#announcements").load("../commonHtml/announcements.html");
    </script>

    <!--公告-->
    <div id="ProclamationNotice" class="commmonTop messageNotice displayNone" style="height: 100%">
    </div>
    <script>
        $("#ProclamationNotice").load("../commonHtml/proclamation.html");
    </script>

    <!--个人信息-->
    <div id="personInfo" class="commmonTop personal displayNone" style="height: 100%">
    </div>
    <script>
        $("#personInfo").load("../commonHtml/personal.html");
    </script>

    <!--退出登录-->
    <div id="login" class="bounced displayNone">
    </div>
    <script>
        $("#login").load("../commonHtml/logOut.html");
    </script>

    <!--修改密码-->
    <div id="changePassword" class="commmonTop passwordChange displayNone" style="height: 100%">
    </div>
    <script>
        $("#changePassword").load("../commonHtml/changePassword.html");
    </script>
</div>

</div>
<!--jquery.pagination.js-->
<script src="../assets/js/jquery.pagination.js"></script>
<!-- Bootstrap Js -->
<script src="../assets/js/bootstrap.js"></script>
<script src="../assets/js/sideCloseOpen.js"></script>
<!-- 自定义函数 Js -->
<script src="../assets/js/commonFunction.js"></script>
<!--圆形进度条-->
<!-- easypiechart-data Js -->
<script src="../assets/js/easypiechart-data.js"></script>
<!-- easypiechart Js -->
<script src="../assets/js/easypiechart.js"></script>
<script src="../assets/js/ejs.js"></script>
<script src="../assets/js/xlsx.full.min.js"></script>
<script>
    $("#noticeAnnouncement").hover(function () {
        UnReadNotifications();
        showUnReadNotices();
        unRead()
    }, function () {
    });

    window.onload = function () {
        unRead();
    }

    //出题情况统计报表导出
    function btn_export() {
        statisticalTopicConditions(teaId, teaName, hasSet, "count" + teacherCount);
    }

    //选题情况统计报表导出
    function exportStudent() {
        statisticalSelectConditions(stuIdChoose, stuNameChoose, hasChoose, "count" + studentCount);
    }

    //题目情况统计报表导出
    function exportTitle() {
        titleLists("", pNameTitle, rangeTitle, genreTitle, sourceTitle, statusTitle, "count" + titleCount);
    }

    //答辩教师统计报表
    function exportAnswerTeacher() {
        defensemManagement(tidValue, tNameValue, "", "", groupNumValue, "", weekValue, dayValue, defClassValue, "export");
    }

    //答辩学生统计报表
    function exportDefenseStudents() {
        queryStudentsPleaConditions(stuPleaId, stuPleaName, "count" + studentPleaCount);
    }

    //成绩汇总统计报表
    function exportScore() {
        summaryReportResults(stuResultId, stuResultName, teaResultId, teaResultName, "count" + scoreCount);
    }

    //材料归档统计报表
    function exportMaterial() {
        archivingStatistics(stuMaterialId, stuMaterialName, "count" + materialCount);
    }

    function exportTable(data, name) {
        /* 如果没有导入xlsx组件则导入 */
        if (typeof XLSX == 'undefined') XLSX = require('xlsx');
        let ws = XLSX.utils.json_to_sheet(data);
        let wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "People");
        XLSX.writeFile(wb, name + ".xlsx");
    }

    let token = getCookie("token");
    let authority = getCookie("authority");
    if (token == "" || token == null || authority != 3) {
        window.location.href = "../login/login.html";
    }
    $(function () {
        PersonalInfo();
        reviewQuestions('', '', '', '', 'not', '');
    });

    function PersonalInfo() {
        let url = "http://www.yuanbw.cn:20086/gpms/rol/showRoleInfo";
        $.ajax({
            url: url,
            type: "POST",
            data: {},
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.statusCode == "100") {
                    let html = responseStr.data.name + '(' + responseStr.data.identifier + ')，欢迎使用系统';
                    $('#information').html(html);
                } else if (responseStr.statusCode == "102") {
                    alert(responseStr.msg);
                    window.location.href = "../login/login.html";
                } else {
                    let html = "暂无数据";
                    $('#information').html(html);
                }
            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }
</script>

<script>
    //添加答辩教师
    let teachers = [];
    //添加答辩组长
    let leader = [];
    //添加指导教师
    let tutor = [];

    //出题情况统计表
    function statisticalTopic() {
        whetherTitle();
        statisticalTopicConditions("", "", "", "notOne");
    }

    //查询出题与未出题教师数量
    function whetherTitle() {
        let hasDraws = document.getElementById('hasDraws').innerHTML;
        let hasDraw = document.getElementById('hasDraw');
        let url = "http://www.yuanbw.cn:20086/gpms/tea/showDepTeaCount";
        $.ajax({
            url: url,
            type: "POST",
            data: {},
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.statusCode == "100") {
                    hasDraw.innerHTML = ejs.render(hasDraws, {data: responseStr.data});
                } else if (responseStr.statusCode == "102") {
                    alert(responseStr.msg);
                    window.location.href = "../login/login.html";
                } else {
                    hasDraw.innerHTML = ejs.render(hasDraws, {data: ""});
                }
            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }

    //条件查询出题情况
    let pageCount = 1;
    let titles;
    let teacherCount;

    function statisticalTopicConditions(tid, tName, hasSet, isOne) {
        let len = isOne.length;
        let end = isOne.slice(5, len);
        let start = isOne.substring(0, 5);
        let datas = [];
        let url = "http://www.yuanbw.cn:20086/gpms/tea/showDepTeachers";
        let limit = 4;
        let offset = 0;
        if (start == "count") {
            limit = end;
        }
        let data = {limit: limit, offset: offset};
        if (tid != "") {
            data.tid = tid;
        }
        if (tName != "") {
            data.tName = tName;
        }
        if (hasSet != "") {
            data.hasSet = hasSet;
        }
        $.ajax({
            url: url,
            type: "POST",
            data: data,
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.statusCode == "100") {
                    teacherCount = responseStr.data.count;
                    if (isOne == "one") {
                        let teacherDetailses = document.getElementById('teacherDetailses').innerHTML;
                        let teacherDetails = document.getElementById('teacherDetails');
                        let teacher = responseStr.data.teacherList[0];
                        teacherDetails.innerHTML = ejs.render(teacherDetailses, {
                            identifier: teacher.identifier,
                            name: teacher.name,
                            title: teacher.title,
                            email: teacher.email,
                            contactTel: teacher.contactTel,
                            college: teacher.college,
                            department: teacher.department,
                            sex: teacher.sex
                        });
                    } else if (isOne == "titles") {
                        let moreTopicses = document.getElementById('moreTopicses').innerHTML;
                        let moreTopics = document.getElementById('moreTopics');
                        let proSetList = responseStr.data.teacherList[0].proSetList;
                        titles = proSetList;
                        moreTopics.innerHTML = ejs.render(moreTopicses, {
                            data: proSetList
                        });
                    } else if (start == "count") {
                        let dataList = [];
                        let index = 0;
                        datas = responseStr.data.teacherList;
                        datas.forEach(function (data) {
                            index++;
                            let pros = "";
                            data.proSetList.forEach(function (pro) {
                                pros = pros + pro.project.title + "   ";
                            })
                            dataList.push({
                                "编号": index,
                                "出题教师": data.name,
                                "出题教师工号": data.identifier,
                                "题目": pros,
                                "出题数量": data.proSetList.length,
                            })
                        })
                        exportTable(dataList, "出题情况统计报表");
                    } else {
                        let titleLists = document.getElementById('titleLists').innerHTML;
                        let titleList = document.getElementById('titleList');
                        let msg = responseStr.msg;
                        if (msg == "查询成功") {
                            pageCount = Math.ceil(responseStr.data.count / limit);
                            titleList.innerHTML = ejs.render(titleLists, {data: responseStr.data.teacherList});
                            $('#teachersPage').pagination({
                                pageCount: pageCount,
                                jump: true,
                                coping: true,
                                homePage: '首页',
                                endPage: '末页',
                                prevContent: '上页',
                                nextContent: '下页',
                                callback: function (api) {
                                    let page = api.getCurrent();
                                    offset = (page - 1) * limit;
                                    data.offset = offset;
                                    $.ajax({
                                        url: url,
                                        type: "POST",
                                        data: data,
                                        xhrFields: {
                                            withCredentials: true
                                        },
                                        crossDomain: true,
                                        headers: {
                                            Token: token
                                        },
                                        success: function (responseStr) {
                                            let msg = responseStr.msg;
                                            if (responseStr.statusCode == "100") {
                                                pageCount = Math.ceil(responseStr.data.count / limit);
                                                if (responseStr.data.teacherList.length > 0) {
                                                    titleList.innerHTML = ejs.render(titleLists, {data: responseStr.data.teacherList});
                                                }
                                            }
                                            if (msg == "系统繁忙") {
                                                alert("系统繁忙,请不要点击过快！");
                                            }
                                        },
                                        error: function (responseStr) {
                                            window.location.href = "../404/404.html";
                                        }
                                    });
                                }
                            });
                        } else if (responseStr.statusCode == "102") {
                            alert(responseStr.msg);
                            window.location.href = "../login/login.html";
                        } else {
                            titleList.innerHTML = ejs.render(titleLists, {data: ""});
                        }
                    }
                } else if (responseStr.statusCode == "102") {
                    alert(responseStr.msg);
                    window.location.href = "../login/login.html";
                } else {
                    if (start == "count") {
                        alert("数据为空，暂不支持导出！");
                    }
                    let titleLists = document.getElementById('titleLists').innerHTML;
                    let titleList = document.getElementById('titleList');
                    titleList.innerHTML = ejs.render(titleLists, {data: ""});
                }

            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }

    //条件查询教师出题
    let hasSet;
    let teaName;
    let teaId;

    function queryDraw() {
        hasSet = document.getElementById('hasSet').value;
        teaName = document.getElementById('teaName').value;
        teaId = document.getElementById('teaId').value;
        statisticalTopicConditions(teaId, teaName, hasSet, "notOne");
        document.getElementById('teaId').value = "";
        document.getElementById('teaName').value = "";
        document.getElementById('hasSet').options[0].selected = true;
    }

    //查看教师详细信息传入id
    function teacherById(id) {
        statisticalTopicConditions(id, "", "", "one");
    }

    //查看教师更多题目
    function moreTitles(id) {
        statisticalTopicConditions(id, "", "", "titles")
    }

    //查看课题详细信息
    function projectDetails(moreTopics, titleid) {
        $('#' + moreTopics).modal('hide');
        titles.forEach(function (title) {
            if (title.project.id == titleid) {
                let topicDetailses = document.getElementById('topicDetailses').innerHTML;
                let topicDetails = document.getElementById('topicDetails');
                topicDetails.innerHTML = ejs.render(topicDetailses, {
                    data: title.project,
                    setDate: title.setDate
                });
            }
        })
    }

    //学生选题统计表
    function statisticalSelect() {
        whetherSelect();
        statisticalSelectConditions("", "", "", "notOne");
    }

    //查询选题与未选题学生数量
    function whetherSelect() {
        let hasSelects = document.getElementById('hasSelects').innerHTML;
        let hasSelect = document.getElementById('hasSelect');
        let url = "http://www.yuanbw.cn:20086/gpms/tea/showDepStuCount";
        $.ajax({
            url: url,
            type: "POST",
            data: {},
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.statusCode == "100") {
                    hasSelect.innerHTML = ejs.render(hasSelects, {data: responseStr.data});
                } else if (responseStr.statusCode == "102") {
                    alert(responseStr.msg);
                    window.location.href = "../login/login.html";
                } else {
                    hasSelect.innerHTML = ejs.render(hasSelects, {data: ""});
                }
            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }

    //条件查询选题、未选题学生
    let studentCount;

    function statisticalSelectConditions(sid, sName, hasChoose, isOne) {
        let len = isOne.length;
        let end = isOne.slice(5, len);
        let start = isOne.substring(0, 5);
        let url = "http://www.yuanbw.cn:20086/gpms/tea/showDepStudents";
        let limit = 4;
        let offset = 0;
        if (start == "count") {
            limit = end;
        }
        let data = {limit: limit, offset: offset};
        if (sid != "") {
            data.sid = sid;
        }
        if (sName != "") {
            data.sName = sName;
        }
        if (hasChoose != "") {
            data.hasChoose = hasChoose;
        }
        $.ajax({
            url: url,
            type: "POST",
            data: data,
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.statusCode == "100") {
                    studentCount = responseStr.data.count;
                    if (isOne == "one") {
                        let studentDetailses = document.getElementById('studentDetailses').innerHTML;
                        let studentDetails = document.getElementById('studentDetails');
                        let student = responseStr.data.studentList[0];
                        studentDetails.innerHTML = ejs.render(studentDetailses, {
                            identifier: student.identifier,
                            name: student.name,
                            email: student.email,
                            contactTel: student.contactTel,
                            college: student.college,
                            major: student.major,
                            sex: student.sex,
                            grade: student.grade,
                            classNo: student.classNo
                        });
                    } else if (isOne == "title") {
                        let topicDetailses = document.getElementById('topicDetailses').innerHTML;
                        let topicDetails = document.getElementById('topicDetails');
                        topicDetails.innerHTML = ejs.render(topicDetailses, {
                            data: responseStr.data.studentList[0].checkedPro
                        });
                    } else if (start == "count") {
                        let dataList = [];
                        let index = 0;
                        let datas = responseStr.data.studentList;
                        datas.forEach(function (data) {
                            index++;
                            let gtName = "";
                            let gtId = "";
                            if (data.pName != "") {
                                gtName = data.gt.name;
                                gtId = data.gt.id;
                            }
                            dataList.push({
                                "编号": index,
                                "学生姓名": data.name,
                                "学生学号": data.identifier,
                                "课题题目": data.pName,
                                "出题教师姓名": gtName,
                                "出题教师工号": gtId
                            })
                        })
                        exportTable(dataList, "选题情况统计报表")
                    } else {
                        let studentLists = document.getElementById('studentLists').innerHTML;
                        let studentList = document.getElementById('studentList');
                        let msg = responseStr.msg;
                        if (msg == "查询成功") {
                            pageCount = Math.ceil(responseStr.data.count / limit);
                            studentList.innerHTML = ejs.render(studentLists, {data: responseStr.data.studentList});
                            $('#studentPage').pagination({
                                pageCount: pageCount,
                                jump: true,
                                coping: true,
                                homePage: '首页',
                                endPage: '末页',
                                prevContent: '上页',
                                nextContent: '下页',
                                callback: function (api) {
                                    let page = api.getCurrent();
                                    offset = (page - 1) * limit;
                                    data.offset = offset;
                                    $.ajax({
                                        url: url,
                                        type: "POST",
                                        data: data,
                                        xhrFields: {
                                            withCredentials: true
                                        },
                                        crossDomain: true,
                                        headers: {
                                            Token: token
                                        },
                                        success: function (responseStr) {
                                            let msg = responseStr.msg;
                                            if (msg == "查询成功") {
                                                pageCount = Math.ceil(responseStr.data.count / limit);
                                                if (responseStr.data.studentList.length > 0) {
                                                    studentList.innerHTML = ejs.render(studentLists, {data: responseStr.data.studentList});
                                                }
                                            }
                                            if (msg == "系统繁忙") {
                                                alert("系统繁忙,请不要点击过快！");
                                            }
                                        },
                                        error: function (responseStr) {
                                            window.location.href = "../404/404.html";
                                        }
                                    });
                                }
                            });
                        } else if (responseStr.statusCode == "102") {
                            alert(responseStr.msg);
                            window.location.href = "../login/login.html";
                        } else {
                            if (start == "count") {
                                alert("数据为空，暂不支持导出！");
                            }
                            studentList.innerHTML = ejs.render(studentLists, {data: ""});
                        }
                    }
                } else if (responseStr.statusCode == "102") {
                    alert(responseStr.msg);
                    window.location.href = "../login/login.html";
                } else {
                    if (start == "count") {
                        alert("数据为空，暂不支持导出！")
                    }
                    let studentLists = document.getElementById('studentLists').innerHTML;
                    let studentList = document.getElementById('studentList');
                    studentList.innerHTML = ejs.render(studentLists, {data: ""});
                }
            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }

    //根据id查询学生信息
    function queryStudentInfo(id) {
        statisticalSelectConditions(id, "", "", "one");
    }

    //根据id查询学生选题课题信息
    function studentProjectDetails(id) {
        statisticalSelectConditions(id, "", "", "title")
    }

    //根据条件查询学生选题信息
    let hasChoose;
    let stuNameChoose;
    let stuIdChoose;

    function queryIsChoose() {
        hasChoose = document.getElementById('hasChoose').value;
        stuNameChoose = document.getElementById('stuName').value;
        stuIdChoose = document.getElementById('stuId').value;
        statisticalSelectConditions(stuIdChoose, stuNameChoose, hasChoose, "notOne");
        document.getElementById('stuId').value = "";
        document.getElementById('stuName').value = "";
        document.getElementById('hasChoose').options[0].selected = true;
    }

    //题目统计报表
    function statisticalTitle() {
        titleNumber();
        titleLists("", "", "", "", "", "", "notOne")
    }

    //系主任查看题目数量情况
    function titleNumber() {
        let numberOfTitles = document.getElementById('numberOfTitles').innerHTML;
        let numberOfTitle = document.getElementById('numberOfTitle');
        let url = "http://www.yuanbw.cn:20086/gpms/tea/showDepProCount";
        $.ajax({
            url: url,
            type: "POST",
            data: {},
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.statusCode == "100") {
                    numberOfTitle.innerHTML = ejs.render(numberOfTitles, {data: responseStr.data});
                } else if (responseStr.statusCode == "102") {
                    alert(responseStr.msg);
                    window.location.href = "../login/login.html";
                } else {
                    numberOfTitle.innerHTML = ejs.render(numberOfTitles, {data: ""});
                }
            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }

    //根据条件查询题目列表
    let titleCount;

    function titleLists(pid, pName, range, genre, source, status, isOne) {
        let len = isOne.length;
        let end = isOne.slice(5, len);
        let start = isOne.substring(0, 5);
        let url = "http://www.yuanbw.cn:20086/gpms/tea/showDepProjects";
        let limit = 4;
        let offset = 0;
        if (start == "count") {
            limit = end;
        }
        let data = {limit: limit, offset: offset};
        if (pid != "") {
            data.pid = pid;
        }
        if (pName != "") {
            data.pName = pName;
        }
        if (range != "") {
            data.rangeType = range;
        }
        if (genre != "") {
            data.genre = genre;
        }
        if (source != "") {
            data.source = source;
        }
        if (status != "") {
            data.status = status;
        }
        $.ajax({
            url: url,
            type: "POST",
            data: data,
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.statusCode == "100") {
                    titleCount = responseStr.data.count;
                    if (isOne == "student") {
                        let studentDetailses = document.getElementById('studentDetailses').innerHTML;
                        let studentDetails = document.getElementById('studentDetails');
                        let students = responseStr.data.projectList[0].choose_stu_list;
                        let student;
                        students.forEach(function (studentI) {
                            if (studentI.identifier == studentById) {
                                student = studentI;
                            }
                        })
                        studentDetails.innerHTML = ejs.render(studentDetailses, {
                            identifier: student.identifier,
                            name: student.name,
                            email: student.email,
                            contactTel: student.contactTel,
                            college: student.college,
                            major: student.major,
                            sex: student.sex,
                            grade: student.grade,
                            classNo: student.classNo
                        });
                    } else if (isOne == "teacher") {
                        let teacherDetailses = document.getElementById('teacherDetailses').innerHTML;
                        let teacherDetails = document.getElementById('teacherDetails');
                        let teacher = responseStr.data.projectList[0].set_tea;
                        teacherDetails.innerHTML = ejs.render(teacherDetailses, {
                            identifier: teacher.identifier,
                            name: teacher.name,
                            title: teacher.title,
                            email: teacher.email,
                            contactTel: teacher.contactTel,
                            college: teacher.college,
                            department: teacher.department,
                            sex: teacher.sex
                        });
                    } else if (isOne == "title") {
                        let topicDetailses = document.getElementById('topicDetailses').innerHTML;
                        let topicDetails = document.getElementById('topicDetails');
                        topicDetails.innerHTML = ejs.render(topicDetailses, {
                            data: responseStr.data.projectList[0]
                        });
                    } else if (start == "count") {
                        let dataList = [];
                        let index = 0;
                        datas = responseStr.data.projectList;
                        datas.forEach(function (data) {
                            let students = "";
                            data.choose_stu_list.forEach(function (stu) {
                                students = students + stu.name + '(' + stu.identifier + ') ';
                            })
                            index++;
                            dataList.push({
                                "编号": index,
                                "课题题目": data.title,
                                "题目来源": data.source,
                                "题目类型": data.genre,
                                "可选专业": data.range,
                                "已选人数": data.choose_stu_list.length,
                                "选题学生（学号）": students,
                                "出题教师姓名": data.set_tea.name,
                                "出题教师工号": data.set_tea.identifier,
                                "容纳总人数": data.number,
                                "目前可选人数": data.rest,
                            })
                        })
                        exportTable(dataList, "题目情况统计报表")
                    } else {
                        let listOfTitles = document.getElementById('listOfTitles').innerHTML;
                        let listOfTitle = document.getElementById('listOfTitle');
                        let msg = responseStr.msg;
                        if (msg == "查询成功") {
                            pageCount = Math.ceil(responseStr.data.count / limit);
                            listOfTitle.innerHTML = ejs.render(listOfTitles, {data: responseStr.data.projectList});
                            $('#titlePage').pagination({
                                pageCount: pageCount,
                                jump: true,
                                coping: true,
                                homePage: '首页',
                                endPage: '末页',
                                prevContent: '上页',
                                nextContent: '下页',
                                callback: function (api) {
                                    let page = api.getCurrent();
                                    offset = (page - 1) * limit;
                                    data.offset = offset;
                                    $.ajax({
                                        url: url,
                                        type: "POST",
                                        data: data,
                                        xhrFields: {
                                            withCredentials: true
                                        },
                                        crossDomain: true,
                                        headers: {
                                            Token: token
                                        },
                                        success: function (responseStr) {
                                            let msg = responseStr.msg;
                                            if (responseStr.statusCode == "100") {
                                                pageCount = Math.ceil(responseStr.data.count / limit);
                                                if (responseStr.data.projectList.length > 0) {
                                                    listOfTitle.innerHTML = ejs.render(listOfTitles, {data: responseStr.data.projectList});
                                                }
                                            } else if (msg == "系统繁忙") {
                                                alert("系统繁忙,请不要点击过快！");
                                            } else if (responseStr.statusCode == "102") {
                                                alert(responseStr.msg);
                                                window.location.href = "../login/login.html";
                                            } else {
                                                listOfTitle.innerHTML = ejs.render(listOfTitles, {data: ""});
                                            }
                                        },
                                        error: function (responseStr) {
                                            window.location.href = "../404/404.html";
                                        }
                                    });
                                }
                            });
                        } else if (responseStr.statusCode == "101") {
                            listOfTitle.innerHTML = ejs.render(listOfTitles, {data: ""});
                        }
                    }
                } else if (responseStr.statusCode == "102") {
                    alert(responseStr.msg);
                    window.location.href = "../login/login.html";
                } else {
                    if (start == "count") {
                        alert("数据为空，暂不支持导出！");
                    }
                    let listOfTitles = document.getElementById('listOfTitles').innerHTML;
                    let listOfTitle = document.getElementById('listOfTitle');
                    listOfTitle.innerHTML = ejs.render(listOfTitles, {data: ""});
                }
            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }

    //根据题目id查询题目信息
    function TitleById(id, info) {
        titleLists(id, "", "", "", "", "", info)
    }

    //根据id查看学生信息
    let studentById;

    function TitleByStudent(id, student, identifier) {
        studentById = identifier;
        titleLists(id, "", "", "", "", "", student);
    }

    //根据条件查询题目信息
    let pNameTitle;
    let rangeTitle;
    let genreTitle;
    let sourceTitle;
    let statusTitle;

    function queryTitle() {
        pNameTitle = document.getElementById('pName').value;
        rangeTitle = document.getElementById('range').value;
        genreTitle = document.getElementById('genre').value;
        sourceTitle = document.getElementById('source').value;
        statusTitle = document.getElementById('status').value;
        titleLists("", pNameTitle, rangeTitle, genreTitle, sourceTitle, statusTitle, "notOne");
        document.getElementById('pName').value = "";
        document.getElementById('range').options[0].selected = true;
        document.getElementById('genre').options[0].selected = true;
        document.getElementById('source').options[0].selected = true;
        document.getElementById('status').options[0].selected = true;
    }

    //查询系内教师答辩分组
    function defensemTeacher() {
        defensemManagement("", "", "", "", "", "", "", "", "", "");
        showDepDefDate();
        showDefInfoLists();
    }

    //根据条件查询教师答辩分组
    let leaderOriginal = [];
    let teachersOriginal = [];

    function defensemManagement(tid, tName, groupId, groupSize, groupNum, defDate, week, day, defClass, isOne) {
        let url = "http://www.yuanbw.cn:20086/gpms/tea/showDepTeaDefGroup";
        let teachersGroups = document.getElementById('teachersGroups').innerHTML;
        let teachersGroup = document.getElementById('teachersGroup');
        let data = {};
        if (tid != "") {
            data.tid = tid;
        }
        if (tName != "") {
            data.tName = tName;
        }
        if (groupId != "") {
            data.groupId = groupId;
        }
        if (groupSize != "") {
            data.groupSize = groupSize;
        }
        if (groupNum != "") {
            data.groupNum = groupNum;
        }
        if (defDate != "") {
            data.defDate = defDate;
        }
        if (week != "") {
            data.week = week;
        }
        if (day != "") {
            data.day = day;
        }
        if (defClass != "") {
            data.defClass = defClass;
        }
        $.ajax({
            url: url,
            type: "POST",
            data: data,
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.statusCode == "100") {
                    if (groupId != "") {
                        leader = [];
                        teachers = [];
                        leaderOriginal = [];
                        teachersOriginal = [];
                        responseStr.data[0].teaGroup.forEach(function (teacher) {
                            if (teacher.leader) {
                                leader.push({
                                    value: teacher.teaAuth.id,
                                    text: teacher.teaAuth.name
                                });
                                leaderOriginal.push({
                                    value: teacher.teaAuth.id,
                                    text: teacher.teaAuth.name
                                });
                            } else {
                                teachers.push({
                                    value: teacher.teaAuth.id,
                                    text: teacher.teaAuth.name
                                });
                                teachersOriginal.push({
                                    value: teacher.teaAuth.id,
                                    text: teacher.teaAuth.name
                                });
                            }
                        })
                        let modify_Teachers_Groups = document.getElementById('modify_Teachers_Groups').innerHTML;
                        let modify_Teachers_Group = document.getElementById('modify_Teachers_Group');
                        modify_Teachers_Group.innerHTML = ejs.render(modify_Teachers_Groups, {
                            data: responseStr.data[0],
                            leader: leader,
                            teachers: teachers
                        });
                        optionalDefenseTeacher();
                        $("#weeks").val(responseStr.data[0].defWeek);
                        $("#whatDay").val(responseStr.data[0].defDay);
                        let time = new Date(responseStr.data[0].defDate);
                        let day = ("0" + time.getDate()).slice(-2);
                        let month = ("0" + (time.getMonth() + 1)).slice(-2);
                        let today = time.getFullYear() + "-" + (month) + "-" + (day);
                        $('#date_Teachers_Group').val(today);
                    } else if (isOne == "export") {
                        let dataList = [];
                        let index = 0;
                        let datas = responseStr.data;
                        datas.forEach(function (data) {
                            index++;
                            let leaderTea = "";
                            let teachersTea = "";
                            data.teaGroup.forEach(function (tea) {
                                if (tea.leader) {
                                    leaderTea = leaderTea + tea.teaAuth.name + '(' + tea.teaAuth.id + ')' + '(组长) ';
                                } else {
                                    teachersTea = teachersTea + tea.teaAuth.name + '(' + tea.teaAuth.id + ') ';
                                }
                            })
                            teachersTea = leaderTea + teachersTea;
                            let defWeek = '第' + data.defWeek + '周';
                            let defDay = '星期' + data.defDay;
                            let unixTimestamp = new Date(data.defDate);
                            let year = unixTimestamp.getFullYear();
                            let month = unixTimestamp.getMonth() + 1;
                            let date = unixTimestamp.getDate();
                            let defDate = year + "年" + month + "月" + date + "日";
                            let peopleNum = data.groupSize + ' / ' + data.groupNum;
                            let groupId = '第' + data.groupId + '组';
                            dataList.push({
                                "编号": index,
                                "分组": groupId,
                                "答辩教师人数": data.teaGroup.length,
                                "答辩教师（工号）": teachersTea,
                                "答辩周数": defWeek,
                                "答辩星期": defDay,
                                "答辩日期": defDate,
                                "答辩时间": '上午 8:00',
                                "答辩教室": data.defClass,
                                "人数限制 / 现有人数": peopleNum
                            })
                        })
                        exportTable(dataList, "答辩教师分组情况统计报表")
                    } else {
                        teachersGroup.innerHTML = ejs.render(teachersGroups, {data: responseStr.data});
                    }
                } else if (responseStr.statusCode == "102") {
                    alert(responseStr.msg);
                    window.location.href = "../login/login.html";
                } else {
                    if (isOne == "export") {
                        alert("数据为空，暂不支持导出！");
                    }
                    teachersGroup.innerHTML = ejs.render(teachersGroups, {data: ""});
                }

            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }

    //根据条件查询教师答辩分组
    let tidValue, tNameValue, groupNumValue, weekValue, dayValue, defClassValue;

    function queryTeachersPlea() {
        let tid = document.getElementById('tid');
        let tName = document.getElementById('tName');
        let groupNum = document.getElementById('groupNum');
        let week = document.getElementById('defWeek');
        let day = document.getElementById('day');
        let defClass = document.getElementById('defClass');
        tidValue = tid.value;
        tNameValue = tName.value;
        groupNumValue = groupNum.value;
        weekValue = week.value;
        dayValue = day.value;
        defClassValue = defClass.value;
        defensemManagement(tidValue, tNameValue, "", "", groupNumValue, "", weekValue, dayValue, defClassValue, "");
        tid.value = "";
        tName.value = "";
        groupNum.value = "";
        week.value = "";
        day.value = "";
        defClass.value = "";
    }

    //根据条件查询学生分组
    let studentPleaCount;

    function queryStudentsPleaConditions(id, name, isOne) {
        let len = isOne.length;
        let end = isOne.slice(5, len);
        let start = isOne.substring(0, 5);
        let datas = [];
        let url = "http://www.yuanbw.cn:20086/gpms/tea/showDepStuDefGroup";
        let studentsGroups = document.getElementById('studentsGroups').innerHTML;
        let studentsGroup = document.getElementById('studentsGroup');
        let limit = 4;
        let offset = 0;
        if (start == "count") {
            limit = end;
        }
        let data = {limit: limit, offset: offset};
        if (id != "") {
            data.id = id;
        }
        if (name != "") {
            data.name = name;
        }
        $.ajax({
            url: url,
            type: "POST",
            data: data,
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.statusCode == "100") {
                    if (start == "count") {
                        let dataList = [];
                        let index = 0;
                        datas = responseStr.data.studentLists;
                        datas.forEach(function (data) {
                            index++;
                            let gtName = "";
                            let gtId = "";
                            let leaderTea = "";
                            let teachersTea = "";
                            let pleaNumber = 0;
                            let defWeek = "";
                            let defDay = "";
                            let defDate = "";
                            let peopleNum = "";
                            let groupId = "";
                            let mtName = "";
                            let mtId = "";
                            let time = "";
                            let defClass = "";
                            if (typeof (data.defInfo) != "undefined") {
                                data.defInfo.teaGroup.forEach(function (tea) {
                                    if (tea.leader) {
                                        leaderTea = leaderTea + tea.teaAuth.name + '(' + tea.teaAuth.id + ')' + '(组长) ';
                                    } else {
                                        teachersTea = teachersTea + tea.teaAuth.name + '(' + tea.teaAuth.id + ') ';
                                    }
                                })
                                pleaNumber = data.defInfo.teaGroup.length;
                                teachersTea = leaderTea + teachersTea;
                                defWeek = '第' + data.defInfo.defWeek + '周';
                                defDay = '星期' + data.defInfo.defDay;
                                let unixTimestamp = new Date(data.defInfo.defDate);
                                let year = unixTimestamp.getFullYear();
                                let month = unixTimestamp.getMonth() + 1;
                                let date = unixTimestamp.getDate();
                                defDate = year + "年" + month + "月" + date + "日";
                                time = defWeek + " " + defDay + " " + defDate;
                                peopleNum = data.defInfo.groupSize + ' / ' + data.defInfo.groupNum;
                                groupId = '第' + data.defInfo.groupId + '组';
                                defClass = data.defInfo.defClass;
                            }
                            if (typeof (data.gt) != "undefined") {
                                gtName = data.gt.name;
                                gtId = data.gt.id;
                            }
                            if (typeof (data.mt) != "undefined") {
                                mtName = data.mt.name;
                                mtId = data.mt.id;
                            }
                            dataList.push({
                                "编号": index,
                                "分组": groupId,
                                "学生姓名": data.name,
                                "学生学号": data.identifier,
                                "指导教师姓名": gtName,
                                "指导教师工号": gtId,
                                "答辩时间": time,
                                "答辩教师数量": pleaNumber,
                                "答辩教师（工号）": teachersTea,
                                "答辩教室": defClass,
                                "答辩教室": defClass,
                                "人数限制/现有人数": peopleNum,
                                "评阅教师姓名": mtName,
                                "评阅教师工号": mtId,
                            })
                        })
                        exportTable(dataList, "学生答辩情况统计报表");
                    } else {
                        studentPleaCount = responseStr.data.count;
                        pageCount = Math.ceil(responseStr.data.count / limit);
                        studentsGroup.innerHTML = ejs.render(studentsGroups, {data: responseStr.data.studentLists});
                        $('#studentPleaPage').pagination({
                            pageCount: pageCount,
                            jump: true,
                            coping: true,
                            homePage: '首页',
                            endPage: '末页',
                            prevContent: '上页',
                            nextContent: '下页',
                            callback: function (api) {
                                let page = api.getCurrent();
                                offset = (page - 1) * limit;
                                data.offset = offset;
                                $.ajax({
                                    url: url,
                                    type: "POST",
                                    data: data,
                                    xhrFields: {
                                        withCredentials: true
                                    },
                                    crossDomain: true,
                                    headers: {
                                        Token: token
                                    },
                                    success: function (responseStr) {
                                        let msg = responseStr.msg;
                                        if (msg == "查询成功") {
                                            pageCount = Math.ceil(responseStr.data.count / limit);
                                            if (responseStr.data.studentLists.length > 0) {
                                                studentsGroup.innerHTML = ejs.render(studentsGroups, {data: responseStr.data.studentLists});
                                            }
                                        }
                                        if (msg == "系统繁忙") {
                                            alert("系统繁忙,请不要点击过快！");
                                        }
                                    },
                                    error: function (responseStr) {
                                        window.location.href = "../404/404.html";
                                    }
                                });
                            }
                        });
                    }
                } else if (responseStr.statusCode == "102") {
                    alert(responseStr.msg);
                    window.location.href = "../login/login.html";
                } else {
                    console.log(responseStr)
                    if (start == "count") {
                        alert("数据为空，暂不支持导出！");
                    }
                    studentsGroup.innerHTML = ejs.render(studentsGroups, {data: ""});
                }
            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }

    //根据条件查询学生列表
    let stuPleaName, stuPleaId;

    function queryStudentsPlea() {
        stuPleaName = document.getElementById('stuPleaName').value;
        stuPleaId = document.getElementById('stuPleaId').value;
        queryStudentsPleaConditions(stuPleaId, stuPleaName, "");
        document.getElementById('stuPleaName').value = "";
        document.getElementById('stuPleaId').value = "";
    }

    //计算答辩总评成绩
    function computationalResults(id, name, isOther) {
        let url = "http://www.yuanbw.cn:20086/gpms/tea/showDepStuScoreList";
        let scoreLists = document.getElementById('scoreLists').innerHTML;
        let scoreList = document.getElementById('scoreList');
        let limit = 4;
        let offset = 0;
        let data = {limit: limit, offset: offset};
        if (id != "") {
            data.id = id;
        }
        if (name != "") {
            data.name = name;
        }
        $.ajax({
            url: url,
            type: "POST",
            data: data,
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.statusCode == "100") {
                    if (isOther == "not") {
                        pageCount = Math.ceil(responseStr.data.count / limit);
                        scoreList.innerHTML = ejs.render(scoreLists, {data: responseStr.data.studentList});
                        $('#studentsPage').pagination({
                            pageCount: pageCount,
                            jump: true,
                            coping: true,
                            homePage: '首页',
                            endPage: '末页',
                            prevContent: '上页',
                            nextContent: '下页',
                            callback: function (api) {
                                let page = api.getCurrent();
                                offset = (page - 1) * limit;
                                data.offset = offset;
                                $.ajax({
                                    url: url,
                                    type: "POST",
                                    data: data,
                                    xhrFields: {
                                        withCredentials: true
                                    },
                                    crossDomain: true,
                                    headers: {
                                        Token: token
                                    },
                                    success: function (responseStr) {
                                        let msg = responseStr.msg;
                                        if (msg == "查询成功") {
                                            pageCount = Math.ceil(responseStr.data.count / limit);
                                            if (responseStr.data.studentList.length > 0) {
                                                scoreList.innerHTML = ejs.render(scoreLists, {data: responseStr.data.studentList});
                                            }
                                        }
                                        if (msg == "系统繁忙") {
                                            alert("系统繁忙,请不要点击过快！");
                                        }
                                    },
                                    error: function (responseStr) {
                                        window.location.href = "../404/404.html";
                                    }
                                });
                            }
                        });
                    } else if (isOther == "student") {
                        let studentDetailses = document.getElementById('studentDetailses').innerHTML;
                        let studentDetails = document.getElementById('studentDetails');
                        let student = responseStr.data.studentList[0];
                        studentDetails.innerHTML = ejs.render(studentDetailses, {
                            identifier: student.identifier,
                            name: student.name,
                            email: student.email,
                            contactTel: student.contactTel,
                            college: student.college,
                            major: student.major,
                            sex: student.sex,
                            grade: student.grade,
                            classNo: student.classNo
                        });
                    }
                } else if (responseStr.statusCode == "102") {
                    alert(responseStr.msg);
                    window.location.href = "../login/login.html";
                } else {
                    scoreList.innerHTML = ejs.render(scoreLists, {data: ""});
                }

            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }

    //条件查询答辩总评成绩
    function studentListQuery() {
        let stuNameList = document.getElementById('stuNameList');
        let stuIdList = document.getElementById('stuIdList');
        computationalResults(stuIdList.value, stuNameList.value, 'not');
        stuNameList.value = "";
        stuIdList.value = "";
    }

    //成绩汇总统计报表
    let scoreCount;

    function summaryReportResults(id, name, tid, tName, isRanking) {
        let len = isRanking.length;
        let end = isRanking.slice(5, len);
        let start = isRanking.substring(0, 5);
        let datas = [];
        let url = "http://www.yuanbw.cn:20086/gpms/tea/showDepStuScoreSummaryList";
        let studentsScores = document.getElementById('studentsScores').innerHTML;
        let studentsScore = document.getElementById('studentsScore');
        let limit = 4;
        let offset = 0;
        if (start == "count") {
            limit = end;
        }
        let data = {limit: limit, offset: offset};
        if (id != "") {
            data.id = id;
        }
        if (name != "") {
            data.name = name;
        }
        if (tid != "") {
            data.tid = tid;
        }
        if (tName != "") {
            data.tName = tName;
        }
        $.ajax({
            url: url,
            type: "POST",
            data: data,
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.statusCode == "100") {
                    scoreCount = responseStr.data.count;
                    if (isRanking == "ranking") {
                        pageCount = Math.ceil(responseStr.data.count / limit);
                        studentsScore.innerHTML = ejs.render(studentsScores, {
                            data: responseStr.data.studentLists,
                            offset: offset
                        });
                        $('#scorePage').pagination({
                            pageCount: pageCount,
                            jump: true,
                            coping: true,
                            homePage: '首页',
                            endPage: '末页',
                            prevContent: '上页',
                            nextContent: '下页',
                            callback: function (api) {
                                let page = api.getCurrent();
                                offset = (page - 1) * limit;
                                data.offset = offset;
                                $.ajax({
                                    url: url,
                                    type: "POST",
                                    data: data,
                                    xhrFields: {
                                        withCredentials: true
                                    },
                                    crossDomain: true,
                                    headers: {
                                        Token: token
                                    },
                                    success: function (responseStr) {
                                        let msg = responseStr.msg;
                                        if (msg == "查询成功") {
                                            pageCount = Math.ceil(responseStr.data.count / limit);
                                            if (responseStr.data.studentLists.length > 0) {
                                                studentsScore.innerHTML = ejs.render(studentsScores, {
                                                    data: responseStr.data.studentLists,
                                                    offset: offset
                                                });
                                            }
                                        }
                                        if (msg == "系统繁忙") {
                                            alert("系统繁忙,请不要点击过快！");
                                        }
                                    },
                                    error: function (responseStr) {
                                        window.location.href = "../404/404.html";
                                    }
                                });
                            }
                        });
                    } else if (start == "count") {
                        let dataList = [];
                        let index = 0;
                        datas = responseStr.data.studentLists;
                        datas.forEach(function (data) {
                            index++;
                            let scoreTotal = "";
                            let scoreGt = "";
                            let scoreMt = "";
                            let scoreDef = "";
                            let grade = "";
                            if (typeof (data.proScore) != "undefined") {
                                if (data.proScore.hasReviewed) {
                                    scoreTotal = data.proScore.scoreTotal;
                                    scoreGt = data.proScore.scoreGt;
                                    scoreMt = data.proScore.scoreMt;
                                    scoreDef = data.proScore.scoreDef;
                                    grade = data.proScore.grade;
                                }
                            }
                            dataList.push({
                                "成绩排名": index,
                                "学生姓名": data.name,
                                "学生学号": data.identifier,
                                "课题题目": data.pName,
                                "指导成绩": scoreGt,
                                "评阅成绩": scoreMt,
                                "答辩成绩": scoreDef,
                                "综合评定成绩": scoreTotal,
                                "综合评定等级": grade
                            })
                        })
                        exportTable(dataList, "成绩汇总报表");
                    } else if (isRanking == "student") {
                        let studentDetailses = document.getElementById('studentDetailses').innerHTML;
                        let studentDetails = document.getElementById('studentDetails');
                        let student = responseStr.data.studentLists[0];
                        studentDetails.innerHTML = ejs.render(studentDetailses, {
                            identifier: student.identifier,
                            name: student.name,
                            email: student.email,
                            contactTel: student.contactTel,
                            college: student.college,
                            major: student.major,
                            sex: student.sex,
                            grade: student.grade,
                            classNo: student.classNo
                        });
                    } else if (isRanking == "title") {
                        let topicDetailses = document.getElementById('topicDetailses').innerHTML;
                        let topicDetails = document.getElementById('topicDetails');
                        topicDetails.innerHTML = ejs.render(topicDetailses, {
                            data: responseStr.data.studentLists[0].checkedPro
                        });
                    }
                } else if (responseStr.statusCode == "102") {
                    alert(responseStr.msg);
                    window.location.href = "../login/login.html";
                } else {
                    if (start == "count") {
                        alert("数据为空，暂不支持导出！");
                    }
                    studentsScore.innerHTML = ejs.render(studentsScores, {data: ""});
                }

            },
            error: function (responseStr) {
                // window.location.href = "../404/404.html";
            }
        });
    }

    //根据条件查询成绩列表
    let stuResultName = "", stuResultId = "", teaResultId = "", teaResultName = "";

    function queryResultList() {
        stuResultName = document.getElementById('stuResultName').value;
        stuResultId = document.getElementById('stuResultId').value;
        teaResultId = document.getElementById('teaResultId').value;
        teaResultName = document.getElementById('teaResultName').value;
        summaryReportResults(stuResultId, stuResultName, teaResultId, teaResultName, "ranking");
        document.getElementById('stuResultName').value = "";
        document.getElementById('stuResultId').value = "";
        document.getElementById('teaResultId').value = "";
        document.getElementById('teaResultName').value = "";
    }

    //材料归档统计报表
    let materialCount;

    function archivingStatistics(id, name, isRanking) {
        let len = isRanking.length;
        let end = isRanking.slice(5, len);
        let start = isRanking.substring(0, 5);
        let url = "http://www.yuanbw.cn:20086/gpms/tea/materialFiling";
        let materialArchives = document.getElementById('materialArchives').innerHTML;
        let materialArchive = document.getElementById('materialArchive');
        let limit = 4;
        let offset = 0;
        if (start == "count") {
            limit = end;
        }
        let data = {limit: limit, offset: offset};
        if (id != "") {
            data.id = id;
        }
        if (name != "") {
            data.name = name;
        }
        $.ajax({
            url: url,
            type: "POST",
            data: data,
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.statusCode == "100") {
                    materialCount = responseStr.data.count;
                    if (isRanking == "ranking") {
                        materialArchive.innerHTML = ejs.render(materialArchives, {
                            data: responseStr.data.studentLists
                        });
                        pageCount = Math.ceil(responseStr.data.count / limit);
                        $('#studentMaterialPage').pagination({
                            pageCount: pageCount,
                            jump: true,
                            coping: true,
                            homePage: '首页',
                            endPage: '末页',
                            prevContent: '上页',
                            nextContent: '下页',
                            callback: function (api) {
                                let page = api.getCurrent();
                                offset = (page - 1) * limit;
                                data.offset = offset;
                                $.ajax({
                                    url: url,
                                    type: "POST",
                                    data: data,
                                    xhrFields: {
                                        withCredentials: true
                                    },
                                    crossDomain: true,
                                    headers: {
                                        Token: token
                                    },
                                    success: function (responseStr) {
                                        let msg = responseStr.msg;
                                        if (msg == "查询成功") {
                                            pageCount = Math.ceil(responseStr.data.count / limit);
                                            if (responseStr.data.studentLists.length > 0) {
                                                materialArchive.innerHTML = ejs.render(materialArchives, {
                                                    data: responseStr.data.studentLists
                                                });
                                            }
                                        }
                                        if (msg == "系统繁忙") {
                                            alert("系统繁忙,请不要点击过快！");
                                        }
                                    },
                                    error: function (responseStr) {
                                        window.location.href = "../404/404.html";
                                    }
                                });
                            }
                        });
                    } else if (isRanking == "student") {
                        let studentDetailses = document.getElementById('studentDetailses').innerHTML;
                        let studentDetails = document.getElementById('studentDetails');
                        let student = responseStr.data.studentLists[0];
                        studentDetails.innerHTML = ejs.render(studentDetailses, {
                            email: student.email,
                            contactTel: student.contactTel,
                            college: student.college,
                            major: student.major,
                            sex: student.sex,
                            grade: student.grade,
                            identifier: student.identifier,
                            name: student.name,
                            classNo: student.classNo
                        });
                    } else if (isRanking == "title") {
                        let topicDetailses = document.getElementById('topicDetailses').innerHTML;
                        let topicDetails = document.getElementById('topicDetails');
                        topicDetails.innerHTML = ejs.render(topicDetailses, {
                            data: responseStr.data.studentLists[0].checkedPro
                        });
                    } else if (isRanking == "documentation") {
                        let documentationDetailses = document.getElementById('documentationDetailses').innerHTML;
                        let documentationDetails = document.getElementById('documentationDetails');
                        documentationDetails.innerHTML = ejs.render(documentationDetailses, {
                            data: responseStr.data.studentLists[0]
                        });
                    } else if (start == "count") {
                        let dataList = [];
                        let index = 0;
                        let datas = responseStr.data.studentLists;
                        datas.forEach(function (data) {
                            let gtName = "";
                            let gtId = "";
                            if (typeof (data.gt) != "undefined") {
                                gtName = data.gt.name;
                                gtId = data.gt.id;
                            }
                            let openingReport = "未提交";
                            let midInspection = "未提交";
                            let guidanceRecordList = "未提交";
                            let foreignOriginal = "未提交";
                            let literatureReview = "未提交";
                            let graduationProject = "未提交";
                            if (typeof (data.openingReport) != "undefined") {
                                openingReport = "已提交";
                            }
                            if (typeof (data.midInspection) != "undefined") {
                                midInspection = "已提交";
                            }
                            if (typeof (data.guidanceRecordList) != "undefined" && data.guidanceRecordList.length != 0) {
                                let guide = (data.guidanceRecordList.length) / 10 * 100;
                                guidanceRecordList = "已提交" + guide + "%";
                            }
                            if (typeof (data.foreignOriginal) != "undefined") {
                                foreignOriginal = "已提交";
                            }
                            if (typeof (data.literatureReview) != "undefined") {
                                literatureReview = "已提交";
                            }
                            if (typeof (data.graduationProject) != "undefined") {
                                graduationProject = "已提交";
                            }
                            index++;
                            dataList.push({
                                "编号": index,
                                "学生姓名": data.name,
                                "学生学号": data.identifier,
                                "专业": data.major,
                                "班级": data.grade + "级 - " + data.classNo + "班",
                                "性别": data.sex,
                                "课题题目": data.pName,
                                "指导教师姓名": gtName,
                                "指导教师工号": gtId,
                                "开题报告": openingReport,
                                "中期检查": midInspection,
                                "指导记录": guidanceRecordList,
                                "外文译文和原文": foreignOriginal,
                                "文献综述": literatureReview,
                                "毕业设计（论文）": graduationProject,
                            })
                        })
                        exportTable(dataList, "材料归档统计报表");
                    }
                } else if (responseStr.statusCode == "102") {
                    alert(responseStr.msg);
                    window.location.href = "../login/login.html";
                } else if (responseStr.statusCode == "104") {
                    alert("系统繁忙，请不要点击过快！");
                } else  {
                    materialArchive.innerHTML = ejs.render(materialArchives, {data: ""});
                }
            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }

    //根据条件查询材料归档统计报表
    let stuMaterialId = "", stuMaterialName = "";

    function queryMaterialArchive() {
        stuMaterialId = document.getElementById('stuMaterialId').value;
        stuMaterialName = document.getElementById('stuMaterialName').value;
        archivingStatistics(stuMaterialId, stuMaterialName, "ranking");
        document.getElementById('stuMaterialId').value = "";
        document.getElementById('stuMaterialName').value = "";
    }

    //查询教师出题
    function reviewQuestions(tid, tName, pName, status, isId, pid) {
        let url = "http://www.yuanbw.cn:20086/gpms/tea/showTeaProSetList";
        let drawLists = document.getElementById('drawLists').innerHTML;
        let drawList = document.getElementById('drawList');
        let limit = 4;
        let offset = 0;
        let data = {limit: limit, offset: offset};
        if (tid != "") {
            data.tid = tid;
        }
        if (pid != "") {
            data.pid = pid;
        }
        if (tName != "") {
            data.tName = tName;
        }
        if (pName != "") {
            data.pName = pName;
        }
        if (status != "") {
            data.status = status;
        }
        $.ajax({
            url: url,
            type: "POST",
            data: data,
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.statusCode == "100") {
                    if (isId == "not") {
                        pageCount = Math.ceil(responseStr.data.count / limit);
                        drawList.innerHTML = ejs.render(drawLists, {data: responseStr.data.proList});
                        $('#drawAudit').pagination({
                            pageCount: pageCount,
                            jump: true,
                            coping: true,
                            homePage: '首页',
                            endPage: '末页',
                            prevContent: '上页',
                            nextContent: '下页',
                            callback: function (api) {
                                let page = api.getCurrent();
                                offset = (page - 1) * limit;
                                data.offset = offset;
                                $.ajax({
                                    url: url,
                                    type: "POST",
                                    data: data,
                                    xhrFields: {
                                        withCredentials: true
                                    },
                                    crossDomain: true,
                                    headers: {
                                        Token: token
                                    },
                                    success: function (responseStr) {
                                        let msg = responseStr.msg;
                                        if (responseStr.statusCode == "100") {
                                            pageCount = Math.ceil(responseStr.data.count / limit);
                                            if (responseStr.data.proList.length > 0) {
                                                drawList.innerHTML = ejs.render(drawLists, {data: responseStr.data.proList});
                                            }
                                        }
                                        if (msg == "系统繁忙") {
                                            alert("系统繁忙,请不要点击过快！");
                                        }
                                    },
                                    error: function (responseStr) {
                                        window.location.href = "../404/404.html";
                                    }
                                });
                            }
                        });
                    } else if (isId == "title") {
                        let topicDetailses = document.getElementById('topicDetailses').innerHTML;
                        let topicDetails = document.getElementById('topicDetails');
                        topicDetails.innerHTML = ejs.render(topicDetailses, {
                            data: responseStr.data.proList[0].project,
                            setDate: responseStr.data.proList[0].setDate
                        });
                    } else if (isId == "titleAudit") {
                        let checkDraws = document.getElementById('checkDraws').innerHTML;
                        let checkDraw = document.getElementById('checkDraw');
                        checkDraw.innerHTML = ejs.render(checkDraws, {
                            data: responseStr.data.proList[0].project,
                            setDate: responseStr.data.proList[0].setDate,
                            teacherId: responseStr.data.proList[0].teacher.identifier
                        });
                    } else if (isId == "teacher") {
                        let teacherDetailses = document.getElementById('teacherDetailses').innerHTML;
                        let teacherDetails = document.getElementById('teacherDetails');
                        let teacher = responseStr.data.proList[0].teacher;
                        teacherDetails.innerHTML = ejs.render(teacherDetailses, {
                            identifier: teacher.identifier,
                            name: teacher.name,
                            title: teacher.title,
                            email: teacher.email,
                            contactTel: teacher.contactTel,
                            college: teacher.college,
                            department: teacher.department,
                            sex: teacher.sex
                        });
                    }
                } else if (responseStr.statusCode == "102") {
                    alert(responseStr.msg);
                    window.location.href = "../login/login.html";
                } else {
                    drawList.innerHTML = ejs.render(drawLists, {data: ""});
                }

            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }

    //条件查询教师出题
    function queryDrawTea() {
        let titleStatus = document.getElementById('titleStatus');
        let titleTeaId = document.getElementById('titleTeaId');
        let titleTeaName = document.getElementById('titleTeaName');
        let titleName = document.getElementById('titleName');
        reviewQuestions(titleTeaId.value, titleTeaName.value, titleName.value, titleStatus.value, 'not', "");
        titleTeaId.value = "";
        titleTeaName.value = "";
        titleName.value = "";
        titleStatus.options[0].selected = true;
    }

    //审核教师出题
    function verifyTeaProject(tid, pid, status) {
        let suggest = document.getElementById('suggest').value;
        let url = "http://www.yuanbw.cn:20086/gpms/tea/verifyTeaProject";
        $.ajax({
            url: url,
            type: "POST",
            data: {
                tid: tid,
                pid: pid,
                status: status,
                suggest: suggest
            },
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                alert(responseStr.msg);
                reviewQuestions('', '', '', '', 'not', '');
            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
        // alert(teaId,pid,status)
    }

    //学生选题审核
    function TopicSelectionAudit(sid, sName, pid, pName, cStatus, isQuery) {
        let url = "http://www.yuanbw.cn:20086/gpms/tea/showStuProChooseList";
        let selections = document.getElementById('selections').innerHTML;
        let selection = document.getElementById('selection');
        let limit = 4;
        let offset = 0;
        let data = {limit: limit, offset: offset};
        if (sid != "") {
            data.sid = sid;
        }
        if (sName != "") {
            data.sName = sName;
        }
        if (pid != "") {
            data.pid = pid;
        }
        if (pName != "") {
            data.pName = pName;
        }
        if (cStatus != "") {
            data.cStatus = cStatus;
        }
        $.ajax({
            url: url,
            type: "POST",
            data: data,
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.statusCode == "100") {
                    if (isQuery == "not") {
                        pageCount = Math.ceil(responseStr.data.count / limit);
                        selection.innerHTML = ejs.render(selections, {data: responseStr.data.proChooseList});
                        $('#selectionPage').pagination({
                            pageCount: pageCount,
                            jump: true,
                            coping: true,
                            homePage: '首页',
                            endPage: '末页',
                            prevContent: '上页',
                            nextContent: '下页',
                            callback: function (api) {
                                let page = api.getCurrent();
                                offset = (page - 1) * limit;
                                data.offset = offset;
                                $.ajax({
                                    url: url,
                                    type: "POST",
                                    data: data,
                                    xhrFields: {
                                        withCredentials: true
                                    },
                                    crossDomain: true,
                                    headers: {
                                        Token: token
                                    },
                                    success: function (responseStr) {
                                        let msg = responseStr.msg;
                                        if (responseStr.statusCode == "100") {
                                            pageCount = Math.ceil(responseStr.data.count / limit);
                                            if (responseStr.data.proChooseList.length > 0) {
                                                selection.innerHTML = ejs.render(selections, {data: responseStr.data.proChooseList});
                                            }
                                        }
                                        if (msg == "系统繁忙") {
                                            alert("系统繁忙,请不要点击过快！");
                                        }
                                    },
                                    error: function (responseStr) {
                                        window.location.href = "../404/404.html";
                                    }
                                });
                            }
                        });
                    } else if (isQuery == "student") {
                        let studentDetailses = document.getElementById('studentDetailses').innerHTML;
                        let studentDetails = document.getElementById('studentDetails');
                        let student = responseStr.data.proChooseList[0].student;
                        studentDetails.innerHTML = ejs.render(studentDetailses, {
                            identifier: student.identifier,
                            name: student.name,
                            email: student.email,
                            contactTel: student.contactTel,
                            college: student.college,
                            major: student.major,
                            sex: student.sex,
                            grade: student.grade,
                            classNo: student.classNo
                        });
                    }
                } else if (responseStr.statusCode == "102") {
                    alert(responseStr.msg);
                    window.location.href = "../login/login.html";
                } else {
                    selection.innerHTML = ejs.render(selections, {data: ""});
                }

            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }

    //根据条件查询学生选题
    function queryStuList() {
        let sid = document.getElementById('sid');
        let sName = document.getElementById('sName');
        let stuPName = document.getElementById('stuPName');
        let cStatus = document.getElementById('cStatus');
        TopicSelectionAudit(sid.value, sName.value, '', stuPName.value, cStatus.value, "not");
        sid.value = "";
        sName.value = "";
        stuPName.value = "";
        cStatus.options[0].selected = true;
    }

    //审核学生选题
    function SubjectToReview(sid, pid, Status) {
        let url = "http://www.yuanbw.cn:20086/gpms/tea/verifyStuProject";
        $.ajax({
            url: url,
            type: "POST",
            data: {
                sid: sid,
                pid: pid,
                status: Status
            },
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                alert(responseStr.msg);
                TopicSelectionAudit('', '', '', '', '', "not");
            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }

    //审核学生选题传达信息
    function conveyId(sid, pid, Status) {
        $("#savePass").unbind("click").click(function () {
            SubjectToReview(sid, pid, Status);
        })
        $("#saveNoPass").unbind("click").click(function () {
            SubjectToReview(sid, pid, Status);
        })
    }

    //查看答辩开始和结束日期
    let timePlea = '';

    function showDepDefDate() {
        let url = "http://www.yuanbw.cn:20086/gpms/tea/showDepDefDate";
        let replyDates = document.getElementById('replyDates').innerHTML;
        let replyDate = document.getElementById('replyDate');
        $.ajax({
            url: url,
            type: "POST",
            data: {},
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.statusCode == "100") {
                    timePlea = responseStr.data;
                    replyDate.innerHTML = ejs.render(replyDates, {
                        data: responseStr.data
                    });
                } else if (responseStr.statusCode == "102") {
                    alert(responseStr.msg);
                    window.location.href = "../login/login.html";
                } else {
                    replyDate.innerHTML = ejs.render(replyDates, {
                        data: ""
                    });
                }
            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }

    //删除答辩组
    function deleteGroup(id) {
        $("#deleteDefenseGroup").unbind("click").click(function () {
            let url = "http://www.yuanbw.cn:20086/gpms/tea/deleteDefGroup";
            $.ajax({
                url: url,
                type: "POST",
                data: {
                    gid: id
                },
                xhrFields: {
                    withCredentials: true
                },
                crossDomain: true,
                headers: {
                    Token: token
                },
                success: function (responseStr) {
                    alert(responseStr.msg);
                    defensemTeacher();
                },
                error: function (responseStr) {
                    window.location.href = "../404/404.html";
                }
            });
        })
    }

    //修改答辩组
    function modifyGroup(groupId) {
        defensemManagement("", "", groupId, "", "", "", "", "", "", "");
    }

    //修改、新增答辩组
    function newDefenseArrangements(id) {
        let newData = {};
        let modifyData = {};
        let data;
        let date_Teachers_Group = document.getElementById('date_Teachers_Group').value;
        let weeks = document.getElementById('weeks').value;
        let whatDay = document.getElementById('whatDay').value;
        let classroom = document.getElementById('classroom').value;
        let numbeLimit = document.getElementById('numbeLimit').value;
        let week = $("#week").hasClass("displayBlock");
        let date = $("#date").hasClass("displayBlock");
        let teaIdList = [];
        let url;
        newData.groupSize = numbeLimit;
        newData.defClass = classroom;
        modifyData.gid = id;
        if (numbeLimit != "") {
            modifyData.groupSize = numbeLimit;
        }
        if (classroom != "") {
            modifyData.defClass = classroom;
        }
        if (week) {
            newData.defWeek = weeks;
            newData.defDay = whatDay;
            modifyData.defWeek = weeks;
            modifyData.defDay = whatDay;
        }
        if (date) {
            newData.defDate = date_Teachers_Group;
            modifyData.defDate = date_Teachers_Group;
        }
        if (leader.length > 0) {
            teaIdList.push({
                tid: parseInt(leader[0].value),
                leader: 1
            })
        }
        if (teachers.length > 0) {
            teachers.forEach(function (teacher) {
                teaIdList.push({
                    tid: parseInt(teacher.value),
                    leader: 0
                })
            })
        }
        newData.teaIdList = teaIdList;
        if (teaIdList.length > 0) {
            modifyData.teaIdList = teaIdList;
        }
        if (id == "") {
            url = "http://www.yuanbw.cn:20086/gpms/tea/addDefGroup";
            data = newData;
        } else {
            url = "http://www.yuanbw.cn:20086/gpms/tea/modifyDefGroup";
            data = modifyData;
        }
        $.ajax({
            url: url,
            type: "POST",
            contentType: "application/json",
            data: JSON.stringify(data),
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                alert(responseStr.msg);
                defensemTeacher();
            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }

    //查看系内答辩组
    let DefenseGroups;

    function showDefInfoLists() {
        let url = "http://www.yuanbw.cn:20086/gpms/tea/showDefInfoList";
        let instructorGroupings = document.getElementById('instructorGroupings').innerHTML;
        let instructorGrouping = document.getElementById('instructorGrouping');
        $.ajax({
            url: url,
            type: "POST",
            data: {},
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.statusCode == "100") {
                    DefenseGroups = responseStr.data;
                    instructorGrouping.innerHTML = ejs.render(instructorGroupings, {
                        data: responseStr.data
                    });
                } else if (responseStr.statusCode == "102") {
                    alert(responseStr.msg);
                    window.location.href = "../login/login.html";
                } else {
                    instructorGrouping.innerHTML = ejs.render(instructorGroupings, {
                        data: ""
                    });
                }
            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }

    //删除指导教师分组
    function deleTutorGroup(id) {
        $("#confirmDeleTutor").unbind("click").click(function () {
            let url = "http://www.yuanbw.cn:20086/gpms/tea/deleteDefTeaGroup";
            $.ajax({
                url: url,
                type: "POST",
                data: {
                    gid: id
                },
                xhrFields: {
                    withCredentials: true
                },
                crossDomain: true,
                headers: {
                    Token: token
                },
                success: function (responseStr) {
                    alert(responseStr.msg);
                    defensemTeacher();
                },
                error: function (responseStr) {
                    window.location.href = "../404/404.html";
                }
            });
        })
    }

    //添加、修改指导教师分组
    let originaltTutor = [];

    function NewTutorGroup(id) {
        tutor = [];
        originaltTutor = [];
        DefenseGroups.forEach(function (group) {
            if (id == group.id) {
                let Tutor_Groups = document.getElementById('Tutor_Groups').innerHTML;
                let Tutor_Group = document.getElementById('Tutor_Group');
                group.gtGroup.forEach(function (tea) {
                    tutor.push({
                        value: tea.teacher.id,
                        text: tea.teacher.name,
                        stuListCount: tea.teacher.stuListCount
                    });
                    originaltTutor.push({
                        value: tea.teacher.id,
                        text: tea.teacher.name,
                        stuListCount: tea.teacher.stuListCount
                    });
                });

                Tutor_Group.innerHTML = ejs.render(Tutor_Groups, {
                    data: group,
                    tutor: tutor
                });
            }
        });
        showUnAssignedGtList(id);
    }

    //查看可分配的指导教师
    function showUnAssignedGtList(id) {
        let url = "http://www.yuanbw.cn:20086/gpms/tea/showUnAssignedGtList";
        $.ajax({
            url: url,
            type: "POST",
            data: {
                gid: id
            },
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                let guide_Teacher = document.getElementById('guide_Teacher');
                responseStr.data.forEach(function (tea) {
                    guide_Teacher.innerHTML += '<option value=' + tea.id + '>' + tea.name + '(' + tea.stuListCount + ')</option>';
                })
            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }

    //保存修改、添加指导教师
    function saveTutor(id) {
        let data = {};
        let teaIdList = [];
        let url = "http://www.yuanbw.cn:20086/gpms/tea/modifyDefTeaGroup";
        tutor.forEach(function (teacher) {
            teaIdList.push(teacher.value.toString())
        });
        data.gid = id;
        data.gtList = teaIdList;
        $.ajax({
            url: url,
            type: "POST",
            contentType: "application/json",
            data: JSON.stringify(data),
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                alert(responseStr.msg);
                defensemTeacher();
            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }

    //分配学生
    function distributionStudents() {
        assignDefStuGroup();
        assignReviewTeaGroup();
    }

    //根据指导老师的分组来确定学生的分组情况(自动生成学生分组信息)
    function assignDefStuGroup() {
        let url = "http://www.yuanbw.cn:20086/gpms/tea/assignDefStuGroup";
        $.ajax({
            url: url,
            type: "POST",
            data: {},
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                alert(responseStr.msg);
            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }

    //根据答辩分组自动生成评阅分组，以及插入评审表
    function assignReviewTeaGroup() {
        let url = "http://www.yuanbw.cn:20086/gpms/tea/assignReviewTeaGroup";
        $.ajax({
            url: url,
            type: "POST",
            data: {},
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                // alert(responseStr.msg);
            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }

    //计算答辩总评成绩提交
    function calculateDefenseScore() {
        let url = "http://www.yuanbw.cn:20086/gpms/tea/commitStuTotalScore";
        $.ajax({
            url: url,
            type: "POST",
            data: {},
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                alert(responseStr.msg);
            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }


</script>

<script>
    // let teacherInfo = [];

    //答辩下拉框选择
    function optionalDefenseTeacher() {
        let weeks = document.getElementById('weeks');
        for (let i = timePlea.beginDate.week; i < timePlea.endDate.week; i++) {
            weeks.innerHTML += '<option value=' + i + '>第' + i + '周</option>';
        }
        let teacherInfo = [];
        let teamLeaderSelect = document.getElementById('teamLeaderSelect');
        let plea_Teacher = document.getElementById('plea_Teacher');
        let url = "http://www.yuanbw.cn:20086/gpms/tea/showUnAssignedTeaList";
        $.ajax({
            url: url,
            type: "POST",
            data: {},
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.statusCode == "100") {
                    teacherInfo = responseStr.data;
                    teacherInfo.forEach(function (teacher) {
                        teamLeaderSelect.innerHTML += '<option value=' + teacher.id + '>' + teacher.name + '</option>';
                        plea_Teacher.innerHTML += '<option value=' + teacher.id + '>' + teacher.name + '</option>';
                    })
                } else if (responseStr.statusCode == "102") {
                    alert(responseStr.msg);
                    window.location.href = "../login/login.html";
                }
            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }


    //新增答辩分组
    function newDefense() {
        let modify_Teachers_Groups = document.getElementById('modify_Teachers_Groups').innerHTML;
        let modify_Teachers_Group = document.getElementById('modify_Teachers_Group');
        modify_Teachers_Group.innerHTML = ejs.render(modify_Teachers_Groups, {data: ""});
        optionalDefenseTeacher();
        leader = [];
        teachers = [];
        $("#choose_teacher").children().remove();
        $("#teamLeader").children().remove();
        let textContent = document.getElementsByClassName('textContent');
        for (let i = 0; i < textContent.length; i++) {
            textContent[i].value = "";
        }
    }

    //答辩管理设定日期显示
    function showDate() {
        $("#date").attr("class", "displayBlock");
        $("#week").attr("class", "displayNone");
    }

    //答辩管理设定周数显示
    function showWeek() {
        $("#date").attr("class", "displayNone");
        $("#week").attr("class", "displayBlock");
    }

    function chooseteamLeader() {
        let teamLeaderSelect = document.getElementById('teamLeaderSelect');
        let index = teamLeaderSelect.selectedIndex;//获取被选中的option的索引
        let textsel = teamLeaderSelect.options[index].text;//获取相应的option的内容
        let teamLeader = document.getElementById('teamLeader');
        let value = teamLeaderSelect.value;
        let indexCommon = 0;
        if (leader.length < 1) {
            teachers.forEach(function (teacher) {
                if (teacher.value == value) {
                    indexCommon++;
                }
            });
            if (indexCommon == 0) {
                let divrow = document.createElement('div');
                divrow.setAttribute('id', 'teamLeader' + value);
                divrow.setAttribute('class', 'newTeacher');
                leader.push({
                    value: value,
                    text: textsel
                });
                divrow.innerHTML = '<div style="margin-bottom:10px;margin-left:4px;padding:0px;" class="col-md-2 col-xs-2">\n' +
                    '                                        <input readonly value=' + textsel + ' type="text" class="form-control"/>\n' +
                    '                                    </div>\n' +
                    '                                    <div style="padding: 0px" class="col-md-1  col-xs-1">\n' +
                    '                                        <span style="position: absolute;left: -8px;top: -10px;font-size: 20px" class="iconfont icon-shanchu" onclick="deleteLeader(' + value + ')"></span>\n' +
                    '                                    </div>';
                teamLeader.appendChild(divrow);
            } else if (indexCommon >= 1) {
                alert("答辩教师不能与答辩组长相同!");
            }
        } else if (leader.length == 1) {
            alert("选项个数达到最大,不能再添加!");
        }
    }

    //删除答辩组长
    function deleteLeader(id) {
        let teacher_id = document.getElementById('teamLeader' + id);
        let teamLeaderSelect = document.getElementById('teamLeaderSelect');
        for (let i = 0; i < leaderOriginal.length; i++) {
            if (leaderOriginal[i].value == id) {
                teamLeaderSelect.innerHTML += '<option value=' + leaderOriginal[i].value + '>' + leaderOriginal[i].text + '</option>';
                leaderOriginal.splice(i, 1);
            }
        }
        $(teacher_id).remove();
        leader.splice(0, 1);
    }


    function chooseTeacer() {
        let teamLeaderSelect = document.getElementById('plea_Teacher');
        let index = teamLeaderSelect.selectedIndex;//获取被选中的option的索引
        let textsel = teamLeaderSelect.options[index].text;//获取相应的option的内容
        let value = teamLeaderSelect.value;
        let choose_teacher = document.getElementById('choose_teacher');
        let indexCommon = 0;
        let leaderIndex = 0
        if (teachers.length < 4) {
            teachers.forEach(function (teacher) {
                if (teacher.value == value) {
                    indexCommon++;
                }
            });
            leader.forEach(function (leaderTutor) {
                if (leaderTutor.value == value) {
                    leaderIndex++;
                }
            });
            if (indexCommon == 0 && leaderIndex == 0) {
                let divrow = document.createElement('div');
                divrow.setAttribute('id', 'teacher' + value);
                teachers.push({
                    value: value,
                    text: textsel
                });
                divrow.innerHTML = '<div style="margin-bottom:10px;margin-left:4px;padding:0px;" class="col-md-2 col-xs-2">\n' +
                    '                                        <input readonly value=' + textsel + ' type="text" class="form-control"/>\n' +
                    '                                    </div>\n' +
                    '                                    <div style="padding: 0px" class="col-md-1  col-xs-1">\n' +
                    '                                        <span style="position: absolute;left: -8px;top: -10px;font-size: 20px" class="iconfont icon-shanchu" onclick="deleteTeacer(' + value + ')"></span>\n' +
                    '                                    </div>';
                choose_teacher.appendChild(divrow);
            } else if (indexCommon == 1) {
                alert("不能重复添加同一答辩教师!");
            } else if (leaderIndex == 1) {
                alert("答辩教师不能与答辩组长相同!");
            }
        } else if (teachers.length == 4) {
            alert("选项个数达到最大,不能再添加!");
        }
    }

    //删除答辩教师
    function deleteTeacer(value) {
        let teacher_id = document.getElementById('teacher' + value);
        let plea_Teacher = document.getElementById('plea_Teacher');
        $(teacher_id).remove();
        for (let i = 0; i < teachers.length; i++) {
            if (teachers[i].value == value) {
                for (let j = 0; j < teachersOriginal.length; j++) {
                    if (teachersOriginal[j].value == value) {
                        plea_Teacher.innerHTML += '<option value=' + teachersOriginal[j].value + '>' + teachersOriginal[j].text + '</option>';
                        teachersOriginal.splice(j, 1);
                    }
                }
                teachers.splice(i, 1);
                break;
            }
        }
    }

    //新增指导教师分组
    function newTutor() {
        tutor = [];
        $("#choose_tutor").children().remove();
    }

    function chooseTutor() {
        let guide_Teacher = document.getElementById('guide_Teacher');
        let index = guide_Teacher.selectedIndex;//获取被选中的option的索引
        let textsel = guide_Teacher.options[index].text;//获取相应的option的内容
        let value = guide_Teacher.value;
        let choose_tutor = document.getElementById('choose_tutor');
        let indexCommon = 0;
        if (tutor.length < 4) {
            tutor.forEach(function (tutors) {
                if (tutors.value == value) {
                    indexCommon++;
                    return;
                }
            });
            if (indexCommon == 0) {
                let divrow = document.createElement('div');
                divrow.setAttribute('id', 'tutor' + value);
                tutor.push({
                    value: value,
                    text: textsel
                });
                divrow.innerHTML = '<div class="col-md-4 col-xs-4"><div style="margin-bottom:10px;margin-left:4px;padding:0px;" class="col-md-10 col-xs-10">\n' +
                    '                                        <input readonly value=' + textsel + ' type="text" class="form-control"/>\n' +
                    '                                    </div>\n' +
                    '                                    <div style="padding: 0px" class="col-md-2 col-xs-2">\n' +
                    '                                        <span style="position: absolute;left: 110px;top: -64px;font-size: 20px" class="iconfont icon-shanchu" onclick="deleteTutor(' + value + ')"></span>\n' +
                    '                                    </div></div>';
                choose_tutor.appendChild(divrow);
            } else {
                alert("不能重复添加同一指导教师!");
            }
        } else if (tutor.length == 4) {
            alert("选项个数达到最大,不能再添加!");
        }
    }

    function deleteTutor(value) {
        let tutor_id = document.getElementById('tutor' + value);
        let guide_Teacher = document.getElementById('guide_Teacher');
        $(tutor_id).remove();
        for (let i = 0; i < tutor.length; i++) {
            if (tutor[i].value == value) {
                for (let j = 0; j < originaltTutor.length; j++) {
                    if (originaltTutor[j].value == value) {
                        guide_Teacher.innerHTML += '<option value=' + tutor[i].value + '>' + tutor[i].text + '(' + tutor[i].stuListCount + ')</option>';
                        originaltTutor.splice(j, 1);
                    }
                }
                tutor.splice(i, 1);
                break;
            }
        }
    }

</script>


<script>

    //答辩打分报告过程input输入框值限定
    function reportingProcessScore(reportingProcess, score) {
        ScoreTop(reportingProcess, score)
    }

    //答辩打分报告内容input输入框值限定
    function reportingContentScore(reportingContent, score) {
        ScoreTop(reportingContent, score)
    }

    //答辩打分实用价值input输入框值限定
    function applicableValueScore(applicableValue, score) {
        ScoreTop(applicableValue, score)
    }

    //答辩打分答辩input输入框值限定
    function pleaScore(plea, score) {
        ScoreTop(plea, score)
    }

    //毕业设计评审翻译资料、综述材料input输入框值限定
    function reviewTranslationScore(reviewTranslation, score) {
        ScoreTop(reviewTranslation, score)
    }

    //毕业设计评审设计质量及设计说明书质量input输入框值限定
    function designQualityScore(designQuality, score) {
        ScoreTop(designQuality, score)
    }

    //毕业设计评审创新input输入框值限定
    function innovationScore(innovation, score) {
        ScoreTop(innovation, score)
    }

    //毕业设计评审工作量、难度input输入框值限定
    function designQualityScore(workloadDifficulty, score) {
        ScoreTop(workloadDifficulty, score)
    }

    //毕业设计指导教师评审调查、论证input输入框值限定
    function investigationDemonstrationScore(investigationDemonstration, score) {
        ScoreTop(investigationDemonstration, score)
    }

    //毕业设计指导教师评审方案设计与技术路线input输入框值限定
    function technicalRouteScore(technicalRoute, score) {
        ScoreTop(technicalRoute, score)
    }

    //毕业设计指导教师评审分析与解决问题的能力input输入框值限定
    function analyzeSolveScore(analyzeSolve, score) {
        ScoreTop(analyzeSolve, score)
    }

    //毕业设计指导教师评审工作量、工作态度input输入框值限定
    function workAttitudeScore(workAttitude, score) {
        ScoreTop(workAttitude, score)
    }

    //毕业设计指导教师评审设计质量及设计说明书质量input输入框值限定
    function designSpecificationScore(designSpecification, score) {
        ScoreTop(designSpecification, score)
    }

    //毕业设计指导教师评审创新input输入框值限定
    function designInnovationScore(designInnovation, score) {
        ScoreTop(designInnovation, score)
    }

    function ScoreTop(idIput, top) {
        let text = document.getElementById(idIput);
        if (text.value > top) {
            text.value = top;
        } else if (text.value < 0) {
            text.value = 0;
        } else if (isNaN(text.value)) {
            text.value = "";
        }
    }

    //取消上传题目
    function Unupload(classOne, classOther, textContent) {
        returnFirst(classOne, classOther);
        cancelTitle(textContent);
    }
</script>


</body>
</html>
