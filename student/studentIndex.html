<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" panel="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="Access-Control-Allow-Origin" content="*">
    <title>四川工商学院毕业设计管理系统</title>
    <link rel="icon" href="../assets/img/bitbug_favicon.ico" type="img/x-ico"/>
    <!-- Bootstrap Styles-->
    <link href="../assets/css/bootstrap.css" rel="stylesheet"/>
    <!-- 字体图标 Styles-->
    <link href="../assets/css/iconfont.css" rel="stylesheet"/>
    <!-- 分页 Styles-->
    <link href="../assets/css/pagination.css" rel="stylesheet"/>
    <!-- 统一自定义 Styles-->
    <link href="../assets/css/custom-styles.css" rel="stylesheet"/>
    <!-- 学生界面自定义 Styles-->
    <link href="../assets/css/student.css" rel="stylesheet"/>
    <!-- jQuery Js -->
    <script src="../assets/js/jquery-1.10.2.js"></script>
    <!-- 自定义 Js -->
    <script src="../assets/js/common.js"></script>
</head>
<body>
<div id="wrapper">
    <!--顶部导航开始-->
    <nav class="navbar navbar-default top-navbar" role="navigation">
        <div class="navbar-header">
            <!--屏幕缩小时显示菜单按钮-->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".sidebar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">
                <img style="width: 40px;display: inline-block" src="../assets/img/crest.jpg" alt="">
                <strong>四川工商学院</strong>
            </a>
            <span id="sideNav" class="iconfont icon-right-s packUpIcon"></span>
        </div>
        <ul class="nav navbar-top-links navbar-right">
            <li style="color: #fff" id="information">

            </li>
            <script id="informations" type="text/template">
                <span style="padding-right: 20px">
                    姓名：<%= informations.name %>
                </span>
                <span style="padding-right: 20px">
                    学院：<%= informations.college %>
                </span>
                <span>
                    专业：<%= informations.major %>
                </span>
            </script>
            <!--任务进度开始-->
            <li class="noticeIcon">
                <a href="#">
                    <span class="iconfont icon-jindu iconColor fontSize14"></span>
                    <span class="iconfont icon-jiantou iconColor fontSize8"></span>
                </a>
                <div class="noticeContent">
                    <ul id="progress">

                    </ul>
                </div>
            </li>
            <script id="progresses" type="text/template">
                <% for(let i=0;i<3;i++) { %>
                <li>
                    <div>
                        <p class="fontsize14 padding0">
                            <strong><%= taskProgress[i].progressName %></strong>
                            <span class="pull-right text-muted"><%= taskProgress[i].progress %>%</span>
                        </p>
                        <div class="progress progress-striped active height10">
                            <div class="progress-bar progress-bar-info progressBar" style="width: 0%"></div>
                        </div>
                    </div>
                </li>
                <% } %>
                <li style="text-align: center;padding-bottom: 10px">
                    <a class="text-center" href="#" onclick="notice()">
                        <strong>查看更多任务进度</strong>
                    </a>
                </li>
            </script>
            <!--任务进度结束-->
            <!--通知公告开始-->
            <li class="noticeIcon">
                <a href="#">
                    <span class="iconfont icon-lingdang iconColor fontSize14"></span>
                    <span class="messageUnread textEllipsis">12</span>
                    <span class="iconfont icon-jiantou iconColor fontSize8"></span>
                </a>
                <div id="content" class="noticeContent" style="width: 400px">
                    <ul class="tab_menu">
                        <li style="width: 190px" class="selected">公告</li>
                        <li style="width: 190px">通知</li>
                    </ul>
                    <div class="horizontal"></div>
                    <div id="type0" class="type">
                        <ul>
                            <li class="liStyle liBorderBottom textEllipsis">
                                公告公告公告公告公告
                            </li>
                            <li class="liStyle liBorderBottom textEllipsis">
                                公告公告公告公告公告
                            </li>
                            <li class="liStyle liBorderBottom textEllipsis">
                                公告公告公告公告公告公告公告公告公告公告
                            </li>
                            <li class="liStyle liBorderBottom textEllipsis  text-center">
                                <a class="management_messageNotice text-center newPage topPage" href="#">
                                    <strong>查看更多公告</strong>
                                    <i class="fa fa-angle-right"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div id="type1" class="type hide">
                        <ul>
                            <li class="liStyle liBorderBottom textEllipsis">
                                通知通知通知通知通知通知通知
                            </li>
                            <li class="liStyle liBorderBottom textEllipsis">
                                通知通知通知通知通知通知通知通知通知
                            </li>
                            <li class="liStyle liBorderBottom textEllipsis">
                                公通知通知通知通知通知通知通知通知通知通知
                            </li>
                            <li class="liStyle liBorderBottom textEllipsis  text-center">
                                <a class="management_messageNotice text-center newPage topPage" href="#">
                                    <strong>查看更多通知</strong>
                                    <i class="fa fa-angle-right"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </li>
            <!--通知公告结束-->
            <!--个人信息开始-->
            <li class="noticeIcon">
                <a href="#">
                    <span class="iconfont icon-wode iconColor fontSize14"></span>
                    <span class="iconfont icon-jiantou iconColor fontSize8"></span>
                </a>
                <div class="noticeContent">
                    <ul>
                        <li class="liStyle liBorderBottom">
                            <a href="#" class="management_seven newPage topPage aStyle" onclick="showRoleInfo()">
                                <span class="paddingIco iconfont icon-wode"></span>
                                个人信息维护
                            </a>
                        </li>
                        <li class="liStyle liBorderBottom" onclick="changePassword()">
                            <a href="#" class="management_passwordChange newPage topPage aStyle">
                                <span class="paddingIco iconfont icon-xiugaimima01"></span>
                                修改密码
                            </a>
                        </li>
                        <li class="liStyle">
                            <a href="#" class="management_bounced bounced aStyle" data-toggle="modal"
                               data-target="#logOut">
                                <span class="paddingIco iconfont icon-tuichudenglu"></span>
                                退出登录
                            </a>
                        </li>
                    </ul>
                </div>
            </li>
            <!--个人信息结束-->
        </ul>
    </nav>
    <!--顶部导航结束-->

    <!--侧导航栏开始-->
    <nav class="navbar-default navbar-side">
        <div class="sidebar-collapse">
            <ul class="nav list-unstyled" id="sideBar">
                <li onclick="indexQuery()">
                    <a href="#" class="active-menu" id="management_one">
                        <span class="iconfont icon-shouye iconColor fontSize14 naviconpadding"></span>首页
                    </a>
                </li>
                <!--<li><a href="#" id="management_two">-->
                <li onclick="selectedTopic()"><a href="#" id="management_two">
                    <span class="iconfont icon-xuanti-mingcheng iconColorWhite fontSize14 naviconpadding"></span>学生选题
                </a>
                </li>
                <li onclick="queryOpeningReport()"><a href="#" id="management_three">
                    <span class="iconfont icon-wendang iconColorWhite fontSize14 naviconpadding"></span>过程文档管理
                </a>
                </li>
                <li onclick="queryDefense()"><a href="#" id="management_four">
                    <span class="iconfont icon-dabian iconColorWhite fontSize14 naviconpadding"></span>答辩管理
                </a>
                </li>
                <li><a href="#" id="management_userNotification">
                    <span class="iconfont icon-yonghutongzhi iconColorWhite fontSize14 naviconpadding"></span>用户发送消息
                </a>
                </li>
                <li><a href="#" id="management_good">
                    <span class="iconfont icon-icon-test iconColorWhite fontSize14 naviconpadding"></span>历届优秀浏览
                </a>
                </li>
                <li><a href="#" id="management_news">
                    <span class="iconfont icon-xinwenguanli iconColorWhite fontSize14 naviconpadding"></span>新闻浏览
                </a>
                </li>
            </ul>
        </div>

    </nav>
    <!--侧导航栏结束-->

    <!--个人信息开始-->
    <div id="seven" class="page-wrapper displayNone">
        <div class="header">
            <h3 class="page-header">
                个人信息维护
            </h3>
            <ol class="breadcrumb index">
                <li><a href="#">首页</a></li>
                <li class="active">个人信息维护</li>
            </ol>
        </div>
        <div class="page-inner">
            <!--个信息开始-->
            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            个人信息维护
                        </div>
                        <div class="panel-body">
                            <div class="row">
                                <div class="col-md-3"></div>
                                <div class="col-md-6">
                                    <div class="panel-body" id="informationDetailed">

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <script id="informationsDetailed" type="text/template">
                <div class="row">
                    <div class="col-md-12" style="padding-bottom: 10px">
                        <div class="col-md-2"></div>
                        <div style="height: 41px;line-height: 41px"
                             class="col-md-2 paddingRightt0">
                            姓名：
                        </div>
                        <div class="col-md-6 paddingLeft0 paddingRightt0">
                            <input placeholder="<%= informations.name %>" class="form-control whiteBgColor"
                                   type="text" readonly>
                        </div>
                    </div>
                    <div class="col-md-12" style="padding-bottom: 10px">
                        <div class="col-md-2"></div>
                        <div style="height: 41px;line-height: 41px"
                             class="col-md-2 paddingRightt0">
                            学号：
                        </div>
                        <div class="col-md-6 paddingLeft0 paddingRightt0">
                            <input placeholder="<%= informations.identifier %>" class="form-control whiteBgColor"
                                   type="text" readonly>
                        </div>
                    </div>
                    <div class="col-md-12" style="padding-bottom: 10px">
                        <div class="col-md-2"></div>
                        <div style="height: 41px;line-height: 41px"
                             class="col-md-2 paddingRightt0">
                            学院：
                        </div>
                        <div class="col-md-6 paddingLeft0 paddingRightt0">
                            <input placeholder="<%= informations.college %>" class="form-control whiteBgColor"
                                   type="text" readonly>
                        </div>
                    </div>
                    <div class="col-md-12" style="padding-bottom: 10px">
                        <div class="col-md-2"></div>
                        <div style="height: 41px;line-height: 41px"
                             class="col-md-2 paddingRightt0">
                            系：
                        </div>
                        <div class="col-md-6 paddingLeft0 paddingRightt0">
                            <input placeholder="<%= informations.department %>" class="form-control whiteBgColor"
                                   type="text" readonly>
                        </div>
                    </div>
                    <div class="col-md-12" style="padding-bottom: 10px">
                        <div class="col-md-2"></div>
                        <div style="height: 41px;line-height: 41px"
                             class="col-md-2 paddingRightt0">
                            专业：
                        </div>
                        <div class="col-md-6 paddingLeft0 paddingRightt0">
                            <input placeholder="<%= informations.major %>" class="form-control whiteBgColor"
                                   type="text" readonly>
                        </div>
                    </div>
                    <div class="col-md-12" style="padding-bottom: 10px">
                        <div class="col-md-2"></div>
                        <div style="height: 41px;line-height: 41px"
                             class="col-md-2 paddingRightt0">
                            班级：
                        </div>
                        <div class="col-md-6 paddingLeft0 paddingRightt0">
                            <input placeholder="<%= informations.grade %> 级 - <%= informations.classNo %> 班"
                                   class="form-control whiteBgColor"
                                   type="text" readonly>
                        </div>
                    </div>
                    <div class="col-md-12" style="padding-bottom: 10px">
                        <div class="col-md-2"></div>
                        <div style="height: 41px;line-height: 41px"
                             class="col-md-2 paddingRightt0">
                            性别：
                        </div>
                        <div class="col-md-6 paddingLeft0 paddingRightt0">
                            <input placeholder="<%= informations.sex %>" class="form-control whiteBgColor"
                                   type="text" readonly>
                        </div>
                    </div>
                    <div class="col-md-12" style="padding-bottom: 10px">
                        <div class="col-md-2"></div>
                        <div style="height: 41px;line-height: 41px"
                             class="col-md-2 paddingRightt0">
                            邮箱：
                        </div>
                        <div class="col-md-6 paddingLeft0 paddingRightt0">
                            <input id="email" class="form-control" type="email" placeholder="<%= informations.email %>">
                        </div>
                    </div>
                    <div class="col-md-12" style="padding-bottom: 10px">
                        <div class="col-md-2"></div>
                        <div style="height: 41px;line-height: 41px"
                             class="col-md-2 padding0">
                            绑定手机：
                        </div>
                        <div class="col-md-6 paddingLeft0 paddingRightt0">
                            <input id="bindTel" class="form-control" type="tel"
                                   placeholder="<%= informations.bindTel %>">
                        </div>
                        <div class="col-md-2 paddingRightt0" style="font-size: 12px;color: #f00;">
                            用于登录或找回密码
                        </div>
                    </div>
                    <div class="col-md-12" style="padding-bottom: 10px">
                        <div class="col-md-2"></div>
                        <div style="height: 41px;line-height: 41px"
                             class="col-md-2 padding0">
                            联系方式：
                        </div>
                        <div class="col-md-6 paddingLeft0 paddingRightt0">
                            <input id="contactTel" class="form-control" type="text"
                                   placeholder="<%= informations.contactTel %>">
                        </div>
                    </div>
                    <div class="col-md-12" style="padding-bottom: 10px">
                        <div class="col-md-4"></div>
                        <div class="col-md-6 paddingLeft0 paddingRightt0">
                            <button style="margin: 0 5px" type="button"
                                    class="btn btn-info" onclick="modifyInformation()">
                                确认修改
                            </button>
                        </div>
                    </div>
                </div>
            </script>
            <!--个人信息结束-->
        </div>
    </div>
    <!--个人信息结束-->

    <!--首页开始-->
    <div id="one" class="page-wrapper">
        <div class="header">
            <h3 class="page-header">
                首页
                <small>欢迎 XXX</small>
            </h3>
            <ol class="breadcrumb index">
                <li><a href="#">首页</a></li>
                <li class="active">数据</li>
            </ol>
        </div>
        <div class="page-inner">

            <!--进度提示开始-->
            <div class="row">
                <div class="col-xs-12 col-md-12">
                    <div>
                        <div class="titleContent">
                            <span>进度提示</span>
                            <span style="float: right">
                            <a href="#" class="management_five newPage">
                                查看更多进度
                                <sapn class="iconfont icon-jiantou1"></sapn>
                            </a>
                        </span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row" id="progressCircle">

            </div>
            <script id="progressesCircle" type="text/template">
                <% for(let i=0;i<4;i++){ %>
                <div class="col-xs-6 col-md-3">
                    <div class="whiteBgColor">
                        <div style="text-align: center">
                            <h4><%= taskProgress[i].progressName %></h4>
                            <div class="<%= taskProgress[i].className %>"
                                 data-percent="<%= taskProgress[i].progress %>"><span
                                    class="percent"><%= taskProgress[i].progress %>%</span>
                            </div>
                        </div>
                    </div>
                </div>
                <% } %>
            </script>
            <!--进度提示结束-->

            <!--我的课题开始-->
            <div class="row marginTop10">
                <div class="col-xs-24 col-md-12">
                    <div>
                        <div class="titleContent">
                            <span>我的课题</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-xs-24 col-md-12 marginTop10" id="indexSelectedTopic">

                </div>
            </div>
            <script id="indexSelectedTopics" type="text/template">
                <div class="whiteBgColor">
                    <% if(titles == "") { %>
                    <div class="titleContent">
                        <span class="fontColor847a7a">课题题目：</span>
                        <span class="newline">
                                暂无选题信息
                            </span>
                    </div>
                    <div class="dividerDiv"></div>
                    <div class="titleContent">
                        <span class="fontColor847a7a">审核状态：</span>
                        <span class="color07c160">
                                    暂无审核状态
                                </span>
                    </div>
                    <div class="dividerDiv"></div>
                    <div class="titleContent">
                        <span class="fontColor847a7a">任务书：</span>
                        <span class="colorf44 commitments">暂无任务书</span>
                    </div>
                </div>
                <% } else {%>
                <div class="titleContent">
                    <span class="fontColor847a7a">课题题目：</span>
                    <span class="newline">
                                <%= titles.project.title %>
                            </span>

                    <a style="float: right" href="#" data-toggle="modal" data-target="#viewTopic"
                       onclick="titleDetails('<%= titles.project.id %>')">查看详情</a>
                </div>
                <div class="dividerDiv"></div>
                <div class="titleContent">
                    <span class="fontColor847a7a">审核状态：</span>
                    <span class="color07c160">
                                    <% if(titles.cStatus==0){ %>
                                    审核不通过，请重新选择课题
                                    <% } else if(titles.cStatus==1){ %>
                                    审核通过，指导教师确认通过学生选题
                                    <% } else{ %>
                                    审核中，请耐心等待教师审核
                                    <% } %>
                                </span>
                </div>
                <div class="dividerDiv"></div>
                <div class="titleContent">
                    <span class="fontColor847a7a">任务书：</span>
                    <% if(typeof(titles.project.taskBook) == "undefined" || titles.project.taskBook.fileId==0) { %>
                    <span>
                    暂无任务书
                </span>
                    <% } else { %>
                    <span>
                    <%=titles.project.taskBook.file.fileName %>
                </span>
                    <a style="padding-left: 20px"
                       href="http://www.yuanbw.cn:20086/gpms/rol/downloadFile?fileId=<%=titles.project.taskBook.fileId %>">点击下载</a>
                    <% } %>
                </div>
                </div>
                <% } %>

            </script>
            <!--我的课题结束-->
        </div>
    </div>
    <!--首页结束-->

    <!--学生选题开始-->
    <div id="two" class="page-wrapper displayNone">
        <div style="margin: 0px" class="page-inner">
            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-default">
                        <div style="background-color: #f5f5f5">
                            <ul class="nav nav-tabs" role="tablist">
                                <li class="active"><a href="#topic_Selection" role="tab"
                                                      data-toggle="tab">选题</a></li>
                                <li onclick="topicSelected()"><a href="#topic_Selected" role="tab" data-toggle="tab">已选课题</a>
                                </li>
                            </ul>
                        </div>
                        <div class="tab-content">
                            <!--选题开始-->
                            <div class="tab-pane active panel-body" id="topic_Selection">
                                <div class="alert alert-info textEllipsis">
                                    <div>1.根据您所在学校或院系的设置，您最多可选 3 个课题等待导师确认，最终可确定1个双选课题</div>
                                    <div>2.根据您所在学校或院系的设置，每个课题最多可供 3 名学生选择，并等待导师确认，最终每个课题可确定1人双选</div>
                                </div>
                                <div style="padding-bottom: 15px;padding-left: 0px" class="col-md-12">
                                    <div style="padding-left: 0px" class="col-md-12">
                                        <div style="margin-bottom: 10px" class="col-md-4 col-xs-4">
                                            <div class="col-md-3 col-xs-3" style="padding: 0px">
                                                课题题目：
                                            </div>
                                            <div class="col-md-9 col-xs-9" style="padding: 0px">
                                                <input type="text" class="form-control" id="topicTitle"/>
                                            </div>
                                        </div>
                                        <div class="col-md-1 col-xs-1"></div>
                                        <div style="margin-bottom: 10px" class="col-md-4 col-xs-4">
                                            <div class="col-md-3 col-xs-3" style="padding: 0px">
                                                指导教师：
                                            </div>
                                            <div class="col-md-9 col-xs-9" style="padding: 0px">
                                                <input type="text" class="form-control" id="tutor"/>
                                            </div>
                                        </div>
                                        <div class="col-md-1 col-xs-1"></div>
                                        <div style="margin-bottom: 10px" class="col-md-4 col-xs-4">
                                            <div class="col-md-3 col-xs-3" style="padding: 0px">
                                                教师编号：
                                            </div>
                                            <div class="col-md-9 col-xs-9" style="padding: 0px">
                                                <input type="text" class="form-control" id="teacherNumber"/>
                                            </div>
                                        </div>
                                        <div class="col-md-1 col-xs-1"></div>
                                        <div style="margin-bottom: 10px" class="col-md-4 col-xs-4">
                                            <div class="col-md-3 col-xs-3" style="padding: 0px">
                                                题目类型：
                                            </div>
                                            <div class="col-md-9 col-xs-9" style="padding: 0px">
                                                <select style="margin:0px 5px" class="form-control" id="titleType">
                                                    <option value="">全部</option>
                                                    <option value="艺美设计">艺美设计</option>
                                                    <option value="工程工业设计">工程工业设计</option>
                                                    <option value="应用研究">应用研究</option>
                                                    <option value="理论研究">理论研究</option>
                                                    <option value="其他">其他</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-1 col-xs-1"></div>
                                        <div style="margin-bottom: 10px" class="col-md-4 col-xs-4">
                                            <div class="col-md-3 col-xs-3" style="padding: 0px">
                                                题目来源：
                                            </div>
                                            <div class="col-md-9 col-xs-9" style="padding: 0px">
                                                <select style="margin:0px 5px" class="form-control" id="titleSource">
                                                    <option value="">全部</option>
                                                    <option value="生产实际（社会实践）题">生产实际（社会实践）题</option>
                                                    <option value="教师科研课题">教师科研课题</option>
                                                    <option value="其他">其他</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-2 col-xs-2"></div>
                                        <div class="col-md-2 col-xs-2" style="padding-left: 5px">
                                            <button type="button" class="btn btn-info" onclick="queryTopic()">查询
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="alert alert-success textEllipsis border_radius marginBottom0">
                                    <div class="col-md-2 textAlign">
                                        课题题目
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        题目类型
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        题目来源
                                    </div>
                                    <div class="col-md-3 textAlign">
                                        指导老师
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        可选人数
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        操作
                                    </div>
                                </div>
                                <div id="topic">

                                </div>
                                <!--分页开始-->
                                <div style="margin-top: 15px" class="m-style" id="titlePage"></div>
                                <!--分页结束-->
                            </div>
                            <!--选题结束-->
                            <!--已选课题开始-->
                            <div class="tab-pane panel-body" id="topic_Selected">
                                <div style="padding-left:0px;padding-bottom: 15px" class="col-md-12">
                                    <div style="padding-left: 0px" class="col-md-4">
                                        <div class="col-md-10 col-xs-10" style="padding: 0px">
                                            <h4 class="font_bold">已选课题列表</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="alert alert-success textEllipsis border_radius marginBottom0">
                                    <div class="col-md-3 textAlign">
                                        课题题目
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        题目类型
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        题目来源
                                    </div>
                                    <div class="col-md-3 textAlign">
                                        指导教师（编号）
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        确认状态
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        操作
                                    </div>
                                </div>
                                <div id="selectedTopic"></div>
                            </div>
                            <!--已选课题结束-->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--选题-->
    <script id="topics" type="text/template">
        <% if(arrays=="") { %>
        <div class="alert alert-warning textEllipsis border_radius marginBottom0 textAlign">
            暂无数据
        </div>
        <%} else { arrays.forEach(function(array){ %>
        <div class="alert alert-warning textEllipsis border_radius marginBottom0">
            <div title="<%= array.project.title %>"
                 class="col-md-2 textEllipsis textAlign">
                <%= array.project.title %>
            </div>
            <div title="<%= array.project.genre %>"
                 class="col-md-2 textEllipsis textAlign">
                <%= array.project.genre %>
            </div>
            <div title="<%= array.project.source %>"
                 class="col-md-2 textEllipsis textAlign">
                <%= array.project.source %>
            </div>
            <div title="<%= array.setRole.name %>（<%= array.setRole.id %>）"
                 class="col-md-3 textAlign textEllipsis">
                <%if(array.setRole.authority==4) {%>
                <%= array.setRole.name %>（<%= array.setRole.id %>）
                <%}else{%>
                <span class="clickColor cursorPointer" data-toggle="modal"
                      data-target="#teacherDetails"
                      onclick="teacherDetails('<%= array.teacher.identifier %>')">
                                            <%= array.setRole.name %>（<%= array.setRole.id %>）
                                        </span>
                <%}%>
            </div>
            <div class="col-md-1 textAlign textEllipsis">
                <%= array.project.rest %>人
            </div>
            <div class="col-md-2 textEllipsis textAlign">
                <button type="button" class="btn btn-info btn-xs" data-toggle="modal"
                        data-target="#viewTopic"
                        onclick="titleClick('<%= array.project.id %>')">查看
                </button>
                <button type="button" class="btn btn-danger btn-xs" data-toggle="modal"
                        data-target="#chooseTopic" onclick="titleSelect('<%= array.project.id %>')">选题
                </button>
            </div>
        </div>
        <% }) }%>
    </script>
    <!--已选课题-->
    <script id="selectedTopics" type="text/template">
        <% if(titles != "") {
        titles.forEach(function(array){ %>
        <div class="alert alert-danger textEllipsis border_radius marginBottom0">
            <div title="<%= array.project.title %>" class="col-md-3 textEllipsis textAlign">
                <%= array.project.title %>
            </div>
            <div title="<%= array.project.genre %>" class="col-md-1 textEllipsis textAlign padding0">
                <%= array.project.genre %>
            </div>
            <div title="<%= array.project.source %>" class="col-md-2 textEllipsis textAlign">
                <%= array.project.source %>
            </div>
            <div class="col-md-3 textAlign textEllipsis">
                <%if(array.setRoleInfo.authority==4) {%>
                <%= array.setRoleInfo.name %>（<%= array.setRoleInfo.id %>）
                <%}else {%>
                <span class="clickColor cursorPointer" data-toggle="modal"
                      data-target="#teacherDetails"
                      onclick="teacherInformation('<%= array.setRole.identifier %>')">
                                            <%= array.setRole.name %>（<%= array.setRole.identifier %>）
                                        </span>
                <%}%>
            </div>
            <div class="col-md-1 textEllipsis textAlign padding0">
                <% if(array.cStatus==0) { %>
                审核不通过
                <% }
                else if(array.cStatus==1) { %>
                审核通过
                <% } else { %>
                审核中
                <% } %>
            </div>
            <div class="col-md-2 textEllipsis textAlign">
                <button type="button" class="btn btn-info btn-xs" data-toggle="modal"
                        data-target="#viewTopic"
                        onclick="titleDetails('<%= array.project.id %>')">查看
                </button>
                <% if(array.cStatus>=2) { %>
                <button type="button" class="btn btn-danger btn-xs" data-toggle="modal"
                        data-target="#cancelTopic" onclick="titleCancel('<%= array.project.id %>')">取消选题
                </button>
                <% }
                else{ %>
                <button disabled type="button" class="btn btn-danger btn-xs" data-toggle="modal"
                        data-target="#cancelTopic" onclick="titleCancel('<%= array.project.id %>')">取消选题
                </button>
                <% } %>
            </div>
        </div>
        <% })
        }else{ %>
        <div class="alert alert-danger textAlign border_radius marginBottom0">
            暂无数据
        </div>
        <%}%>
    </script>
    <!--查看选题详情开始-->
    <div class="modal fade" id="viewTopic" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">课题详细信息</h4>
                </div>
                <div class="modal-body" id="topicDetails">

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm btn-info" data-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </div>
    <script id="topicsDetails" type="text/template">
        <div class="alert alert-success">
            <strong>
                <span>课题题目:</span>
            </strong>
            <span><%= title.title %></span>
            <hr>
            <strong>
                <span>选题范围:</span>
            </strong>
            <span><%= title.range %></span>
            <hr>
            <strong>
                <span>题目类型:</span>
            </strong>
            <span><%= title.genre %></span>
            <hr>
            <strong>
                <span>题目来源:</span>
            </strong>
            <span><%= title.source %></span>
            <hr>
            <strong>
                <span>可选专业:</span>
            </strong>
            <span><%= title.major %></span>
            <hr>
            <strong>
                <span>可选人数:</span>
            </strong>
            <span><%= title.rest %>人</span>
            <hr>
            <strong>
                <span>
                    <% if(setDate=="true") { %>
                    选题时间：
                    <% }
                    else { %>
                    出题时间：
                    <% } %>
                </span>
            </strong>
            <span><%
                                var unixTimestamp = new Date( dates ) ;
                                commonTime = unixTimestamp.toLocaleString();
                                %>
                            <%= commonTime %></span>
            <hr>
            <strong>
                附件:
            </strong>
            <% let fileNames;
            if(title.fileId==0 || typeof(title.file) == "undefined") { %>
            <span>
                    暂无附件
                </span>
            <%
            } else { %>
            <span>
                    <%=title.file.fileName %>
                </span>
            <a style="padding-left: 20px"
               href="http://www.yuanbw.cn:20086/gpms/rol/downloadFile?fileId=<%=title.fileId %>">点击下载</a>
            <% } %>
            <hr>
            <strong>
                任务书:
            </strong>
            <% if(typeof(title.taskBook) == "undefined" || title.taskBook.fileId==0) { %>
            <span>
                    暂无任务书
                </span>
            <% } else { %>
            <span>
                    <%=title.taskBook.file.fileName %>
                </span>
            <a style="padding-left: 20px"
               href="http://www.yuanbw.cn:20086/gpms/rol/downloadFile?fileId=<%=title.taskBook.fileId %>">点击下载</a>
            <% } %>
            <hr>
            <strong>
                <span>题目简介:</span>
            </strong>
            <span><%= title.briefIntro %></span>
        </div>
    </script>
    <!--查看选题详情结束-->
    <!--查看教师详细信息开始-->
    <div class="modal fade" id="teacherDetails" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"
                            aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">指导教师详细信息</h4>
                </div>
                <div class="modal-body" id="teacherDetail">

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm btn-info" data-dismiss="modal">关闭
                    </button>
                </div>
            </div>
        </div>
    </div>
    <script id="teachersDetail" type="text/template">
        <div class="alert alert-success">
            <strong>
                <span>指导教师:</span>
            </strong>
            <span><%= teacher.name %>（<%= teacher.identifier %>）</span>
            <hr>
            <strong>
                <span>教师职称:</span>
            </strong>
            <span><%= teacher.title %></span>
            <hr>
            <strong>
                <span>导师联系邮箱:</span>
            </strong>
            <span>
                <%if(teacher.email=="") {%>
                暂无填写联系邮箱
                <%}else{%>
                <%= teacher.email %>
                <%}%>
            </span>
            <hr>
            <strong>
                <span>导师联系电话:</span>
            </strong>
            <span>
                <%if(teacher.email=="") {%>
                暂无填写联系电话
                <%}else{%>
                <%= teacher.contactTel %>
                <%}%></span>
            <hr>
            <strong>
                <span>学院:</span>
            </strong>
            <span><%= teacher.college %></span>
        </div>
    </script>
    <!--查看教师详细信息结束-->
    <!--确认选题开始-->
    <div class="modal fade" id="chooseTopic" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"
                            aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="gridSystemModalLabel">提示</h4>
                </div>
                <div class="modal-body">
                    <div class="container-fluid">
                        确定要选择该题目！
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-xs btn-white" data-dismiss="modal" id="saveTopicMiss">取 消
                    </button>
                    <button type="button" class="btn btn-xs btn-danger" id="saveTopic">保 存</button>
                </div>
            </div>
        </div>
    </div>
    <!--确认选题结束-->
    <!--取消选题开始-->
    <div class="modal fade" id="cancelTopic" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"
                            aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">提示</h4>
                </div>
                <div class="modal-body">
                    <div class="container-fluid">
                        确定要取消选择该题目！
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-xs btn-white" data-dismiss="modal" id="cancelTopicMiss">取 消
                    </button>
                    <button type="button" class="btn btn-xs btn-danger" id="cancelTopics">保 存</button>
                </div>
            </div>
        </div>
    </div>
    <!--取消选题结束-->
    <!--学生选题结束-->

    <!--过程文档管理开始-->
    <div id="three" class="page-wrapper displayNone">
        <div style="margin: 0px" class="page-inner">
            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-default">
                        <div style="background-color: #f5f5f5">
                            <ul class="nav nav-tabs" role="tablist">
                                <li class="active"><a href="#openingReport" role="tab"
                                                      data-toggle="tab">提交开题报告</a></li>
                                <li onclick="submiInterimInspection()"><a href="#intermediateInspection" role="tab"
                                                                          data-toggle="tab">提交中期检查</a>
                                </li>
                                <li onclick="submitGuideRecord()"><a href="#guideRecord" role="tab" data-toggle="tab">提交指导记录</a>
                                </li>
                                <li onclick="submitForeignOriginal()"><a href="#foreignTranslation" role="tab"
                                                                         data-toggle="tab">提交外文译文和原文</a>
                                </li>
                                <li onclick="submitLiteratureReview()"><a href="#literatureReview" role="tab"
                                                                          data-toggle="tab">提交文献综述</a></li>
                                <li onclick="submitGraduationDesign()"><a href="#graduationDesign" role="tab"
                                                                          data-toggle="tab">提交毕业设计（论文）</a>
                                </li>
                            </ul>
                        </div>
                        <div class="tab-content">
                            <!--提交开题报告开始-->
                            <div class="tab-pane active panel-body" id="openingReport">
                                <div id="writeOpeningReport"
                                     class="col-md-12 displayNone openingReport">
                                </div>
                                <script id="writeOpeningReports" type="text/template">
                                    <form id="fileUpload">
                                        <h5 class="font_bold">课题研究的目的和意义</h5>
                                        <%
                                        let aim="",content="",tech="",plan="";
                                        if(data != ""){
                                        aim = data.aim;
                                        content = data.content;
                                        tech = data.tech;
                                        plan = data.plan
                                        }
                                        %>
                                        <textarea class="form-control OpeningInput" rows="10" name="aim"
                                                  style="background-color: #fff"><%=aim %></textarea>
                                        <h5 class="font_bold">课题研究方案和主要内容</h5>
                                        <textarea class="form-control OpeningInput" rows="10" name="content"
                                                  style="background-color: #fff"><%=content %></textarea>
                                        <h5 class="font_bold">研究方法及技术途径</h5>
                                        <textarea class="form-control OpeningInput" rows="10" name="tech"
                                                  style="background-color: #fff"><%=tech %></textarea>
                                        <h5 class="font_bold">实施计划</h5>
                                        <textarea class="form-control OpeningInput" rows="10" name="plan"
                                                  style="background-color: #fff"><%=plan %></textarea>
                                        <h5 class="font_bold">添加附件</h5>
                                        <input id="fileChoose" type="file" style="display: none" name="uploadfile">
                                        <div class="row">
                                            <div class="col-md-5 paddingRightt0">
                                                <% let fileNames;
                                                if(data.fileId==0 || data=="" || typeof(data.file) == "undefined") {
                                                fileNames = "";
                                                } else {
                                                fileNames = data.file.fileName } %>
                                                <input id="fileName" class="form-control OpeningInput" type="text"
                                                       value="<%=fileNames %>">
                                            </div>
                                            <div class="col-md-5 paddingLeft0">
                                                <button type="button"
                                                        class="btn btn-info border_bottom_left_radius border_top_left_radius"
                                                        onclick="fileClick('fileChoose','fileName')">
                                                    浏览
                                                </button>
                                            </div>
                                        </div>
                                        <div class="row" style="margin-top: 10px">
                                            <div class="col-md-2">
                                                <% let fileId;
                                                if(data!="") {
                                                fileId = data.fileId;}
                                                else {
                                                fileId = 0;
                                                }
                                                %>
                                                <button type="button" class="btn btn-info"
                                                        onclick="submitOpeningReport('<%=fileId%>')">
                                                    提交
                                                </button>
                                            </div>
                                            <div class="col-md-2">
                                                <button type="button" class="btn btn-success"
                                                        onclick="cancelOpeningReport()">
                                                    取消
                                                </button>
                                            </div>
                                        </div>
                                    </form>
                                </script>
                                <div id="modifyOpeningReport" class="col-md-12 openingReport">
                                </div>
                                <script id="modifyOpeningReports" type="text/template">
                                    <div class="alert alert-info textEllipsis">
                                        <div>
                                            <span style="color: #333333;">最新提交时间：
                                            <%
                                                var unixTimestamp = new Date( data.submitDate ) ;
                                                commonTime = unixTimestamp.toLocaleString();
                                            %>
                                            <%= commonTime %>
                                            </span>
                                            <span style="padding-left: 100px"><a href="#reviewDetails">查看审核详情</a></span>
                                        </div>
                                    </div>
                                    <div style="padding-left:0px;padding-bottom: 15px"
                                         class="col-md-12">
                                        <div style="padding-left: 0px" class="col-md-4">
                                            <h4 class="font_bold">开题报告详情</h4>
                                        </div>
                                    </div>
                                    <h5 class="font_bold">课题研究的目的和意义</h5>
                                    <div class="whiteColor">
                                        <div class="reportContent">
                                            <%=data.aim %>
                                        </div>
                                    </div>
                                    <h5 class="font_bold">课题研究方案和主要内容</h5>
                                    <div class="whiteColor">
                                        <div class="reportContent">
                                            <%=data.content %>
                                        </div>
                                    </div>
                                    <h5 class="font_bold">研究方法及技术途径</h5>
                                    <div class="whiteColor">
                                        <div class="reportContent">
                                            <%=data.tech %>
                                        </div>
                                    </div>
                                    <h5 class="font_bold">实施计划</h5>
                                    <div class="whiteColor">
                                        <div class="reportContent">
                                            <%=data.plan %>
                                        </div>
                                    </div>
                                    <h5 class="font_bold">批注内容</h5>
                                    <div class="whiteColor">
                                        <div class="reportContent">
                                            <%=data.annotation %>
                                        </div>
                                    </div>
                                    <h5 class="font_bold">附件</h5>
                                    <div class="whiteColor" style="padding:10px;">
                                        <% if(data.fileId == 0 || typeof(data.file)=="undefined") { %>
                                        暂未上传开题报告相关附件
                                        <% } else { %>
                                        附件：<%=data.file.fileName %> <a style="padding-left: 20px"
                                                                       href="http://www.yuanbw.cn:20086/gpms/rol/downloadFile?fileId=<%=data.fileId %>">点击下载</a>
                                        <% } %>
                                    </div>
                                    <div class="row" style="margin-top: 10px">
                                        <div class="col-md-2">
                                            <% if(data.cStatus==1) {%>
                                            <button style="margin-bottom: 10px" type="button"
                                                    class="btn btn-info" disabled>
                                                修改
                                            </button>
                                            <%} else{%>
                                            <button style="margin-bottom: 10px" type="button"
                                                    class="btn btn-info" onclick="modifyReport()">
                                                修改
                                            </button>
                                            <%}%>
                                        </div>
                                    </div>
                                    <div style="padding-left:0px;padding-bottom: 15px"
                                         class="col-md-12">
                                        <div style="padding-left: 0px" class="col-md-4">
                                            <h4 id="reviewDetails" class="font_bold">开题报告审核情况</h4>
                                        </div>
                                    </div>
                                    <div class="col-md-12 alert alert-danger">
                                        <div>
                                            <span class="notSubmit">审核状态：</span>
                                            <% let msg;
                                            if(data.cStatus==0) {
                                            msg = "审核不通过";
                                            }
                                            else if(data.cStatus==1) {
                                            msg = "审核通过";
                                            }
                                            else {
                                            msg = "审核中";
                                            }
                                            %>
                                            <%=msg%>
                                        </div>
                                        <div>
                                            <span class="notSubmit">审核建议：</span>
                                            <%= data.cSuggest%>
                                        </div>
                                    </div>
                                </script>
                            </div>
                            <!--提交开题报告结束-->
                            <!--提交中期报告开始-->
                            <div class="tab-pane panel-body" id="intermediateInspection">
                                <div id="writeIntermediateInspection"
                                     class="col-md-12 displayNone openingReport">

                                </div>
                                <script id="writeIntermediateInspections" type="text/template">
                                    <form id="IntermediateForm">
                                        <h5 class="font_bold">中期检查需要填写的内容</h5>
                                        <textarea class="form-control InspectionInput" rows="10" name="intro"
                                                  style="background-color: #fff"><% if(data!="") {%><%=data.intro %><% } %></textarea>
                                        <h5 class="font_bold">添加附件</h5>
                                        <input name="uploadfile" id="fileChooseIntermediate" type="file"
                                               style="display: none">
                                        <div class="row">
                                            <div class="col-md-5 paddingRightt0">
                                                <% let fileNames;
                                                if(data.fileId==0 || data=="" || typeof(data.file)=="undefined") {
                                                fileNames = "";
                                                } else {
                                                fileNames = data.file.fileName } %>
                                                <input id="fileNameIntermediate" class="form-control InspectionInput"
                                                       type="text"
                                                       value="<%=fileNames %>">
                                            </div>
                                            <div class="col-md-5 paddingLeft0">
                                                <button type="button"
                                                        class="btn btn-info border_bottom_left_radius border_top_left_radius"
                                                        onclick="fileClick('fileChooseIntermediate','fileNameIntermediate')">
                                                    浏览
                                                </button>
                                            </div>
                                        </div>
                                        <div class="row" style="margin-top: 10px">
                                            <div class="col-md-2">
                                                <% let fileId;
                                                if(data!="") {
                                                fileId = data.fileId;}
                                                else {
                                                fileId = 0;
                                                }
                                                %>
                                                <button type="button" class="btn btn-info"
                                                        onclick="submitIntermediate('<%=fileId%>')">
                                                    提交
                                                </button>
                                            </div>
                                            <div class="col-md-2">
                                                <button type="button" class="btn btn-success"
                                                        onclick="cancelIntermediate()">
                                                    取消
                                                </button>
                                            </div>
                                        </div>
                                    </form>
                                </script>

                                <div id="modifyIntermediateInspection"
                                     class="col-md-12 openingReport">
                                </div>
                                <script id="modifyIntermediateInspections" type="text/template">
                                    <div class="alert alert-info textEllipsis">
                                        <div>
                                            <span style="color: #333333;">最新提交时间：
                                            <%
                                                var unixTimestamp = new Date( data.submitDate ) ;
                                                commonTime = unixTimestamp.toLocaleString();
                                            %>
                                            <%= commonTime %>
                                            </span>
                                            <span style="padding-left: 100px"><a
                                                    href="#intermediateInspectionDetails">查看审核详情</a></span>
                                        </div>
                                    </div>
                                    <div style="padding-left:0px;padding-bottom: 15px"
                                         class="col-md-12">
                                        <div style="padding-left: 0px" class="col-md-4">
                                            <h4 class="font_bold">中期报告详情</h4>
                                        </div>
                                    </div>
                                    <h5 class="font_bold">中期检查内容</h5>
                                    <div class="whiteColor">
                                        <div class="reportContent">
                                            <!--提交内容-->
                                            <%= data.intro %>
                                        </div>
                                    </div>
                                    <h5 class="font_bold">批注内容</h5>
                                    <div class="whiteColor">
                                        <div class="reportContent">
                                            <%= data.annotation %>
                                        </div>
                                    </div>
                                    <h5 class="font_bold">附件</h5>
                                    <div class="whiteColor" style="padding:10px;">
                                        <% if(data.fileId == 0 || typeof(data.file)=="undefined") { %>
                                        暂未上传中期检查相关附件
                                        <% } else { %>
                                        附件：<%=data.file.fileName %> <a style="padding-left: 20px"
                                                                       href="http://www.yuanbw.cn:20086/gpms/rol/downloadFile?fileId=<%=data.fileId %>">点击下载</a>
                                        <% } %>
                                    </div>
                                    <div class="row" style="margin-top: 10px">
                                        <div class="col-md-2">
                                            <% if(data.cStatus==1) {%>
                                            <button style="margin-bottom: 10px" type="button"
                                                    class="btn btn-info" disabled>
                                                修改
                                            </button>
                                            <%} else{%>
                                            <button style="margin-bottom: 10px" type="button"
                                                    class="btn btn-info" onclick="modifyIntermediate()">
                                                修改
                                            </button>
                                            <%}%>
                                        </div>
                                    </div>
                                    <div style="padding-left:0px;padding-bottom: 15px"
                                         class="col-md-12">
                                        <div style="padding-left: 0px" class="col-md-4">
                                            <h4 id="intermediateInspectionDetails" class="font_bold">
                                                中期报告审核情况</h4>
                                        </div>
                                    </div>
                                    <div class="col-md-12 alert alert-danger">
                                        <div>
                                            <span class="notSubmit">审核状态：</span>
                                            <% let msg;
                                            if(data.cStatus==0) {
                                            msg = "审核不通过";
                                            }
                                            else if(data.cStatus==1) {
                                            msg = "审核通过";
                                            }
                                            else {
                                            msg = "审核中";
                                            }
                                            %>
                                            <%=msg%>
                                        </div>
                                        <div>
                                            <span class="notSubmit">审核建议：</span>
                                            <%= data.cSuggest%>
                                        </div>
                                    </div>
                                </script>
                            </div>
                            <!--提交中期报告结束-->
                            <!--提交指导记录开始-->
                            <div class="tab-pane panel-body" id="guideRecord">
                                <div style="padding-left:0px;padding-bottom: 15px"
                                     class="col-md-12">
                                    <!--<div style="padding-left: 0px" class="col-md-4">-->
                                    <div class="col-md-10 col-xs-10" style="padding: 0px">
                                        <h4 class="font_bold">学生指导记录列表（需提交10次指导记录）</h4>
                                    </div>
                                    <!--</div>-->
                                </div>
                                <button style="margin-bottom: 10px;" type="button"
                                        class="management_guide newPage btn btn-info"
                                        onclick="submitGuide('FirstGuide')">
                                    提交指导记录
                                </button>
                                <div id="InstructionRecordList"></div>
                            </div>
                            <script id="InstructionRecordLists" type="text/template">
                                <div class="alert alert-success textEllipsis border_radius marginBottom0">
                                    <div class="col-md-3 textAlign">
                                        课题题目
                                    </div>
                                    <div class="col-md-3 textAlign">
                                        提交时间
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        记录编号
                                    </div>
                                    <div class="col-md-3 textAlign">
                                        审核状态
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        操作
                                    </div>
                                </div>
                                <%
                                if(data!="") {
                                for(let i=0;i
                                <data.length;i++) {
                                %>
                                <div class="alert alert-danger textEllipsis border_radius marginBottom0">
                                    <div class="col-md-3 textEllipsis textAlign">
                                        <%=topicName%>
                                    </div>
                                    <div class="col-md-3 textEllipsis textAlign">
                                        <%
                                        var unixTimestamp = new Date( data[i].submitDate ) ;
                                        commonTime = unixTimestamp.toLocaleString();
                                        %>
                                        <%= commonTime %>
                                    </div>
                                    <div class="col-md-1 textEllipsis textAlign">
                                        <%=(i+1)%>
                                    </div>
                                    <div class="col-md-3 textAlign textEllipsis">
                                        <% let msg;
                                        if(data[i].cStatus==0) {
                                        msg = "审核不通过";
                                        }
                                        else if(data[i].cStatus==1) {
                                        msg = "审核通过";
                                        }
                                        else {
                                        msg = "审核中";
                                        }
                                        %>
                                        <%=msg%>
                                    </div>
                                    <div class="col-md-2 textEllipsis textAlign">
                                        <button style="margin-bottom: 10px" type="button"
                                                class="btn btn-info btn-xs" onclick="viewGuide('<%=data[i].id%>')">
                                            查看
                                        </button>
                                        <% if(data[i].cStatus==1) {%>
                                        <button style="margin-bottom: 10px" type="button"
                                                class="btn btn-info btn-xs" disabled>
                                            修改
                                        </button>
                                        <%} else{%>
                                        <button style="margin-bottom: 10px" type="button"
                                                class="btn btn-info btn-xs" onclick="submitGuide('<%=data[i].id%>')">
                                            修改
                                        </button>
                                        <%}%>
                                    </div>
                                </div>
                                <% } }else{ %>
                                <div class="alert alert-danger textAlign border_radius marginBottom0">
                                    暂无记录
                                </div>
                                <%}%>
                            </script>
                            <!--提交指导记录结束-->
                            <!--提交外文译文和原文开始-->
                            <div class="tab-pane panel-body" id="foreignTranslation">
                                <div id="writeForeignTranslation"
                                     class="col-md-12 displayNone openingReport">
                                </div>
                                <script id="writeForeignTranslations" type="text/template">
                                    <form id="ForeignForm">
                                        <%
                                        let original="",foreign="",oriFileId=0,forFileId=0,oriFile="",forFile="";
                                        if(data!="") {
                                        original = data.original;
                                        foreign = data.foreign;
                                        oriFileId = data.oriFileId;
                                        forFileId = data.forFileId;
                                        if(oriFileId!=0&& typeof(data.oriFile)!="undefined") {
                                        oriFile = data.oriFile.fileName;
                                        }
                                        if(forFileId!=0 && typeof(data.forFile)!="undefined") {
                                        forFile = data.forFile.fileName;
                                        }
                                        }
                                        %>
                                        <div style="width: 49%; display: inline-block">
                                            <h5 class="font_bold">外文译文内容</h5>
                                            <textarea name="foreign" class="form-control foreigntext" rows="10" name="textarea"
                                                      style="background-color: #fff"><%=foreign%></textarea>
                                            <h5 class="font_bold">添加附件</h5>
                                            <input name="uploadForfile" id="fileChooseForeign" type="file"
                                                   style="display: none">
                                            <div class="row">
                                                <div class="col-md-5 paddingRightt0">
                                                    <input id="fileNameForeign" class="form-control foreigntext"
                                                           type="text" value="<%=forFile %>">
                                                </div>
                                                <div class="col-md-5 paddingLeft0">
                                                    <button type="button"
                                                            class="btn btn-info border_bottom_left_radius border_top_left_radius"
                                                            onclick="fileClick('fileChooseForeign','fileNameForeign')">
                                                        浏览
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div style="width: 49%; float: right">
                                            <h5 class="font_bold">原文内容 </h5>
                                            <textarea name="original" class="form-control foreigntext" rows="10" name="textarea"
                                                      style="background-color: #fff"><%=original%></textarea>
                                            <h5 class="font_bold">添加附件</h5>
                                            <input name="uploadOrifile" id="fileChooseOriginal" type="file"
                                                   style="display: none">
                                            <div class="row">
                                                <div class="col-md-5 paddingRightt0">
                                                    <input id="fileNameOriginal" class="form-control foreigntext"
                                                           type="text" value="<%=oriFile%>">
                                                </div>
                                                <div class="col-md-5 paddingLeft0">
                                                    <button type="button"
                                                            class="btn btn-info border_bottom_left_radius border_top_left_radius"
                                                            onclick="fileClick('fileChooseOriginal','fileNameOriginal')">
                                                        浏览
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row" style="margin-top: 10px">
                                            <div class="col-md-2">
                                                <button type="button" class="btn btn-info"
                                                        onclick="submitForeign()">
                                                    提交
                                                </button>
                                            </div>
                                            <div class="col-md-2">
                                                <button type="button" class="btn btn-success"
                                                        onclick="cancelForeign()">
                                                    取消
                                                </button>
                                            </div>

                                        </div>
                                    </form>
                                </script>

                                <div id="modifyForeignTranslation" class="col-md-12 openingReport">

                                </div>
                                <script id="modifyForeignTranslations" type="text/template">
                                    <div class="alert alert-info textEllipsis">
                                        <div>
                                            <span style="color: #333333;">最新提交时间：
                                            <%
                                                var unixTimestamp = new Date( data.submitDate ) ;
                                                commonTime = unixTimestamp.toLocaleString();
                                            %>
                                            <%= commonTime %>
                                            </span>
                                            <span style="padding-left: 100px"><a
                                                    href="#foreignTranslationDetails">查看审核详情</a></span>
                                        </div>
                                    </div>
                                    <div style="padding-left:0px;padding-bottom: 15px"
                                         class="col-md-12">
                                        <div style="padding-left: 0px" class="col-md-4">
                                            <h4 class="font_bold">外文译文和原文详情</h4>
                                        </div>
                                    </div>
                                    <h5 class="font_bold">外文译文内容</h5>
                                    <div class="whiteColor">
                                        <div class="reportContent">
                                            <%=data.foreign%>
                                        </div>
                                    </div>
                                    <h5 class="font_bold">原文内容</h5>
                                    <div class="whiteColor">
                                        <div class="reportContent">
                                            <%=data.original%>
                                        </div>
                                    </div>
                                    <h5 class="font_bold">批注内容</h5>
                                    <div class="whiteColor">
                                        <div class="reportContent">
                                            <%=data.annotation%>
                                        </div>
                                    </div>
                                    <h5 class="font_bold">外文译文附件</h5>
                                    <div class="whiteColor" style="padding:10px;">
                                        <% if(data.forFileId == 0 || typeof(data.forFile)=="undefined") { %>
                                        暂未上传外文译文相关附件
                                        <% } else { %>
                                        附件：<%=data.forFile.fileName %> <a style="padding-left: 20px"
                                                                          href="http://www.yuanbw.cn:20086/gpms/rol/downloadFile?fileId=<%=data.fileId %>">点击下载</a>
                                        <% } %>
                                    </div>
                                    <h5 class="font_bold">原文附件</h5>
                                    <div class="whiteColor" style="padding:10px;">
                                        <% if(data.oriFileId == 0 || typeof(data.oriFile)=="undefined") { %>
                                        暂未上传外文译文相关附件
                                        <% } else { %>
                                        附件：<%=data.oriFile.fileName %> <a style="padding-left: 20px"
                                                                          href="http://www.yuanbw.cn:20086/gpms/rol/downloadFile?fileId=<%=data.fileId %>">点击下载</a>
                                        <% } %>
                                    </div>
                                    <div class="row" style="margin-top: 10px">
                                        <div class="col-md-2">
                                            <% if(data.cStatus==1) {%>
                                            <button style="margin-bottom: 10px" type="button"
                                                    class="btn btn-info" disabled>
                                                修改
                                            </button>
                                            <%} else{%>
                                            <button style="margin-bottom: 10px" type="button"
                                                    class="btn btn-info" onclick="modifyForeign()">
                                                修改
                                            </button>
                                            <%}%>
                                        </div>
                                    </div>
                                    <div style="padding-left:0px;padding-bottom: 15px"
                                         class="col-md-12">
                                        <div style="padding-left: 0px" class="col-md-4">
                                            <h4 id="foreignTranslationDetails" class="font_bold">
                                                外文译文和原文审核情况</h4>
                                        </div>
                                    </div>
                                    <div class="col-md-12 alert alert-danger">
                                        <div>
                                            <span class="notSubmit">审核状态：</span>
                                            <% let msg;
                                            if(data.cStatus==0) {
                                            msg = "审核不通过";
                                            }
                                            else if(data.cStatus==1) {
                                            msg = "审核通过";
                                            }
                                            else {
                                            msg = "审核中";
                                            }
                                            %>
                                            <%=msg%>
                                        </div>
                                        <div>
                                            <span class="notSubmit">审核建议：</span>
                                            <%= data.cSuggest%>
                                        </div>
                                    </div>
                                </script>

                            </div>
                            <!--提交外文译文和原文结束-->
                            <!--提交文献综述开始-->
                            <div class="tab-pane panel-body" id="literatureReview">
                                <div id="writeLiterature"
                                     class="col-md-12 displayNone openingReport">
                                </div>
                                <script id="writeLiteratures" type="text/template">
                                    <form id="LiteraturesForm">
                                        <%
                                        let intro="",fileId=0,fileName="";
                                        if(data!=""){
                                        intro = data.intro;
                                        fileId = data.fileId;
                                        if(fileId!=0&&typeof(data.file)!="undefined") {
                                        fileName=data.file.fileName;
                                        }
                                        }
                                        %>
                                        <h5 class="font_bold">文献综述需要填写的内容</h5>
                                        <textarea class="form-control Literaturetext" rows="10" name="intro"
                                                  style="background-color: #fff"><%=intro%></textarea>
                                        <h5 class="font_bold">添加附件</h5>
                                        <input name="uploadfile" id="fileChooseLiterature" type="file"
                                               style="display: none">
                                        <div class="row">
                                            <div class="col-md-5 paddingRightt0">
                                                <input value="<%=fileName%>" id="fileNameLiterature"
                                                       class="form-control Literaturetext"
                                                       type="text">
                                            </div>
                                            <div class="col-md-5 paddingLeft0">
                                                <button type="button"
                                                        class="btn btn-info border_bottom_left_radius border_top_left_radius"
                                                        onclick="fileClick('fileChooseLiterature','fileNameLiterature')">
                                                    浏览
                                                </button>
                                            </div>
                                        </div>
                                        <div class="row" style="margin-top: 10px">
                                            <div class="col-md-2">
                                                <button type="button" class="btn btn-info"
                                                        onclick="submitLiterature('<%=fileId%>')">
                                                    提交
                                                </button>
                                            </div>
                                            <div class="col-md-2">
                                                <button type="button" class="btn btn-success"
                                                        onclick="cancelLiterature()">
                                                    取消
                                                </button>
                                            </div>
                                        </div>
                                    </form>
                                </script>
                                <div id="modifyLiterature" class="col-md-12 openingReport">
                                </div>
                                <script id="modifyLiteratures" type="text/template">
                                    <div class="alert alert-info textEllipsis">
                                        <div>
                                            <span style="color: #333333;">最新提交时间：
                                            <%
                                                var unixTimestamp = new Date( data.submitDate ) ;
                                                commonTime = unixTimestamp.toLocaleString();
                                            %>
                                            <%= commonTime %>
                                            </span>
                                            <span style="padding-left: 100px"><a
                                                    href="#literatureReviewDetails">查看审核详情</a></span>
                                        </div>
                                    </div>
                                    <div style="padding-left:0px;padding-bottom: 15px"
                                         class="col-md-12">
                                        <div style="padding-left: 0px" class="col-md-4">
                                            <h4 class="font_bold">文献综述详情</h4>
                                        </div>
                                    </div>
                                    <h5 class="font_bold">文献综述内容</h5>
                                    <div class="whiteColor">
                                        <div class="reportContent">
                                            <%=data.intro%>
                                        </div>
                                    </div>
                                    <h5 class="font_bold">批注内容</h5>
                                    <div class="whiteColor">
                                        <div class="reportContent">
                                            <%=data.annotation%>
                                        </div>
                                    </div>
                                    <h5 class="font_bold">附件</h5>
                                    <div class="whiteColor" style="padding:10px;">
                                        <% if(data.fileId == 0 || typeof(data.file)=="undefined") { %>
                                        暂未上传文献综述相关附件
                                        <% } else { %>
                                        附件：<%=data.file.fileName %> <a style="padding-left: 20px"
                                                                       href="http://www.yuanbw.cn:20086/gpms/rol/downloadFile?fileId=<%=data.fileId %>">点击下载</a>
                                        <% } %>
                                    </div>
                                    <div class="row" style="margin-top: 10px">
                                        <div class="col-md-2">
                                            <% if(data.cStatus==1) {%>
                                            <button style="margin-bottom: 10px" type="button"
                                                    class="btn btn-info" disabled>
                                                修改
                                            </button>
                                            <%} else{%>
                                            <button style="margin-bottom: 10px" type="button"
                                                    class="btn btn-info" onclick="modifyLiterature()">
                                                修改
                                            </button>
                                            <%}%>
                                        </div>
                                    </div>
                                    <div style="padding-left:0px;padding-bottom: 15px"
                                         class="col-md-12">
                                        <div style="padding-left: 0px" class="col-md-4">
                                            <h4 id="literatureReviewDetails" class="font_bold">
                                                文献综述审核情况</h4>
                                        </div>
                                    </div>
                                    <div class="col-md-12 alert alert-danger">
                                        <div>
                                            <span class="notSubmit">审核状态：</span>
                                            <% let msg;
                                            if(data.cStatus==0) {
                                            msg = "审核不通过";
                                            }
                                            else if(data.cStatus==1) {
                                            msg = "审核通过";
                                            }
                                            else {
                                            msg = "审核中";
                                            }
                                            %>
                                            <%=msg%>
                                        </div>
                                        <div>
                                            <span class="notSubmit">审核建议：</span>
                                            <%= data.cSuggest%>
                                        </div>
                                    </div>
                                </script>
                            </div>
                            <!--提交文件综述结束-->
                            <!--提交毕业设计开始-->
                            <div class="tab-pane panel-body" id="graduationDesign">
                                <div style="padding-left:0px;padding-bottom: 15px"
                                     class="col-md-12">
                                    <div style="padding-left: 0px" class="col-md-4">
                                        <div class="col-md-10 col-xs-10" style="padding: 0px">
                                            <h4 class="font_bold">学生毕业设计（论文）列表</h4>
                                        </div>
                                    </div>
                                </div>
                                <button style="margin-bottom: 10px;" type="button"
                                        class="btn btn-info" onclick="Modify_Paper('FirstPaper')">
                                    提交毕业设计（论文）
                                </button>
                                <div id="submitPaper"></div>
                            </div>
                            <script id="submitPapers" type="text/template">
                                <div class="alert alert-success textEllipsis border_radius marginBottom0">
                                    <div class="col-md-3 textAlign">
                                        课题题目
                                    </div>
                                    <div class="col-md-3 textAlign">
                                        提交时间
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        记录编号
                                    </div>
                                    <div class="col-md-3 textAlign">
                                        审核状态
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        操作
                                    </div>
                                </div>
                                <% if(data!=""){
                                for(let i=0;i
                                <data.length;i++) {%>
                                <div class="alert alert-danger textEllipsis border_radius marginBottom0">
                                    <div title="<%=topicName%>"
                                         class="col-md-3 textEllipsis textAlign">
                                        <%=topicName%>
                                    </div>
                                    <div class="col-md-3 textEllipsis textAlign">
                                        <%
                                        var unixTimestamp = new Date( data[i].submitDate ) ;
                                        commonTime = unixTimestamp.toLocaleString();
                                        %>
                                        <%= commonTime %>
                                    </div>
                                    <div class="col-md-1 textEllipsis textAlign">
                                        <%=(i+1)%>
                                    </div>
                                    <div class="col-md-3 textAlign textEllipsis">
                                        <% let msg;
                                        if(data[i].cStatus==0) {
                                        msg = "审核不通过";
                                        }
                                        else if(data[i].cStatus==1) {
                                        msg = "审核通过";
                                        }
                                        else {
                                        msg = "审核中";
                                        }
                                        %>
                                        <%=msg%>
                                    </div>
                                    <div class="col-md-2 textEllipsis textAlign">
                                        <button style="margin-bottom: 10px" type="button"
                                                class="btn btn-info btn-xs" onclick="viewGraduation('<%=data[i].id%>')">
                                            查看
                                        </button>
                                        <% if(data[i].cStatus==2) {%>
                                        <button style="margin-bottom: 10px" type="button"
                                                class="btn btn-info btn-xs" onclick="Modify_Paper('<%=data[i].id%>')">
                                            修改
                                        </button>
                                        <%} else{%>
                                        <button style="margin-bottom: 10px" type="button"
                                                class="btn btn-info btn-xs" disabled>
                                            修改
                                        </button>
                                        <%}%>
                                    </div>
                                </div>
                                <% }} else {%>
                                <div class="alert alert-danger textAlign border_radius marginBottom0">
                                    暂无记录
                                </div>
                                <%}%>
                            </script>
                            <!--提交毕业设计结束-->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--更改指导记录开始-->
    <div id="guide" class="page-wrapper displayNone">
        <div style="margin: 0px" class="page-inner">
            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            提交指导记录
                        </div>
                        <div class="panel-body">
                            <div id="writeGuide"
                                 class="col-md-12 openingReport">

                            </div>
                        </div>
                        <script id="writeGuides" type="text/template">
                            <%
                            let theme="",date="",work="",fileName="",id=-1;
                            if(data!="") {
                            theme = data.theme;
                            date = data.date;
                            work = data.work;
                            id = data.fileId;
                            if(data.fileId != 0 && typeof(data.file)!="undefined") {
                            fileName = data.file.fileName;
                            }
                            }
                            %>
                            <form id="guideForm">
                                <h5 class="font_bold">主题</h5>
                                <input type="text" class="form-control guideInput" name="theme" value="<%=theme%>">
                                <h5 style="padding-top: 60px" class="font_bold">指导时间</h5>
                                <input type="text" class="form-control guideInput" name="date" value="<%=date%>">
                                <h5 style="padding-top: 60px" class="font_bold">主要工作</h5>
                                <textarea class="form-control guideInput" rows="5" name="work"> <%=work%></textarea>
                                <h5 class="font_bold">添加附件</h5>
                                <input id="fileChooseGuide" type="file" style="display: none" name="uploadfile">
                                <div class="row">
                                    <div class="col-md-5 paddingRightt0">
                                        <input id="fileNameGuide" class="form-control guideInput" type="text"
                                               value="<%=fileName%>">
                                    </div>
                                    <div class="col-md-5 paddingLeft0">
                                        <button type="button"
                                                class="btn btn-info border_bottom_left_radius border_top_left_radius"
                                                onclick="fileClick('fileChooseGuide','fileNameGuide')">
                                            浏览
                                        </button>
                                    </div>
                                </div>
                                <div class="row" style="margin-top: 10px">
                                    <div class="col-md-2">
                                        <button type="button"
                                                class="btn btn-info"
                                                onclick="confirmSubmitGuide('<%=id%>','<%=data.id%>')">
                                            提交
                                        </button>
                                    </div>
                                    <div class="col-md-2">
                                        <button type="button"
                                                class="btn btn-success" onclick="cancelSubmitGuide()">
                                            取消
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </script>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--更改指导记录结束-->
    <!--查看指导记录开始-->
    <div id="guideView" class="page-wrapper displayNone">
    </div>
    <script id="guideViews" type="text/template">
        <div style="margin: 0px" class="page-inner">
            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            提交指导记录
                        </div>
                        <div class="panel-body">
                            <div class="alert alert-info textEllipsis">
                                <div>
                                        <span style="color: #333333;">最新提交时间：
                                        <%
                                                var unixTimestamp = new Date( data.submitDate ) ;
                                                commonTime = unixTimestamp.toLocaleString();
                                            %>
                                            <%= commonTime %>
                                        </span>
                                    <span style="padding-left: 100px"><a
                                            href="#guideDetails">查看审核详情</a></span>
                                </div>
                            </div>
                            <div class="col-md-12 openingReport">
                                <h5 class="font_bold">主题</h5>
                                <div class="whiteColor">
                                    <div class="reportContent">
                                        <%= data.theme%>
                                    </div>
                                </div>
                                <h5 class="font_bold">指导时间</h5>
                                <div class="whiteColor">
                                    <div class="reportContent">
                                        <%= data.date%>
                                    </div>
                                </div>
                                <h5 class="font_bold">主要工作</h5>
                                <div class="whiteColor">
                                    <div class="reportContent">
                                        <%= data.work%>
                                    </div>
                                </div>
                                <h5 class="font_bold">批注内容</h5>
                                <div class="whiteColor">
                                    <div class="reportContent">
                                        <%= data.annotation%>
                                    </div>
                                </div>
                                <h5 class="font_bold">附件</h5>
                                <div class="whiteColor" style="padding:10px;">
                                    <% if(data.fileId == 0||typeof(data.file)=="undefined") { %>
                                    暂未上传指导记录相关附件
                                    <% } else { %>
                                    附件：<%=data.file.fileName %> <a style="padding-left: 20px"
                                                                   href="http://www.yuanbw.cn:20086/gpms/rol/downloadFile?fileId=<%=data.fileId %>">点击下载</a>
                                    <% } %>
                                </div>
                                <div class="row" style="margin-top: 10px">
                                    <div class="col-md-2">
                                        <% if(data.cStatus==1) {%>
                                        <button style="margin-bottom: 10px" type="button"
                                                class="btn btn-info" disabled>
                                            更改
                                        </button>
                                        <%} else{%>
                                        <button style="margin-bottom: 10px" type="button"
                                                class="btn btn-info" onclick="submitGuide('<%=data.id%>')">
                                            更改
                                        </button>
                                        <%}%>
                                    </div>
                                    <div class="col-md-2">
                                        <button type="button"
                                                class="btn btn-success" onclick="returnThree('guideView')">
                                            返回
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-left:0px;padding-bottom: 15px" class="col-md-12">
                                <div style="padding-left: 0px" class="col-md-4">
                                    <h4 id="guideDetails" class="font_bold">指导记录审核情况</h4>
                                </div>
                            </div>
                            <div class="col-md-12 alert alert-danger">
                                <div>
                                    <span class="notSubmit">审核状态：</span>
                                    <% let msg;
                                    if(data.cStatus==0) {
                                    msg = "审核不通过";
                                    }
                                    else if(data.cStatus==1) {
                                    msg = "审核通过";
                                    }
                                    else {
                                    msg = "审核中";
                                    }
                                    %>
                                    <%=msg%>
                                </div>
                                <div>
                                    <span class="notSubmit">审核建议：</span>
                                    <%= data.cSuggest%>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </script>
    <!--查看指导记录结束-->
    <!--更改毕业设计（论文）开始-->
    <div id="graduation" class="page-wrapper displayNone">
    </div>
    <script id="graduations" type="text/template">
        <div style="margin: 0px" class="page-inner">
            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            提交毕业设计(论文)
                        </div>
                        <div class="panel-body">
                            <%
                            let
                            keywords="",innovatePoint="",cnSummary="",enSummary="",other="",docFile="",fileName="",id=0;
                            if(data=="") {
                            id=-1;
                            }
                            if(data!="") {
                            keywords = data.keywords;
                            innovatePoint = data.innovatePoint;
                            cnSummary = data.cnSummary;
                            enSummary = data.enSummary;
                            other = data.other;
                            if(data.docFileId!=0&&typeof(data.docFile)!="undefined"){
                            docFile = data.docFile.fileName;
                            }
                            if(data.fileId!=0&&typeof(data.file)!="undefined") {
                            fileName = data.file.fileName;
                            }
                            }
                            %>
                            <form id="GraduationForm">
                                <div id="writeGraduation"
                                     class="col-md-12 openingReport">
                                    <h5 class="font_bold">关键词</h5>
                                    <input value="<%=keywords%>" type="text" class="form-control" name="keywords">
                                    <h5 class="font_bold">创新点</h5>
                                    <textarea class="form-control" rows="5"
                                              name="innovatePoint"><%=innovatePoint%></textarea>
                                    <h5 class="font_bold">中文摘要</h5>
                                    <textarea class="form-control" rows="5" name="cnSummary"><%=cnSummary%></textarea>
                                    <h5 class="font_bold">英文摘要</h5>
                                    <textarea class="form-control" rows="5" name="enSummary"><%=enSummary%></textarea>
                                    <h5 class="font_bold">其他</h5>
                                    <input type="text" class="form-control" value="<%=other%>" name="other">
                                    <h5 style="display: inline-block" class="font_bold">
                                        论文文档:
                                    </h5>
                                    <span style="padding-left: 10px;color: #f00">请上传您毕业设计（论文）的全部内容，包括篇名、目录、关键词、中英文摘要、正文、参考文献、附录等全部内容 </span>
                                    <input name="uploadDocFile" id="fileChooseGraduation" type="file"
                                           style="display: none">
                                    <div class="row">
                                        <div class="col-md-5 paddingRightt0">
                                            <input value="<%=docFile%>" id="fileNameGraduation" class="form-control"
                                                   type="text"
                                                   placeholder="此处提交的文档将在符合条件后进行检测">
                                        </div>
                                        <div class="col-md-5 paddingLeft0">
                                            <button type="button"
                                                    class="btn btn-info border_bottom_left_radius border_top_left_radius"
                                                    onclick="fileClick('fileChooseGraduation','fileNameGraduation')">
                                                选择待检测文档
                                            </button>
                                        </div>
                                    </div>
                                    <h5 class="font_bold">
                                        添加附件:
                                        <span style="padding-left: 10px;font-weight: normal">上传有关毕业设计（论文）的附件，上传的文件将以附件的形式显示。</span>
                                    </h5>
                                    <span style="color: #f00">提示：附件内容不检测，需要检测的论文请提交至“论文文档”处，不提交论文文档将不进行检测</span>
                                    <input name="uploadAttFile" id="fileChooseAttachment" type="file"
                                           style="display: none">
                                    <div class="row">
                                        <div class="col-md-5 paddingRightt0">
                                            <input value="<%=fileName%>" id="fileNameAttachment" class="form-control"
                                                   type="text"
                                                   placeholder="此处为附件文件，不检测">
                                        </div>
                                        <div class="col-md-5 paddingLeft0">
                                            <button type="button"
                                                    class="btn btn-info border_bottom_left_radius border_top_left_radius"
                                                    onclick="fileClick('fileChooseAttachment','fileNameAttachment')">
                                                选择附件
                                            </button>
                                        </div>
                                    </div>
                                    <div class="row" style="margin-top: 10px">
                                        <div class="col-md-2">
                                            <button type="button"
                                                    class="management_graduationView newPage btn btn-info"
                                                    onclick="SubmitPaper('<%=id%>','<%=data.id%>')">
                                                提交
                                            </button>
                                        </div>
                                        <div class="col-md-2">
                                            <button type="button"
                                                    class="btn btn-success" onclick="returnThree('graduation')">
                                                取消
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </script>
    <!--更改毕业设计（论文）结束-->
    <!--查看毕业设计（论文）开始-->
    <div id="graduationView" class="page-wrapper displayNone">
    </div>
    <script id="graduationViews" type="text/template">
        <div style="margin: 0px" class="page-inner">
            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            提交毕业设计(论文)
                        </div>
                        <div class="panel-body">
                            <div class="alert alert-info textEllipsis">
                                <div>
                                    <span style="color: #333333;">最新提交时间：
                                        <%
                                                var unixTimestamp = new Date( data.submitDate ) ;
                                                commonTime = unixTimestamp.toLocaleString();
                                            %>
                                            <%= commonTime %>
                                    </span>
                                    <span style="padding-left: 100px"><a
                                            href="#graduationDetails">查看审核详情</a></span>
                                </div>
                            </div>
                            <div class="col-md-12 openingReport">
                                <h5 class="font_bold">关键词</h5>
                                <div class="whiteColor">
                                    <div class="reportContent">
                                        <%=data.keywords%>
                                    </div>
                                </div>
                                <h5 class="font_bold">创新点</h5>
                                <div class="whiteColor">
                                    <div class="reportContent">
                                        <%=data.innovatePoint%>
                                    </div>
                                </div>
                                <h5 class="font_bold">中文摘要</h5>
                                <div class="whiteColor">
                                    <div class="reportContent">
                                        <%=data.cnSummary%>
                                    </div>
                                </div>
                                <h5 class="font_bold">英文摘要</h5>
                                <div class="whiteColor">
                                    <div class="reportContent">
                                        <%=data.enSummary%>
                                    </div>
                                </div>
                                <h5 class="font_bold">其他</h5>
                                <div class="whiteColor">
                                    <div class="reportContent">
                                        <%=data.other%>
                                    </div>
                                </div>
                                <h5 class="font_bold">批注内容</h5>
                                <div class="whiteColor">
                                    <div class="reportContent">
                                        <%=data.annotation%>
                                    </div>
                                </div>
                                <h5 class="font_bold">论文文档</h5>
                                <div class="whiteColor" style="padding:10px;">
                                    <% if(data.docFileId == 0 || typeof(data.docFile)=="undefined") { %>
                                    暂未上传论文文档相关附件
                                    <% } else { %>
                                    附件：<%=data.docFile.fileName %> <a style="padding-left: 20px"
                                                                      href="http://www.yuanbw.cn:20086/gpms/rol/downloadFile?fileId=<%=data.docFileId %>">点击下载</a>
                                    <% } %>
                                </div>
                                <h5 class="font_bold">附件</h5>
                                <div class="whiteColor" style="padding:10px;">
                                    <% if(data.fileId == 0 || typeof(data.file)=="undefined") { %>
                                    暂未上传相关附件
                                    <% } else { %>
                                    附件：<%=data.file.fileName %> <a style="padding-left: 20px"
                                                                   href="http://www.yuanbw.cn:20086/gpms/rol/downloadFile?fileId=<%=data.fileId %>">点击下载</a>
                                    <% } %>
                                </div>
                                <div class="row" style="margin-top: 10px">
                                    <div class="col-md-2">
                                        <button type="button"
                                                class="management_graduation newPage btn btn-info">
                                            更改
                                        </button>
                                    </div>
                                    <div class="col-md-2">
                                        <button type="button"
                                                class="btn btn-success" onclick="returnThree('graduationView')">
                                            返回
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-left:0px;padding-bottom: 15px" class="col-md-12">
                                <div style="padding-left: 0px" class="col-md-4">
                                    <h4 id="graduationDetails" class="font_bold">毕业设计(论文)审核情况</h4>
                                </div>
                            </div>
                            <div class="col-md-12 alert alert-danger">
                                <div>
                                    <span class="notSubmit">审核状态：</span>
                                    <% let msg;
                                    if(data.cStatus==0) {
                                    msg = "审核不通过";
                                    }
                                    else if(data.cStatus==1) {
                                    msg = "审核通过";
                                    }
                                    else {
                                    msg = "审核中";
                                    }
                                    %>
                                    <%=msg%>
                                </div>
                                <div>
                                    <span class="notSubmit">审核建议：</span>
                                    <%= data.cSuggest%>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </script>
    <!--查看毕业设计（论文）结束-->
    <!--过程文档管理结束-->

    <!--学生答辩开始-->
    <div id="four" class="page-wrapper displayNone">
        <div style="margin: 0px" class="page-inner">
            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-default">
                        <div style="background-color: #f5f5f5">
                            <ul class="nav nav-tabs" role="tablist">
                                <li class="active"><a href="#reply_arrange" role="tab"
                                                      data-toggle="tab">查看答辩安排</a></li>
                                </li>
                                <li onclick="viewResults()"><a href="#reply_results" role="tab"
                                                               data-toggle="tab">查看成绩</a>
                                </li>
                            </ul>
                        </div>
                        <div class="tab-content">
                            <!--查看答辩安排开始-->
                            <div class="tab-pane active panel-body" id="reply_arrange">
                            </div>
                            <script id="reply_arranges" type="text/template">
                                <div class="alert alert-success textEllipsis border_radius marginBottom0">
                                    <div class="col-md-2 textAlign">
                                        课题题目
                                    </div>
                                    <div class="col-md-4 textAlign">
                                        答辩时间
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        答辩教室
                                    </div>
                                    <div class="col-md-4 textAlign">
                                        答辩教师
                                    </div>
                                    <div class="col-md-1 textAlign">
                                        分组
                                    </div>
                                </div>
                                <%if(data=="") {%>
                                <div class="alert alert-warning textAlign border_radius marginBottom0">
                                    暂无查找到答辩安排
                                </div>
                                <%} else{%>
                                <div class="alert alert-warning textEllipsis border_radius marginBottom0">
                                    <div title="<%=topicName%>"
                                         class="col-md-2 textEllipsis textAlign padding0">
                                        <%=topicName%>
                                    </div>
                                    <div class="col-md-4 textEllipsis textAlign padding0">
                                        <%
                                        let unixTimestamp = new Date(data.defDate ) ;
                                        let year = unixTimestamp.getFullYear();
                                        let month = unixTimestamp.getMonth()+1;
                                        let date = unixTimestamp.getDate();
                                        commonTime = year+"年"+month+"月"+date+"日"
                                        %>
                                        <%= commonTime %>上午8:00
                                        第<%=data.defWeek%>周
                                        星期<%=data.defDay%>
                                    </div>
                                    <div style="padding:0px"
                                         class="col-md-1 textEllipsis textAlign">
                                        <%=data.defClass%>
                                    </div>
                                    <div class="col-md-4 textAlign textEllipsis">
                                        <% data.teaGroup.forEach(function(group){
                                        if(group.leader) {%>
                                        <%=group.teaAuth.name%>(组长)
                                        <% } else { %>
                                        <%=group.teaAuth.name%>
                                        <% }
                                        }
                                        )%>
                                    </div>
                                    <div style="padding:0px"
                                         class="col-md-1 textAlign textEllipsis">
                                        第<%=data.groupNum%>组
                                    </div>
                                </div>
                                <%}%>
                            </script>
                            <!--查看答辩安排结束-->
                            <!--查看成绩开始-->
                            <div class="tab-pane panel-body" id="reply_results">
                            </div>
                            <script id="reply_resultses" type="text/template">
                                <div style="padding-left:0px;padding-bottom: 15px"
                                     class="col-md-12">
                                    <div style="padding-left: 0px" class="col-md-4">
                                        <div class="col-md-10 col-xs-10" style="padding: 0px">
                                            <h4 class="font_bold">毕设/论文材料列表</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="alert alert-success textEllipsis border_radius marginBottom0">
                                    <div class="col-md-2 textAlign">
                                        序号
                                    </div>
                                    <div class="col-md-2 textAlign">
                                        是否已提交
                                    </div>
                                    <div class="col-md-8 textAlign">
                                        材料名称
                                    </div>
                                </div>
                                <%
                                for(let i=0;i
                                <taskProgress.length;i++) { %>
                                <div class="alert alert-danger textEllipsis border_radius marginBottom0">
                                    <div class="col-md-2 textEllipsis textAlign">
                                        <%=(i+1)%>
                                    </div>
                                    <div class="col-md-2 textEllipsis textAlign">

                                        <% if(taskProgress[i].progress==100) {%>
                                        <span class="submit"> 已提交</span>
                                        <% } else {%>
                                        <span class="colorf44"> 未提交</span>
                                        <%}%>
                                    </div>
                                    <div class="col-md-8 textEllipsis textAlign">
                                        <%=taskProgress[i].progressName%>
                                    </div>
                                </div>
                                <% }
                                %>
                                <div style="padding-left:0px;padding-bottom: 15px"
                                     class="col-md-12">
                                    <div style="padding-left: 0px" class="col-md-4">
                                        <div class="col-md-10 col-xs-10" style="padding: 0px">
                                            <h4 class="font_bold">权重信息</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="alert alert-info textEllipsis">
                                    综合评定成绩 = 指导成绩*40% + 评阅成绩*20% + 答辩成绩*40%
                                </div>
                                <div style="padding-left:0px;padding-bottom: 15px"
                                     class="col-md-12">
                                    <div style="padding-left: 0px" class="col-md-4">
                                        <div class="col-md-10 col-xs-10" style="padding: 0px">
                                            <h4 class="font_bold">学生成绩</h4>
                                        </div>
                                    </div>
                                </div>
                                <div style="margin-top: 74px" class="alert alert-info">
                                    <% if(typeof(data.hasReviewed)!="undefined"&&data.hasReviewed) {%>
                                    <div><span class="notSubmit">综合评定成绩 ：</span><%=data.scoreTotal%></div>
                                    <div><span class="notSubmit">综合评定等级 ：</span><%=data.grade%></div>
                                    <div><span class="notSubmit">评定日期 ：</span><%
                                        var unixTimestamp = new Date(data.reviewDate ) ;
                                        commonTime = unixTimestamp.toLocaleString();
                                        %>
                                        <%= commonTime %>
                                    </div>
                                    <div><span class="notSubmit">综合评定成绩提交教师 ：</span>
                                        <%if(typeof(data.dean)=="undefined") {%>
                                        暂无数据
                                        <%}else{%>
                                        <%=data.dean.name%>
                                        <%}%>
                                    </div>
                                    <%} else {%>
                                    <div><span class="notSubmit">暂无综合评定成绩 </span>
                                        <%}%>
                                    </div>
                                </div>
                            </script>
                            <!--查看成绩结束-->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--学生答辩结束-->

    <!--查看更多任务进度开始-->
    <div id="five" class="page-wrapper displayNone">
        <div class="header">
            <h3 class="page-header">
                任务进度
            </h3>
            <ol class="breadcrumb index">
                <li><a href="#">首页</a></li>
                <li class="active">任务进度</li>
            </ol>
        </div>
        <div id="page-inner">
            <!--任务进度开始-->
            <div class="row">
                <div class="col-xs-12 col-md-12">
                    <div>
                        <div class="titleContent">
                            <span>进度提示</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row" id="progressCircleAll">

            </div>
            <!--任务进度结束-->
        </div>
    </div>
    <script id="progressesCircleAll" type="text/template">
        <% taskProgress.forEach(function(progress) { %>
        <div class="col-xs-4 col-md-4">
            <div class="whiteBgColor">
                <div style="text-align: center">
                    <h4><%= progress.progressName %></h4>

                    <div class="<%= progress.className %>" data-percent="<%= progress.progress %>"><span
                            class="percent"><%= progress.progress %>%</span>
                    </div>
                </div>
            </div>
        </div>
        <% }) %>
    </script>
    <!--查看更多任务进度-->

    <!--发送通知开始userNotification-->
    <div id="userNotification" class="page-wrapper displayNone">
        <div style="margin: 0px" class="page-inner">
            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            向指导教师发送消息
                        </div>
                        <div class="panel-body">
                            <!--发送通知开始-->
                            <div id="send_Ntification">
                                <div style="padding-bottom: 10px">
                                    <button type="button" class="btn btn-info" data-toggle="modal"
                                            data-target="#notificationContent">发送消息
                                    </button>
                                </div>
                                <div class="alert alert-success textEllipsis border_radius marginBottom0">
                                    <div class="col-md-1 textAlign">
                                        <input id="student_notice"
                                               onchange="selectAll('student_notice','checkbox_notice')" type="checkbox"
                                               value="1"/>
                                    </div>
                                    <div class="col-md-4">
                                        指导教师姓名（工号）
                                    </div>
                                    <div class="col-md-2">
                                        职称
                                    </div>
                                    <div class="col-md-5">
                                        院系
                                    </div>
                                </div>
                                <div class="alert alert-danger textEllipsis border_radius marginBottom0">
                                    <div class="col-md-1 textEllipsis textAlign">
                                        <input class="checkbox_notice" type="checkbox" value="2"/>
                                    </div>
                                    <div class="col-md-4 textEllipsis">
                                        王XX（12345678900）
                                    </div>
                                    <div class="col-md-2">
                                        副教授
                                    </div>
                                    <div class="col-md-5 textEllipsis">
                                        计算机与软件工程学院
                                    </div>
                                </div>
                            </div>
                            <!--发送通知结束-->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--发送通知内容开始-->
    <div class="modal fade" id="notificationContent" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">发送消息</h4>
                </div>
                <div class="modal-body">
                    <div class="alert alert-success row">
                        <div class="col-md-2">
                            <strong>
                                <span>消息内容:</span>
                            </strong>
                        </div>
                        <div class="col-md-10">
                            <textarea class="form-control" style="width: 100%" rows="10"></textarea>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm btn-success" data-dismiss="modal">确定</button>
                    <button type="button" class="btn btn-sm btn-info" data-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </div>
    <!--发送通知内容结束-->
    <!--发送通知结束userNotification-->

    <!--退出登录-->
    <div id="login" class="bounced displayNone">
    </div>
    <script>
        $("#login").load("../commonHtml/logOut.html");
    </script>

    <!--修改密码-->
    <div id="changePassword" class="commmonTop passwordChange displayNone" style="height: 100%">
    </div>
    <script>
        $("#changePassword").load("../commonHtml/changePassword.html");
    </script>

    <!--通知公告-->
    <div id="announcements" class="commmonTop messageNotice displayNone" style="height: 100%">
    </div>
    <script>
        $("#announcements").load("../commonHtml/announcements.html");
    </script>

    <!--历届优秀浏览-->
    <div id="pastExcellent" class="commmon good displayNone" style="height: 100%">
    </div>
    <script>
        $("#pastExcellent").load("../commonHtml/pastExcellent.html");
    </script>

    <!--新闻浏览-->
    <div id="new" class="commmon news displayNone" style="height: 100%">
    </div>
    <script>
        $("#new").load("../commonHtml/news.html");
    </script>

</div>

</div>


</body>

<!--jquery.pagination.js-->
<script src="../assets/js/jquery.pagination.js"></script>
<!-- Bootstrap Js -->
<script src="../assets/js/bootstrap.js"></script>
<script src="../assets/js/sideCloseOpen.js"></script>
<script src="../assets/js/ejs.js"></script>
<!-- 自定义函数 Js -->
<script src="../assets/js/commonFunction.js"></script>
<!--圆形进度条-->
<!-- easypiechart-data Js -->
<script src="../assets/js/easypiechart-data.js"></script>
<!-- easypiechart Js -->
<script src="../assets/js/easypiechart.js"></script>
<script src="../assets/js/circleChart.min.js"></script>


<script>
    let titleArray = [];
    let taskProgress;
    let token = getCookie("token");
    if (token == "" || token == null) {
        window.location.href = "../login/login.html";
    }

    function notice() {
        $('.page-wrapper').addClass('displayNone');
        $('.page-wrapper').removeClass('displayBlock');
        $('#five').addClass('displayBlock');
    }

    function colorOfProgress(progress) {
        if (progress == 0) {
            return 'easypiechart easypiechart-red';
        } else if (progress > 0 && progress < 50) {
            return 'easypiechart easypiechart-teal'
        } else {
            return 'easypiechart easypiechart-blue';
        }
    }

    function queryProgress() {
        let url = "http://www.yuanbw.cn:20086/gpms/stu/showDocProgress";
        let progresses = document.getElementById('progresses').innerHTML;
        let progress = document.getElementById('progress');
        let progressesCircle = document.getElementById('progressesCircle').innerHTML;
        let progressCircle = document.getElementById('progressCircle');
        let progressesCircleAll = document.getElementById('progressesCircleAll').innerHTML;
        let progressCircleAll = document.getElementById('progressCircleAll');
        let html;
        $.ajax({
            url: url,
            type: "POST",
            data: {},
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.msg == "请先登录！") {
                    window.location.href = "../login/login.html";
                }
                taskProgress = [
                    {
                        progress: responseStr.data[0],
                        progressName: "开题报告",
                        className: colorOfProgress(responseStr.data[0])
                    },
                    {
                        progress: responseStr.data[1],
                        progressName: "中期检查",
                        className: colorOfProgress(responseStr.data[1])
                    },
                    {
                        progress: responseStr.data[2],
                        progressName: "指导记录",
                        className: colorOfProgress(responseStr.data[2])
                    },
                    {
                        progress: responseStr.data[3],
                        progressName: "外文译文和原文",
                        className: colorOfProgress(responseStr.data[3])
                    },
                    {
                        progress: responseStr.data[4],
                        progressName: "文献综述",
                        className: colorOfProgress(responseStr.data[4])
                    },
                    {
                        progress: responseStr.data[5],
                        progressName: "毕业设计（论文）",
                        className: colorOfProgress(responseStr.data[5])
                    }
                ];
                $(".noticeIcon").hover(function () {
                    let progressBar = document.getElementsByClassName('progressBar');
                    for (let i = 0; i < 3; i++) {
                        progressBar[i].style.width = taskProgress[i].progress + "%";
                    }
                });

                html = ejs.render(progresses, {taskProgress: taskProgress});
                progress.innerHTML = html;
                progressCircle.innerHTML = ejs.render(progressesCircle, {taskProgress: taskProgress});
                progressCircleAll.innerHTML = ejs.render(progressesCircleAll, {taskProgress: taskProgress});
                $('.easypiechart-red').easyPieChart({
                    scaleColor: false,
                    barColor: '#f9243f'
                });
                $(function () {
                    $('.easypiechart-blue').easyPieChart({
                        scaleColor: false,
                        barColor: '#30a5ff'
                    });
                });
                $(function () {
                    $('.easypiechart-teal').easyPieChart({
                        scaleColor: false,
                        barColor: '#1ebfae'
                    });
                });
            },
            error: function (responseStr) {
                console.log("failed");
                console.log(responseStr);
            }
        });
    }

    $(function () {
        topicSelected();
        queryProgress();
        showRoleInfo();
    });

    function indexQuery() {
        topicSelected();
        queryProgress();
    }

    //查看个人信息
    let topicName;

    function showRoleInfo() {
        let informationsDetailed = document.getElementById('informationsDetailed').innerHTML;
        let informationDetailed = document.getElementById('informationDetailed');
        let informations = document.getElementById('informations').innerHTML;
        let information = document.getElementById('information');
        let url = "http://www.yuanbw.cn:20086/gpms/rol/showRoleInfo";
        $.ajax({
            url: url,
            type: "POST",
            data: {},
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                console.log(responseStr.data)
                if (responseStr.msg == "查询成功") {
                    topicName = responseStr.data.pName;
                    information.innerHTML = ejs.render(informations, {informations: responseStr.data});
                    informationDetailed.innerHTML = ejs.render(informationsDetailed, {informations: responseStr.data});
                }
            },
            error: function (responseStr) {
                window.location.href = "../404/404.html";
            }
        });
    }

    //修改个人信息
    function modifyInformation() {
        let email = document.getElementById('email').value;
        let bindTel = document.getElementById('bindTel').value;
        let contactTel = document.getElementById('contactTel').value;
        let emailplaceholder = $("#email").attr('placeholder');
        let bindTelplaceholder = $("#bindTel").attr('placeholder');
        let contactTelplaceholder = $("#contactTel").attr('placeholder');
        if (email == "") {
            email = emailplaceholder;
        }
        if (bindTel == "") {
            bindTel = bindTelplaceholder;
        }
        if (contactTel == "") {
            contactTel = contactTelplaceholder;
        }
        let url = "http://www.yuanbw.cn:20086/gpms/rol/modifyRoleInfo";
        $.ajax({
            url: url,
            type: "POST",
            data: {
                bindTel: bindTel,
                contactTel: contactTel,
                email: email
            },
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                alert(responseStr.msg);
                if (responseStr.msg == "修改成功") {
                    showRoleInfo();
                }
            },
            error: function (responseStr) {
                console.log("failed");
                console.log(responseStr);
            }
        });
    }

</script>

<script>
    let pageCount = 1;
    let array = [];

    function selectTopic(proName, proType, proSource, tecId, tecName) {
        let topics = document.getElementById('topics').innerHTML;
        let topic = document.getElementById('topic');
        let html;
        let limit = 4;
        let offset = 0;
        let url = "http://www.yuanbw.cn:20086/gpms/stu/showProjects";
        $.ajax({
            url: url,
            type: "POST",
            data: {
                proName: proName,
                proType: proType,
                proSource: proSource,
                tecId: tecId,
                tecName: tecName,
                offset: offset,
                limit: limit
            },
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                let msg = responseStr.msg;
                if (msg == "查询成功") {
                    pageCount = Math.ceil(responseStr.data.count / limit);
                    array = responseStr.data.projects;
                    if (responseStr.msg == "查询成功") {
                        html = ejs.render(topics, {arrays: array});
                        topic.innerHTML = html;
                    }
                    $('#titlePage').pagination({
                        pageCount: pageCount,
                        jump: true,
                        coping: true,
                        homePage: '首页',
                        endPage: '末页',
                        prevContent: '上页',
                        nextContent: '下页',
                        callback: function (api) {
                            let page = api.getCurrent();
                            offset = (page - 1) * limit;
                            $.ajax({
                                url: url,
                                type: "POST",
                                data: {
                                    proName: proName,
                                    proType: proType,
                                    proSource: proSource,
                                    tecId: tecId,
                                    tecName: tecName,
                                    offset: offset,
                                    limit: limit
                                },
                                xhrFields: {
                                    withCredentials: true
                                },
                                crossDomain: true,
                                headers: {
                                    Token: token
                                },
                                success: function (responseStr) {
                                    let msg = responseStr.msg;
                                    if (msg == "查询成功") {
                                        pageCount = Math.ceil(responseStr.data.count / limit);
                                        array = responseStr.data.projects;
                                        if (array.length > 0) {
                                            html = ejs.render(topics, {arrays: array});
                                            topic.innerHTML = html;
                                        }
                                    }
                                    if (msg == "系统繁忙") {
                                        alert("系统繁忙,请不要点击过快！");
                                    }
                                },
                                error: function (responseStr) {
                                    console.log("failed");
                                    console.log(responseStr);
                                }
                            });
                        }
                    });
                } else if (msg == "查询记录为空") {
                    topic.innerHTML = ejs.render(topics, {arrays: ""});
                }
            },
            error: function (responseStr) {
                console.log("failed");
                console.log(responseStr);
            }
        });
    }

    function selectedTopic() {
        selectTopic(null, null, null, null, null);
    }

    //根据条件查询课题
    function queryTopic() {
        let topicTitle = document.getElementById('topicTitle').value;
        let tutor = document.getElementById('tutor').value;
        let teacherNumber = document.getElementById('teacherNumber').value;
        let titleSource = document.getElementById('titleSource').value;
        let titleType = document.getElementById('titleType').value;
        selectTopic(topicTitle, titleType, titleSource, teacherNumber, tutor);
        document.getElementById('topicTitle').value = "";
        document.getElementById('tutor').value = "";
        document.getElementById('teacherNumber').value = "";
        document.getElementById('titleSource').options[0].selected = true;
        document.getElementById('titleType').options[0].selected = true;
    }

    //已选选题查看课题
    function titleDetails(id) {
        let topicsDetails = document.getElementById('topicsDetails').innerHTML;
        let topicDetails = document.getElementById('topicDetails');
        let html;
        if (titleArray.length > 0) {
            titleArray.forEach(function (arr) {
                if (arr.project.id == id) {
                    html = ejs.render(topicsDetails, {title: arr.project, dates: arr.chooseDate, setDate: "true"});
                    topicDetails.innerHTML = html;
                }
            })
        }
    }

    //选题查看课题
    function titleClick(id) {
        let topicsDetails = document.getElementById('topicsDetails').innerHTML;
        let topicDetails = document.getElementById('topicDetails');
        let html;
        if (array.length > 0) {
            array.forEach(function (arr) {
                if (arr.project.id == id) {
                    html = ejs.render(topicsDetails, {title: arr.project, dates: arr.setDate, setDate: ""});
                    topicDetails.innerHTML = html;
                }
            })
        }

    }

    //已选课题教师信息
    function teacherInformation(id) {
        let teachersDetail = document.getElementById('teachersDetail').innerHTML;
        let teacherDetail = document.getElementById('teacherDetail');
        let html;
        let teachers;
        if (titleArray.length > 0) {
            titleArray.forEach(function (arr) {
                if (arr.setRole.identifier == id) {
                    teachers = arr.setRole;
                    html = ejs.render(teachersDetail, {teacher: teachers});
                    teacherDetail.innerHTML = html;
                }
            })
        }

    }

    //课题教师信息
    function teacherDetails(id) {
        let teachersDetail = document.getElementById('teachersDetail').innerHTML;
        let teacherDetail = document.getElementById('teacherDetail');
        let html;
        if (array.length > 0) {
            array.forEach(function (arr) {
                if (typeof (arr.teacher) != "undefined" && arr.teacher.identifier == id) {
                    html = ejs.render(teachersDetail, {teacher: arr.teacher});
                    teacherDetail.innerHTML = html;
                }
            })
        }
    }

    //选题确认
    function titleSelect(id) {
        $('#saveTopic').unbind('click').click(function () {
            let url = "http://www.yuanbw.cn:20086/gpms/stu/chooseProject";
            $.ajax({
                url: url,
                type: "POST",
                data: {
                    pid: id
                },
                xhrFields: {
                    withCredentials: true
                },
                crossDomain: true,
                headers: {
                    Token: token
                },
                success: function (responseStr) {
                    alert(responseStr.msg);
                    selectTopic(null, null, null, null, null);
                },
                error: function (responseStr) {
                    console.log("failed");
                    console.log(responseStr);
                }
            });
            let miss = document.getElementById('saveTopicMiss');
            miss.click();

        });
    }

    //取消选题
    function titleCancel(id) {
        $('#cancelTopics').unbind('click').click(function () {
            let url = "http://www.yuanbw.cn:20086/gpms/stu/cancelProject";
            // let token = getCookie("token");
            $.ajax({
                url: url,
                type: "POST",
                data: {
                    pid: id
                },
                xhrFields: {
                    withCredentials: true
                },
                crossDomain: true,
                headers: {
                    Token: token
                },
                success: function (responseStr) {
                    alert(responseStr.msg);
                    topicSelected();
                },
                error: function (responseStr) {
                    console.log("failed");
                    console.log(responseStr);
                }
            });
            let miss = document.getElementById('cancelTopicMiss');
            miss.click();
        });
    }

    //已选课题
    function topicSelected() {
        let selectedTopics = document.getElementById('selectedTopics').innerHTML;
        let selectedTopic = document.getElementById('selectedTopic');
        let indexSelectedTopics = document.getElementById('indexSelectedTopics').innerHTML;
        let indexSelectedTopic = document.getElementById('indexSelectedTopic');
        let html;
        let url = "http://www.yuanbw.cn:20086/gpms/stu/showChoosePro";
        $.ajax({
            url: url,
            type: "POST",
            data: {},
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.msg == "查询成功") {
                    titleArray = responseStr.data;
                    let data = responseStr.data[0];
                    for (let i = 0; i < responseStr.data.length; i++) {
                        if (responseStr.data[i].cStatus == 1) {
                            data = responseStr.data[i];
                        }
                    }
                    selectedTopic.innerHTML = ejs.render(selectedTopics, {titles: responseStr.data});
                    indexSelectedTopic.innerHTML = ejs.render(indexSelectedTopics, {titles: data});
                } else if (responseStr.msg == "查询记录为空") {
                    selectedTopic.innerHTML = ejs.render(selectedTopics, {titles: ""});
                    indexSelectedTopic.innerHTML = ejs.render(indexSelectedTopics, {titles: ""});
                }
            },
            error: function (responseStr) {
                console.log("failed");
                console.log(responseStr);
            }
        });
    }

    //答辩管理查看答辩安排
    function queryDefense() {
        let url = "http://www.yuanbw.cn:20086/gpms/stu/showDefence";
        let reply_arranges = document.getElementById('reply_arranges').innerHTML;
        let reply_arrange = document.getElementById('reply_arrange');
        $.ajax({
            url: url,
            type: "POST",
            data: {},
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.msg == "查询成功") {
                    reply_arrange.innerHTML = ejs.render(reply_arranges, {
                        data: responseStr.data,
                        topicName: topicName
                    });
                } else if (responseStr.statusCode == "101") {
                    reply_arrange.innerHTML = ejs.render(reply_arranges, {
                        data: ""
                    });
                }
            },
            error: function (responseStr) {
                console.log("failed");
                console.log(responseStr);
            }
        });
    }

    //查看成绩
    function viewResults() {
        let url = "http://www.yuanbw.cn:20086/gpms/stu/showScoreInfo";
        let reply_resultses = document.getElementById('reply_resultses').innerHTML;
        let reply_results = document.getElementById('reply_results');
        $.ajax({
            url: url,
            type: "POST",
            data: {},
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                console.log(responseStr)
                if (responseStr.msg == "查询成功") {
                    reply_results.innerHTML = ejs.render(reply_resultses, {
                        data: responseStr.data,
                        taskProgress: taskProgress
                    });
                } else if (responseStr.statusCode == "101") {
                    reply_results.innerHTML = ejs.render(reply_resultses, {
                        data: ""
                    });
                }
            },
            error: function (responseStr) {
                console.log("failed");
                console.log(responseStr);
            }
        });
    }

    //过程文档管理提交开题报告
    let OpeningReportdata;
    let OpeningReportdataFirst = "NotFirst";

    function queryOpeningReport() {
        let url = "http://www.yuanbw.cn:20086/gpms/stu/showOpeningReport";
        $.ajax({
            url: url,
            type: "POST",
            data: {},
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.statusCode == 101) {
                    submitBlock('writeOpeningReport', 'modifyOpeningReport');
                    let writeOpeningReports = document.getElementById('writeOpeningReports').innerHTML;
                    let writeOpeningReport = document.getElementById('writeOpeningReport');
                    writeOpeningReport.innerHTML = ejs.render(writeOpeningReports, {data: ""});
                    OpeningReportdataFirst = "First";
                } else if (responseStr.statusCode == 100) {
                    OpeningReportdata = responseStr.data;
                    submitNone('writeOpeningReport', 'modifyOpeningReport');
                    let modifyOpeningReports = document.getElementById('modifyOpeningReports').innerHTML;
                    let modifyOpeningReport = document.getElementById('modifyOpeningReport');
                    modifyOpeningReport.innerHTML = ejs.render(modifyOpeningReports, {data: responseStr.data});
                    OpeningReportdataFirst = "NotFirst";
                }
            },
            error: function (responseStr) {
                console.log("failed");
                console.log(responseStr);
            }
        });
    }

    //过程文档管理提交中期检查
    let InterimInspectiondata;
    let InterimInspectiondataFirst = "NotFirst";

    function submiInterimInspection() {
        let url = "http://www.yuanbw.cn:20086/gpms/stu/showMidInspection";
        $.ajax({
            url: url,
            type: "POST",
            data: {},
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.statusCode == 101) {
                    submitBlock('writeIntermediateInspection', 'modifyIntermediateInspection');
                    let writeIntermediateInspections = document.getElementById('writeIntermediateInspections').innerHTML;
                    let writeIntermediateInspection = document.getElementById('writeIntermediateInspection');
                    writeIntermediateInspection.innerHTML = ejs.render(writeIntermediateInspections, {data: ""});
                    InterimInspectiondataFirst = "First";
                } else if (responseStr.statusCode == 100) {
                    InterimInspectiondata = responseStr.data;
                    submitNone('writeIntermediateInspection', 'modifyIntermediateInspection');
                    let modifyIntermediateInspections = document.getElementById('modifyIntermediateInspections').innerHTML;
                    let modifyIntermediateInspection = document.getElementById('modifyIntermediateInspection');
                    modifyIntermediateInspection.innerHTML = ejs.render(modifyIntermediateInspections, {data: responseStr.data});
                    InterimInspectiondataFirst = "NotFirst";
                }
            },
            error: function (responseStr) {
                console.log("failed");
                console.log(responseStr);
            }
        });
    }

    //过程文档管理提交指导记录
    let GuideRecorddata;
    let GuideRecordFirst = "NotFirst";

    function submitGuideRecord() {
        let url = "http://www.yuanbw.cn:20086/gpms/stu/showGuidanceRecord";
        $.ajax({
            url: url,
            type: "POST",
            data: {},
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                let InstructionRecordLists = document.getElementById('InstructionRecordLists').innerHTML;
                let InstructionRecordList = document.getElementById('InstructionRecordList');
                if (responseStr.statusCode == 101) {
                    InstructionRecordList.innerHTML = ejs.render(InstructionRecordLists, {data: ""});
                } else if (responseStr.statusCode == 100) {
                    GuideRecorddata = responseStr.data;
                    InstructionRecordList.innerHTML = ejs.render(InstructionRecordLists, {
                        data: responseStr.data,
                        topicName: topicName
                    });
                }
            },
            error: function (responseStr) {
                console.log("failed");
                console.log(responseStr);
            }
        });
    }

    //过程文档管理提交外文译文和原文
    let ForeignOriginaldata;
    let ForeignOriginaldataFirst = "NotFirst";

    function submitForeignOriginal() {
        let url = "http://www.yuanbw.cn:20086/gpms/stu/showForeignOriginal";
        $.ajax({
            url: url,
            type: "POST",
            data: {},
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.statusCode == 101) {
                    submitBlock('writeForeignTranslation', 'modifyForeignTranslation');
                    let writeForeignTranslations = document.getElementById('writeForeignTranslations').innerHTML;
                    let writeForeignTranslation = document.getElementById('writeForeignTranslation');
                    writeForeignTranslation.innerHTML = ejs.render(writeForeignTranslations, {data: ""});
                    ForeignOriginaldataFirst = "First";
                } else if (responseStr.statusCode == 100) {
                    ForeignOriginaldata = responseStr.data;
                    submitNone('writeForeignTranslation', 'modifyForeignTranslation');
                    let modifyForeignTranslations = document.getElementById('modifyForeignTranslations').innerHTML;
                    let modifyForeignTranslation = document.getElementById('modifyForeignTranslation');
                    modifyForeignTranslation.innerHTML = ejs.render(modifyForeignTranslations, {data: responseStr.data});
                    ForeignOriginaldataFirst = "NotFirst";
                }
            },
            error: function (responseStr) {
                console.log("failed");
                console.log(responseStr);
            }
        });
    }

    //过程文档管理提交文献综述
    let LiteratureReviewdata;
    let LiteratureReviewdataFirst = "NotFirst";

    function submitLiteratureReview() {
        let url = "http://www.yuanbw.cn:20086/gpms/stu/showLiteratureReview";
        $.ajax({
            url: url,
            type: "POST",
            data: {},
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                if (responseStr.statusCode == 101) {
                    submitBlock('writeLiterature', 'modifyLiterature');
                    let writeLiteratures = document.getElementById('writeLiteratures').innerHTML;
                    let writeLiterature = document.getElementById('writeLiterature');
                    writeLiterature.innerHTML = ejs.render(writeLiteratures, {data: ""});
                    LiteratureReviewdataFirst = "First";
                } else if (responseStr.statusCode == 100) {
                    LiteratureReviewdata = responseStr.data;
                    submitNone('writeLiterature', 'modifyLiterature');
                    let modifyLiteratures = document.getElementById('modifyLiteratures').innerHTML;
                    let modifyLiterature = document.getElementById('modifyLiterature');
                    modifyLiterature.innerHTML = ejs.render(modifyLiteratures, {data: responseStr.data});
                    LiteratureReviewdataFirst = "NotFirst";
                }
            },
            error: function (responseStr) {
                console.log("failed");
                console.log(responseStr);
            }
        });
    }

    //过程文档管理提交论文
    let GraduationDesigndata;
    let GraduationDesigndataFirst = "NotFirst";

    function submitGraduationDesign() {
        let url = "http://www.yuanbw.cn:20086/gpms/stu/showGraduationProjects";
        $.ajax({
            url: url,
            type: "POST",
            data: {},
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                let submitPapers = document.getElementById('submitPapers').innerHTML;
                let submitPaper = document.getElementById('submitPaper');
                if (responseStr.statusCode == 101) {
                    submitPaper.innerHTML = ejs.render(submitPapers, {data: ""});
                } else if (responseStr.statusCode == 100) {
                    GraduationDesigndata = responseStr.data;
                    submitPaper.innerHTML = ejs.render(submitPapers, {
                        data: responseStr.data,
                        topicName: topicName
                    });
                }
            },
            error: function (responseStr) {
                console.log("failed");
                console.log(responseStr);
            }
        });
    }

</script>

<script>
    function submitNone(id1, id2) {
        $('#' + id1).addClass("displayNone").removeClass("displayBlock");
        $('#' + id2).addClass("displayBlock").removeClass("displayNone");
    }

    function submitBlock(id1, id2) {
        $('#' + id2).addClass("displayNone").removeClass("displayBlock");
        $('#' + id1).addClass("displayBlock").removeClass("displayNone");
    }

    // 开题报告
    function submitOpeningReport(id) {
        let formdata = new FormData($('#fileUpload')[0]);
        formdata.append("fileId", id);
        let url = "http://www.yuanbw.cn:20086/gpms/stu/commitOpeningReport";
        $.ajax({
            url: url,
            type: "POST",
            data: formdata,
            cache: false,
            processData: false,
            contentType: false,
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                alert(responseStr.msg);
                submitNone('writeOpeningReport', 'modifyOpeningReport');
                queryOpeningReport();
            },
            error: function (responseStr) {
                console.log("failed");
                console.log(responseStr);
            }
        });
    }

    function cancelOpeningReport() {
        cancelTitle('OpeningInput');
        if (OpeningReportdataFirst == "NotFirst") {
            submitNone('writeOpeningReport', 'modifyOpeningReport');
        }
    }

    //修改开题报告
    function modifyReport() {
        let writeOpeningReports = document.getElementById('writeOpeningReports').innerHTML;
        let writeOpeningReport = document.getElementById('writeOpeningReport');
        this.submitBlock('writeOpeningReport', 'modifyOpeningReport');
        writeOpeningReport.innerHTML = ejs.render(writeOpeningReports, {data: OpeningReportdata});
    }

    // 修改或提交中期检查
    function submitIntermediate(id) {
        let formdata = new FormData($('#IntermediateForm')[0]);
        formdata.append("fileId", id);
        let url = "http://www.yuanbw.cn:20086/gpms/stu/commitMidInspection";
        $.ajax({
            url: url,
            type: "POST",
            data: formdata,
            cache: false,
            processData: false,
            contentType: false,
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                alert(responseStr.msg);
                submiInterimInspection();
                submitNone('writeIntermediateInspection', 'modifyIntermediateInspection');
            },
            error: function (responseStr) {
                console.log("failed");
                console.log(responseStr);
            }
        });
    }

    function cancelIntermediate() {
        cancelTitle('InspectionInput');
        if (InterimInspectiondataFirst == "NotFirst") {
            submitNone('writeIntermediateInspection', 'modifyIntermediateInspection');
        }
    }

    //修改中期检查
    function modifyIntermediate() {
        this.submitBlock('writeIntermediateInspection', 'modifyIntermediateInspection');
        let writeIntermediateInspections = document.getElementById('writeIntermediateInspections').innerHTML;
        let writeIntermediateInspection = document.getElementById('writeIntermediateInspection');
        writeIntermediateInspection.innerHTML = ejs.render(writeIntermediateInspections, {data: InterimInspectiondata});
    }

    //查看指导记录
    function viewGuide(id) {
        $('#three').removeClass('displayBlock');
        $('#three').addClass('displayNone');
        $('#guideView').addClass('displayBlock');
        $('#guideView').removeClass('displayNone');
        let guideViews = document.getElementById('guideViews').innerHTML;
        let guideView = document.getElementById('guideView');
        for (let i = 0; i < GuideRecorddata.length; i++) {
            if (id == GuideRecorddata[i].id) {
                guideView.innerHTML = ejs.render(guideViews, {data: GuideRecorddata[i]});
            }
        }
    }

    //提交、修改指导记录
    function submitGuide(isSubmit) {
        $('#three').removeClass('displayBlock');
        $('#three').addClass('displayNone');
        $('#guideView').removeClass('displayBlock');
        $('#guideView').addClass('displayNone');
        $('#guide').addClass('displayBlock');
        $('#guide').removeClass('displayNone');
        let writeGuides = document.getElementById('writeGuides').innerHTML;
        let writeGuide = document.getElementById('writeGuide');
        let Guidedata;
        if (isSubmit == "FirstGuide") {
            Guidedata = "";
        } else {
            for (let i = 0; i < GuideRecorddata.length; i++) {
                if (isSubmit == GuideRecorddata[i].id) {
                    Guidedata = GuideRecorddata[i];
                }
            }
        }
        writeGuide.innerHTML = ejs.render(writeGuides, {data: Guidedata});
    }

    //确认提交指导记录
    function confirmSubmitGuide(id, dataId) {
        let url;
        let formdata = new FormData($('#guideForm')[0]);
        if (id == -1) {
            url = "http://www.yuanbw.cn:20086/gpms/stu/addGuidanceRecord";
        } else {
            url = "http://www.yuanbw.cn:20086/gpms/stu/modifyGuidanceRecord";
            formdata.append("id", dataId);
        }
        $.ajax({
            url: url,
            type: "POST",
            data: formdata,
            cache: false,
            processData: false,
            contentType: false,
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                alert(responseStr.msg);
                submitGuideRecord();
                $('#guide').removeClass('displayBlock');
                $('#guide').addClass('displayNone');
                $('#three').addClass('displayBlock');
                $('#three').removeClass('displayNone');
            },
            error: function (responseStr) {
                console.log("failed");
                console.log(responseStr);
            }
        });
    }

    //返回指导记录列表
    function returnThree(otherClass) {
        $('#' + otherClass).removeClass('displayBlock');
        $('#' + otherClass).addClass('displayNone');
        $('#three').addClass('displayBlock');
        $('#three').removeClass('displayNone');
    }

    //取消
    function cancelSubmitGuide() {
        cancelTitle("guideInput");
        $('#guide').removeClass('displayBlock');
        $('#guide').addClass('displayNone');
        $('#three').addClass('displayBlock');
        $('#three').removeClass('displayNone');
    }

    // 提交外文译文和原文
    function submitForeign() {
        let formdata = new FormData($('#ForeignForm')[0]);
        let url = "http://www.yuanbw.cn:20086/gpms/stu/commitForeignOriginal";
        $.ajax({
            url: url,
            type: "POST",
            data: formdata,
            cache: false,
            processData: false,
            contentType: false,
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                alert(responseStr.msg);
                submitForeignOriginal();
                submitNone('writeForeignTranslation', 'modifyForeignTranslation');
            },
            error: function (responseStr) {
                console.log("failed");
                console.log(responseStr);
            }
        });
    }

    function cancelForeign() {
        cancelTitle("foreigntext");
        if(ForeignOriginaldataFirst == "NotFirst") {
            submitNone('writeForeignTranslation', 'modifyForeignTranslation');
        }
    }

    function modifyForeign() {
        this.submitBlock('writeForeignTranslation', 'modifyForeignTranslation');
        let writeForeignTranslations = document.getElementById('writeForeignTranslations').innerHTML;
        let writeForeignTranslation = document.getElementById('writeForeignTranslation');
        writeForeignTranslation.innerHTML = ejs.render(writeForeignTranslations, {data: ForeignOriginaldata});
    }

    // 确认提交文献综述
    function submitLiterature(id) {
        let formdata = new FormData($('#LiteraturesForm')[0]);
        formdata.append("fileId", id);
        let url = "http://www.yuanbw.cn:20086/gpms/stu/commitLiteratureReview";
        $.ajax({
            url: url,
            type: "POST",
            data: formdata,
            cache: false,
            processData: false,
            contentType: false,
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                alert(responseStr.msg);
                submitLiteratureReview();
                submitNone('writeLiterature', 'modifyLiterature');
            },
            error: function (responseStr) {
                console.log("failed");
                console.log(responseStr);
            }
        });
    }

    function cancelLiterature() {
        cancelTitle("Literaturetext");
        if(LiteratureReviewdataFirst == "NotFirst") {
            submitNone('writeLiterature', 'modifyLiterature');
        }
    }

    function modifyLiterature() {
        this.submitBlock('writeLiterature', 'modifyLiterature');
        let writeLiteratures = document.getElementById('writeLiteratures').innerHTML;
        let writeLiterature = document.getElementById('writeLiterature');
        writeLiterature.innerHTML = ejs.render(writeLiteratures, {data: LiteratureReviewdata});
    }

    //查看论文
    function viewGraduation(id) {
        $('#three').removeClass('displayBlock');
        $('#three').addClass('displayNone');
        $('#graduationView').addClass('displayBlock');
        $('#graduationView').removeClass('displayNone');
        let graduationViews = document.getElementById('graduationViews').innerHTML;
        let graduationView = document.getElementById('graduationView');
        for (let i = 0; i < GraduationDesigndata.length; i++) {
            if (id == GraduationDesigndata[i].id) {
                graduationView.innerHTML = ejs.render(graduationViews, {data: GraduationDesigndata[i]});
            }
        }
    }

    //修改论文
    function Modify_Paper(isSubmit) {
        $('#graduation').addClass('displayBlock');
        $('#graduation').removeClass('displayNone');
        $('#three').removeClass('displayBlock');
        $('#three').addClass('displayNone');
        let graduations = document.getElementById('graduations').innerHTML;
        let graduation = document.getElementById('graduation');
        let Paperdata;
        if (isSubmit == "FirstPaper") {
            Paperdata = "";
        } else {
            for (let i = 0; i < GraduationDesigndata.length; i++) {
                if (isSubmit == GraduationDesigndata[i].id) {
                    Paperdata = GraduationDesigndata[i];
                }
            }
        }
        graduation.innerHTML = ejs.render(graduations, {data: Paperdata});
    }

    //提交论文
    function SubmitPaper(id, dataId) {
        let url;
        let formdata = new FormData($('#GraduationForm')[0]);
        if (id == -1) {
            url = "http://www.yuanbw.cn:20086/gpms/stu/addGraduationProject";
        } else {
            url = "http://www.yuanbw.cn:20086/gpms/stu/modifyGraduationProject";
            formdata.append("id", dataId);
        }
        $.ajax({
            url: url,
            type: "POST",
            data: formdata,
            cache: false,
            processData: false,
            contentType: false,
            xhrFields: {
                withCredentials: true
            },
            crossDomain: true,
            headers: {
                Token: token
            },
            success: function (responseStr) {
                alert(responseStr.msg);
                submitGraduationDesign();
                $('#graduation').removeClass('displayBlock');
                $('#graduation').addClass('displayNone');
                $('#three').addClass('displayBlock');
                $('#three').removeClass('displayNone');
            },
            error: function (responseStr) {
                console.log("failed");
                console.log(responseStr);
            }
        });
    }
</script>

</html>
